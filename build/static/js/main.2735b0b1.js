/*! For license information please see main.2735b0b1.js.LICENSE.txt */
(()=>{"use strict";var e={43:(e,t,n)=>{e.exports=n(202)},153:(e,t,n)=>{var r=n(43),i=Symbol.for("react.element"),s=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,o=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function u(e,t,n){var r,s={},u=null,c=null;for(r in void 0!==n&&(u=""+n),void 0!==t.key&&(u=""+t.key),void 0!==t.ref&&(c=t.ref),t)a.call(t,r)&&!l.hasOwnProperty(r)&&(s[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===s[r]&&(s[r]=t[r]);return{$$typeof:i,type:e,key:u,ref:c,props:s,_owner:o.current}}t.Fragment=s,t.jsx=u,t.jsxs=u},202:(e,t)=>{var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),l=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),p=Symbol.iterator;var f={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m=Object.assign,g={};function v(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||f}function y(){}function b(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||f}v.prototype.isReactComponent={},v.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},v.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=v.prototype;var x=b.prototype=new y;x.constructor=b,m(x,v.prototype),x.isPureReactComponent=!0;var w=Array.isArray,_=Object.prototype.hasOwnProperty,k={current:null},S={key:!0,ref:!0,__self:!0,__source:!0};function j(e,t,r){var i,s={},a=null,o=null;if(null!=t)for(i in void 0!==t.ref&&(o=t.ref),void 0!==t.key&&(a=""+t.key),t)_.call(t,i)&&!S.hasOwnProperty(i)&&(s[i]=t[i]);var l=arguments.length-2;if(1===l)s.children=r;else if(1<l){for(var u=Array(l),c=0;c<l;c++)u[c]=arguments[c+2];s.children=u}if(e&&e.defaultProps)for(i in l=e.defaultProps)void 0===s[i]&&(s[i]=l[i]);return{$$typeof:n,type:e,key:a,ref:o,props:s,_owner:k.current}}function C(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var E=/\/+/g;function T(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function R(e,t,i,s,a){var o=typeof e;"undefined"!==o&&"boolean"!==o||(e=null);var l=!1;if(null===e)l=!0;else switch(o){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case n:case r:l=!0}}if(l)return a=a(l=e),e=""===s?"."+T(l,0):s,w(a)?(i="",null!=e&&(i=e.replace(E,"$&/")+"/"),R(a,t,i,"",(function(e){return e}))):null!=a&&(C(a)&&(a=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(a,i+(!a.key||l&&l.key===a.key?"":(""+a.key).replace(E,"$&/")+"/")+e)),t.push(a)),1;if(l=0,s=""===s?".":s+":",w(e))for(var u=0;u<e.length;u++){var c=s+T(o=e[u],u);l+=R(o,t,i,c,a)}else if(c=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=p&&e[p]||e["@@iterator"])?e:null}(e),"function"===typeof c)for(e=c.call(e),u=0;!(o=e.next()).done;)l+=R(o=o.value,t,i,c=s+T(o,u++),a);else if("object"===o)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function P(e,t,n){if(null==e)return e;var r=[],i=0;return R(e,r,"","",(function(e){return t.call(n,e,i++)})),r}function O(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var N={current:null},$={transition:null},I={ReactCurrentDispatcher:N,ReactCurrentBatchConfig:$,ReactCurrentOwner:k};t.Children={map:P,forEach:function(e,t,n){P(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return P(e,(function(){t++})),t},toArray:function(e){return P(e,(function(e){return e}))||[]},only:function(e){if(!C(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=v,t.Fragment=i,t.Profiler=a,t.PureComponent=b,t.StrictMode=s,t.Suspense=c,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=I,t.cloneElement=function(e,t,r){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var i=m({},e.props),s=e.key,a=e.ref,o=e._owner;if(null!=t){if(void 0!==t.ref&&(a=t.ref,o=k.current),void 0!==t.key&&(s=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(u in t)_.call(t,u)&&!S.hasOwnProperty(u)&&(i[u]=void 0===t[u]&&void 0!==l?l[u]:t[u])}var u=arguments.length-2;if(1===u)i.children=r;else if(1<u){l=Array(u);for(var c=0;c<u;c++)l[c]=arguments[c+2];i.children=l}return{$$typeof:n,type:e.type,key:s,ref:a,props:i,_owner:o}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:o,_context:e},e.Consumer=e},t.createElement=j,t.createFactory=function(e){var t=j.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:u,render:e}},t.isValidElement=C,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:O}},t.memo=function(e,t){return{$$typeof:d,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=$.transition;$.transition={};try{e()}finally{$.transition=t}},t.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},t.useCallback=function(e,t){return N.current.useCallback(e,t)},t.useContext=function(e){return N.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return N.current.useDeferredValue(e)},t.useEffect=function(e,t){return N.current.useEffect(e,t)},t.useId=function(){return N.current.useId()},t.useImperativeHandle=function(e,t,n){return N.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return N.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return N.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return N.current.useMemo(e,t)},t.useReducer=function(e,t,n){return N.current.useReducer(e,t,n)},t.useRef=function(e){return N.current.useRef(e)},t.useState=function(e){return N.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return N.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return N.current.useTransition()},t.version="18.2.0"},210:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(n(829)),s=r(n(736)),a=n(745);class o{constructor(e){let{headers:t={},schema:n,fetch:r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.url=e,this.headers=Object.assign(Object.assign({},a.DEFAULT_HEADERS),t),this.schemaName=n,this.fetch=r}from(e){const t=new URL(`${this.url}/${e}`);return new i.default(t,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new o(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{head:r=!1,get:i=!1,count:a}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const o=new URL(`${this.url}/rpc/${e}`);let l;r||i?(t=r?"HEAD":"GET",Object.entries(n).filter((e=>{let[t,n]=e;return void 0!==n})).map((e=>{let[t,n]=e;return[t,Array.isArray(n)?`{${n.join(",")}}`:`${n}`]})).forEach((e=>{let[t,n]=e;o.searchParams.append(t,n)}))):(t="POST",l=n);const u=Object.assign({},this.headers);return a&&(u.Prefer=`count=${a}`),new s.default({method:t,url:o,headers:u,schema:this.schemaName,body:l,fetch:this.fetch,allowEmpty:!1})}}t.default=o},234:(e,t)=>{function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,i=e[r];if(!(0<s(i,t)))break e;e[r]=t,e[n]=i,n=r}}function r(e){return 0===e.length?null:e[0]}function i(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,i=e.length,a=i>>>1;r<a;){var o=2*(r+1)-1,l=e[o],u=o+1,c=e[u];if(0>s(l,n))u<i&&0>s(c,l)?(e[r]=c,e[u]=n,r=u):(e[r]=l,e[o]=n,r=o);else{if(!(u<i&&0>s(c,n)))break e;e[r]=c,e[u]=n,r=u}}}return t}function s(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var a=performance;t.unstable_now=function(){return a.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var u=[],c=[],d=1,h=null,p=3,f=!1,m=!1,g=!1,v="function"===typeof setTimeout?setTimeout:null,y="function"===typeof clearTimeout?clearTimeout:null,b="undefined"!==typeof setImmediate?setImmediate:null;function x(e){for(var t=r(c);null!==t;){if(null===t.callback)i(c);else{if(!(t.startTime<=e))break;i(c),t.sortIndex=t.expirationTime,n(u,t)}t=r(c)}}function w(e){if(g=!1,x(e),!m)if(null!==r(u))m=!0,$(_);else{var t=r(c);null!==t&&I(w,t.startTime-e)}}function _(e,n){m=!1,g&&(g=!1,y(C),C=-1),f=!0;var s=p;try{for(x(n),h=r(u);null!==h&&(!(h.expirationTime>n)||e&&!R());){var a=h.callback;if("function"===typeof a){h.callback=null,p=h.priorityLevel;var o=a(h.expirationTime<=n);n=t.unstable_now(),"function"===typeof o?h.callback=o:h===r(u)&&i(u),x(n)}else i(u);h=r(u)}if(null!==h)var l=!0;else{var d=r(c);null!==d&&I(w,d.startTime-n),l=!1}return l}finally{h=null,p=s,f=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var k,S=!1,j=null,C=-1,E=5,T=-1;function R(){return!(t.unstable_now()-T<E)}function P(){if(null!==j){var e=t.unstable_now();T=e;var n=!0;try{n=j(!0,e)}finally{n?k():(S=!1,j=null)}}else S=!1}if("function"===typeof b)k=function(){b(P)};else if("undefined"!==typeof MessageChannel){var O=new MessageChannel,N=O.port2;O.port1.onmessage=P,k=function(){N.postMessage(null)}}else k=function(){v(P,0)};function $(e){j=e,S||(S=!0,k())}function I(e,n){C=v((function(){e(t.unstable_now())}),n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){m||f||(m=!0,$(_))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return r(u)},t.unstable_next=function(e){switch(p){case 1:case 2:case 3:var t=3;break;default:t=p}var n=p;p=t;try{return e()}finally{p=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=p;p=e;try{return t()}finally{p=n}},t.unstable_scheduleCallback=function(e,i,s){var a=t.unstable_now();switch("object"===typeof s&&null!==s?s="number"===typeof(s=s.delay)&&0<s?a+s:a:s=a,e){case 1:var o=-1;break;case 2:o=250;break;case 5:o=1073741823;break;case 4:o=1e4;break;default:o=5e3}return e={id:d++,callback:i,priorityLevel:e,startTime:s,expirationTime:o=s+o,sortIndex:-1},s>a?(e.sortIndex=s,n(c,e),null===r(u)&&e===r(c)&&(g?(y(C),C=-1):g=!0,I(w,s-a))):(e.sortIndex=o,n(u,e),m||f||(m=!0,$(_))),e},t.unstable_shouldYield=R,t.unstable_wrapCallback=function(e){var t=p;return function(){var n=p;p=t;try{return e.apply(this,arguments)}finally{p=n}}}},286:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(n(630)),s=r(n(611));t.default=class{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:"undefined"===typeof fetch?this.fetch=i.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=Object.assign({},this.headers),this.headers[e]=t,this}then(e,t){void 0===this.schema||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),"GET"!==this.method&&"HEAD"!==this.method&&(this.headers["Content-Type"]="application/json");let n=(0,this.fetch)(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then((async e=>{var t,n,r;let i=null,a=null,o=null,l=e.status,u=e.statusText;if(e.ok){if("HEAD"!==this.method){const t=await e.text();""===t||(a="text/csv"===this.headers.Accept||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?t:JSON.parse(t))}const r=null===(t=this.headers.Prefer)||void 0===t?void 0:t.match(/count=(exact|planned|estimated)/),s=null===(n=e.headers.get("content-range"))||void 0===n?void 0:n.split("/");r&&s&&s.length>1&&(o=parseInt(s[1])),this.isMaybeSingle&&"GET"===this.method&&Array.isArray(a)&&(a.length>1?(i={code:"PGRST116",details:`Results contain ${a.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},a=null,o=null,l=406,u="Not Acceptable"):a=1===a.length?a[0]:null)}else{const t=await e.text();try{i=JSON.parse(t),Array.isArray(i)&&404===e.status&&(a=[],i=null,l=200,u="OK")}catch(c){404===e.status&&""===t?(l=204,u="No Content"):i={message:t}}if(i&&this.isMaybeSingle&&(null===(r=null===i||void 0===i?void 0:i.details)||void 0===r?void 0:r.includes("0 rows"))&&(i=null,l=200,u="OK"),i&&this.shouldThrowOnError)throw new s.default(i)}return{error:i,data:a,count:o,status:l,statusText:u}}));return this.shouldThrowOnError||(n=n.catch((e=>{var t,n,r;return{error:{message:`${null!==(t=null===e||void 0===e?void 0:e.name)&&void 0!==t?t:"FetchError"}: ${null===e||void 0===e?void 0:e.message}`,details:`${null!==(n=null===e||void 0===e?void 0:e.stack)&&void 0!==n?n:""}`,hint:"",code:`${null!==(r=null===e||void 0===e?void 0:e.code)&&void 0!==r?r:""}`},data:null,count:null,status:0,statusText:""}}))),n.then(e,t)}returns(){return this}overrideTypes(){return this}}},358:(e,t)=>{const n=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,r=/^[\u0021-\u003A\u003C-\u007E]*$/,i=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,s=/^[\u0020-\u003A\u003D-\u007E]*$/,a=Object.prototype.toString,o=(()=>{const e=function(){};return e.prototype=Object.create(null),e})();function l(e,t,n){do{const n=e.charCodeAt(t);if(32!==n&&9!==n)return t}while(++t<n);return n}function u(e,t,n){for(;t>n;){const n=e.charCodeAt(--t);if(32!==n&&9!==n)return t+1}return n}function c(e){if(-1===e.indexOf("%"))return e;try{return decodeURIComponent(e)}catch(t){return e}}},374:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(n(286));class s extends i.default{select(e){let t=!1;const n=(null!==e&&void 0!==e?e:"*").split("").map((e=>/\s/.test(e)&&!t?"":('"'===e&&(t=!t),e))).join("");return this.url.searchParams.set("select",n),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e){let{ascending:t=!0,nullsFirst:n,foreignTable:r,referencedTable:i=r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const s=i?`${i}.order`:"order",a=this.url.searchParams.get(s);return this.url.searchParams.set(s,`${a?`${a},`:""}${e}.${t?"asc":"desc"}${void 0===n?"":n?".nullsfirst":".nullslast"}`),this}limit(e){let{foreignTable:t,referencedTable:n=t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r="undefined"===typeof n?"limit":`${n}.limit`;return this.url.searchParams.set(r,`${e}`),this}range(e,t){let{foreignTable:n,referencedTable:r=n}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i="undefined"===typeof r?"offset":`${r}.offset`,s="undefined"===typeof r?"limit":`${r}.limit`;return this.url.searchParams.set(i,`${e}`),this.url.searchParams.set(s,""+(t-e+1)),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return"GET"===this.method?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain(){let{analyze:e=!1,verbose:t=!1,settings:n=!1,buffers:r=!1,wal:i=!1,format:s="text"}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var a;const o=[e?"analyze":null,t?"verbose":null,n?"settings":null,r?"buffers":null,i?"wal":null].filter(Boolean).join("|"),l=null!==(a=this.headers.Accept)&&void 0!==a?a:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${s}; for="${l}"; options=${o};`,this}rollback(){var e;return(null!==(e=this.headers.Prefer)&&void 0!==e?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}t.default=s},391:(e,t,n)=>{var r=n(950);t.createRoot=r.createRoot,t.hydrateRoot=r.hydrateRoot},400:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.version=void 0,t.version="0.0.0-automated"},579:(e,t,n)=>{e.exports=n(153)},611:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});class n extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}}t.default=n},630:(e,t,n)=>{n.r(t),n.d(t,{Headers:()=>a,Request:()=>o,Response:()=>l,default:()=>s,fetch:()=>i});var r=function(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof n.g)return n.g;throw new Error("unable to locate global object")}();const i=r.fetch,s=r.fetch.bind(r),a=r.Headers,o=r.Request,l=r.Response},730:(e,t,n)=>{var r=n(43),i=n(853);function s(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a=new Set,o={};function l(e,t){u(e,t),u(e+"Capture",t)}function u(e,t){for(o[e]=t,e=0;e<t.length;e++)a.add(t[e])}var c=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),d=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},f={};function m(e,t,n,r,i,s,a){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=a}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){g[e]=new m(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];g[t]=new m(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){g[e]=new m(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){g[e]=new m(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){g[e]=new m(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){g[e]=new m(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){g[e]=new m(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){g[e]=new m(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){g[e]=new m(e,5,!1,e.toLowerCase(),null,!1,!1)}));var v=/[\-:]([a-z])/g;function y(e){return e[1].toUpperCase()}function b(e,t,n,r){var i=g.hasOwnProperty(t)?g[t]:null;(null!==i?0!==i.type:r||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,i,r)&&(n=null),r||null===i?function(e){return!!d.call(f,e)||!d.call(p,e)&&(h.test(e)?f[e]=!0:(p[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=null===n?3!==i.type&&"":n:(t=i.attributeName,r=i.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(i=i.type)||4===i&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(v,y);g[t]=new m(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(v,y);g[t]=new m(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(v,y);g[t]=new m(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!1,!1)})),g.xlinkHref=new m("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!0,!0)}));var x=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,w=Symbol.for("react.element"),_=Symbol.for("react.portal"),k=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),j=Symbol.for("react.profiler"),C=Symbol.for("react.provider"),E=Symbol.for("react.context"),T=Symbol.for("react.forward_ref"),R=Symbol.for("react.suspense"),P=Symbol.for("react.suspense_list"),O=Symbol.for("react.memo"),N=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var $=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var I=Symbol.iterator;function A(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=I&&e[I]||e["@@iterator"])?e:null}var L,D=Object.assign;function F(e){if(void 0===L)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);L=t&&t[1]||""}return"\n"+L+e}var z=!1;function M(e,t){if(!e||z)return"";z=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var r=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){r=u}e.call(t.prototype)}else{try{throw Error()}catch(u){r=u}e()}}catch(u){if(u&&r&&"string"===typeof u.stack){for(var i=u.stack.split("\n"),s=r.stack.split("\n"),a=i.length-1,o=s.length-1;1<=a&&0<=o&&i[a]!==s[o];)o--;for(;1<=a&&0<=o;a--,o--)if(i[a]!==s[o]){if(1!==a||1!==o)do{if(a--,0>--o||i[a]!==s[o]){var l="\n"+i[a].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=a&&0<=o);break}}}finally{z=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?F(e):""}function B(e){switch(e.tag){case 5:return F(e.type);case 16:return F("Lazy");case 13:return F("Suspense");case 19:return F("SuspenseList");case 0:case 2:case 15:return e=M(e.type,!1);case 11:return e=M(e.type.render,!1);case 1:return e=M(e.type,!0);default:return""}}function U(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case k:return"Fragment";case _:return"Portal";case j:return"Profiler";case S:return"StrictMode";case R:return"Suspense";case P:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case E:return(e.displayName||"Context")+".Consumer";case C:return(e._context.displayName||"Context")+".Provider";case T:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case O:return null!==(t=e.displayName||null)?t:U(e.type)||"Memo";case N:t=e._payload,e=e._init;try{return U(e(t))}catch(n){}}return null}function q(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return U(t);case 8:return t===S?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function W(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function H(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function V(e){e._valueTracker||(e._valueTracker=function(e){var t=H(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var i=n.get,s=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){r=""+e,s.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function J(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=H(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function K(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function G(e,t){var n=t.checked;return D({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function Q(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=W(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function Y(e,t){null!=(t=t.checked)&&b(e,"checked",t,!1)}function X(e,t){Y(e,t);var n=W(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,W(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Z(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&K(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+W(n),t=null,i=0;i<e.length;i++){if(e[i].value===n)return e[i].selected=!0,void(r&&(e[i].defaultSelected=!0));null!==t||e[i].disabled||(t=e[i])}null!==t&&(t.selected=!0)}}function re(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(s(91));return D({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ie(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(s(92));if(te(n)){if(1<n.length)throw Error(s(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:W(n)}}function se(e,t){var n=W(t.value),r=W(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function ae(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function oe(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?oe(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ue,ce,de=(ce=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ue=ue||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ue.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction((function(){return ce(e,t)}))}:ce);function he(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var pe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},fe=["Webkit","ms","Moz","O"];function me(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||pe.hasOwnProperty(e)&&pe[e]?(""+t).trim():t+"px"}function ge(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),i=me(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}Object.keys(pe).forEach((function(e){fe.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),pe[t]=pe[e]}))}));var ve=D({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ye(e,t){if(t){if(ve[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(s(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(s(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(s(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(s(62))}}function be(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var xe=null;function we(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var _e=null,ke=null,Se=null;function je(e){if(e=bi(e)){if("function"!==typeof _e)throw Error(s(280));var t=e.stateNode;t&&(t=wi(t),_e(e.stateNode,e.type,t))}}function Ce(e){ke?Se?Se.push(e):Se=[e]:ke=e}function Ee(){if(ke){var e=ke,t=Se;if(Se=ke=null,je(e),t)for(e=0;e<t.length;e++)je(t[e])}}function Te(e,t){return e(t)}function Re(){}var Pe=!1;function Oe(e,t,n){if(Pe)return e(t,n);Pe=!0;try{return Te(e,t,n)}finally{Pe=!1,(null!==ke||null!==Se)&&(Re(),Ee())}}function Ne(e,t){var n=e.stateNode;if(null===n)return null;var r=wi(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(s(231,t,typeof n));return n}var $e=!1;if(c)try{var Ie={};Object.defineProperty(Ie,"passive",{get:function(){$e=!0}}),window.addEventListener("test",Ie,Ie),window.removeEventListener("test",Ie,Ie)}catch(ce){$e=!1}function Ae(e,t,n,r,i,s,a,o,l){var u=Array.prototype.slice.call(arguments,3);try{t.apply(n,u)}catch(c){this.onError(c)}}var Le=!1,De=null,Fe=!1,ze=null,Me={onError:function(e){Le=!0,De=e}};function Be(e,t,n,r,i,s,a,o,l){Le=!1,De=null,Ae.apply(Me,arguments)}function Ue(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function qe(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function We(e){if(Ue(e)!==e)throw Error(s(188))}function He(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=Ue(e)))throw Error(s(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(null===i)break;var a=i.alternate;if(null===a){if(null!==(r=i.return)){n=r;continue}break}if(i.child===a.child){for(a=i.child;a;){if(a===n)return We(i),e;if(a===r)return We(i),t;a=a.sibling}throw Error(s(188))}if(n.return!==r.return)n=i,r=a;else{for(var o=!1,l=i.child;l;){if(l===n){o=!0,n=i,r=a;break}if(l===r){o=!0,r=i,n=a;break}l=l.sibling}if(!o){for(l=a.child;l;){if(l===n){o=!0,n=a,r=i;break}if(l===r){o=!0,r=a,n=i;break}l=l.sibling}if(!o)throw Error(s(189))}}if(n.alternate!==r)throw Error(s(190))}if(3!==n.tag)throw Error(s(188));return n.stateNode.current===n?e:t}(e))?Ve(e):null}function Ve(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=Ve(e);if(null!==t)return t;e=e.sibling}return null}var Je=i.unstable_scheduleCallback,Ke=i.unstable_cancelCallback,Ge=i.unstable_shouldYield,Qe=i.unstable_requestPaint,Ye=i.unstable_now,Xe=i.unstable_getCurrentPriorityLevel,Ze=i.unstable_ImmediatePriority,et=i.unstable_UserBlockingPriority,tt=i.unstable_NormalPriority,nt=i.unstable_LowPriority,rt=i.unstable_IdlePriority,it=null,st=null;var at=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(ot(e)/lt|0)|0},ot=Math.log,lt=Math.LN2;var ut=64,ct=4194304;function dt(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ht(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,i=e.suspendedLanes,s=e.pingedLanes,a=268435455&n;if(0!==a){var o=a&~i;0!==o?r=dt(o):0!==(s&=a)&&(r=dt(s))}else 0!==(a=n&~i)?r=dt(a):0!==s&&(r=dt(s));if(0===r)return 0;if(0!==t&&t!==r&&0===(t&i)&&((i=r&-r)>=(s=t&-t)||16===i&&0!==(4194240&s)))return t;if(0!==(4&r)&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)i=1<<(n=31-at(t)),r|=e[n],t&=~i;return r}function pt(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function ft(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function mt(){var e=ut;return 0===(4194240&(ut<<=1))&&(ut=64),e}function gt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function vt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-at(t)]=n}function yt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-at(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}var bt=0;function xt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var wt,_t,kt,St,jt,Ct=!1,Et=[],Tt=null,Rt=null,Pt=null,Ot=new Map,Nt=new Map,$t=[],It="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function At(e,t){switch(e){case"focusin":case"focusout":Tt=null;break;case"dragenter":case"dragleave":Rt=null;break;case"mouseover":case"mouseout":Pt=null;break;case"pointerover":case"pointerout":Ot.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Nt.delete(t.pointerId)}}function Lt(e,t,n,r,i,s){return null===e||e.nativeEvent!==s?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},null!==t&&(null!==(t=bi(t))&&_t(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==i&&-1===t.indexOf(i)&&t.push(i),e)}function Dt(e){var t=yi(e.target);if(null!==t){var n=Ue(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=qe(n)))return e.blockedOn=t,void jt(e.priority,(function(){kt(n)}))}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Ft(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Gt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=bi(n))&&_t(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);xe=r,n.target.dispatchEvent(r),xe=null,t.shift()}return!0}function zt(e,t,n){Ft(e)&&n.delete(t)}function Mt(){Ct=!1,null!==Tt&&Ft(Tt)&&(Tt=null),null!==Rt&&Ft(Rt)&&(Rt=null),null!==Pt&&Ft(Pt)&&(Pt=null),Ot.forEach(zt),Nt.forEach(zt)}function Bt(e,t){e.blockedOn===t&&(e.blockedOn=null,Ct||(Ct=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,Mt)))}function Ut(e){function t(t){return Bt(t,e)}if(0<Et.length){Bt(Et[0],e);for(var n=1;n<Et.length;n++){var r=Et[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==Tt&&Bt(Tt,e),null!==Rt&&Bt(Rt,e),null!==Pt&&Bt(Pt,e),Ot.forEach(t),Nt.forEach(t),n=0;n<$t.length;n++)(r=$t[n]).blockedOn===e&&(r.blockedOn=null);for(;0<$t.length&&null===(n=$t[0]).blockedOn;)Dt(n),null===n.blockedOn&&$t.shift()}var qt=x.ReactCurrentBatchConfig,Wt=!0;function Ht(e,t,n,r){var i=bt,s=qt.transition;qt.transition=null;try{bt=1,Jt(e,t,n,r)}finally{bt=i,qt.transition=s}}function Vt(e,t,n,r){var i=bt,s=qt.transition;qt.transition=null;try{bt=4,Jt(e,t,n,r)}finally{bt=i,qt.transition=s}}function Jt(e,t,n,r){if(Wt){var i=Gt(e,t,n,r);if(null===i)Wr(e,t,r,Kt,n),At(e,r);else if(function(e,t,n,r,i){switch(t){case"focusin":return Tt=Lt(Tt,e,t,n,r,i),!0;case"dragenter":return Rt=Lt(Rt,e,t,n,r,i),!0;case"mouseover":return Pt=Lt(Pt,e,t,n,r,i),!0;case"pointerover":var s=i.pointerId;return Ot.set(s,Lt(Ot.get(s)||null,e,t,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,Nt.set(s,Lt(Nt.get(s)||null,e,t,n,r,i)),!0}return!1}(i,e,t,n,r))r.stopPropagation();else if(At(e,r),4&t&&-1<It.indexOf(e)){for(;null!==i;){var s=bi(i);if(null!==s&&wt(s),null===(s=Gt(e,t,n,r))&&Wr(e,t,r,Kt,n),s===i)break;i=s}null!==i&&r.stopPropagation()}else Wr(e,t,r,null,n)}}var Kt=null;function Gt(e,t,n,r){if(Kt=null,null!==(e=yi(e=we(r))))if(null===(t=Ue(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=qe(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Kt=e,null}function Qt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Xe()){case Ze:return 1;case et:return 4;case tt:case nt:return 16;case rt:return 536870912;default:return 16}default:return 16}}var Yt=null,Xt=null,Zt=null;function en(){if(Zt)return Zt;var e,t,n=Xt,r=n.length,i="value"in Yt?Yt.value:Yt.textContent,s=i.length;for(e=0;e<r&&n[e]===i[e];e++);var a=r-e;for(t=1;t<=a&&n[r-t]===i[s-t];t++);return Zt=i.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function rn(){return!1}function sn(e){function t(t,n,r,i,s){for(var a in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=i,this.target=s,this.currentTarget=null,e)e.hasOwnProperty(a)&&(t=e[a],this[a]=t?t(i):i[a]);return this.isDefaultPrevented=(null!=i.defaultPrevented?i.defaultPrevented:!1===i.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return D(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var an,on,ln,un={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},cn=sn(un),dn=D({},un,{view:0,detail:0}),hn=sn(dn),pn=D({},dn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:jn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ln&&(ln&&"mousemove"===e.type?(an=e.screenX-ln.screenX,on=e.screenY-ln.screenY):on=an=0,ln=e),an)},movementY:function(e){return"movementY"in e?e.movementY:on}}),fn=sn(pn),mn=sn(D({},pn,{dataTransfer:0})),gn=sn(D({},dn,{relatedTarget:0})),vn=sn(D({},un,{animationName:0,elapsedTime:0,pseudoElement:0})),yn=D({},un,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),bn=sn(yn),xn=sn(D({},un,{data:0})),wn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},_n={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},kn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Sn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=kn[e])&&!!t[e]}function jn(){return Sn}var Cn=D({},dn,{key:function(e){if(e.key){var t=wn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?_n[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:jn,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),En=sn(Cn),Tn=sn(D({},pn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Rn=sn(D({},dn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:jn})),Pn=sn(D({},un,{propertyName:0,elapsedTime:0,pseudoElement:0})),On=D({},pn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Nn=sn(On),$n=[9,13,27,32],In=c&&"CompositionEvent"in window,An=null;c&&"documentMode"in document&&(An=document.documentMode);var Ln=c&&"TextEvent"in window&&!An,Dn=c&&(!In||An&&8<An&&11>=An),Fn=String.fromCharCode(32),zn=!1;function Mn(e,t){switch(e){case"keyup":return-1!==$n.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Bn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Un=!1;var qn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Wn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!qn[e.type]:"textarea"===t}function Hn(e,t,n,r){Ce(r),0<(t=Vr(t,"onChange")).length&&(n=new cn("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Vn=null,Jn=null;function Kn(e){Fr(e,0)}function Gn(e){if(J(xi(e)))return e}function Qn(e,t){if("change"===e)return t}var Yn=!1;if(c){var Xn;if(c){var Zn="oninput"in document;if(!Zn){var er=document.createElement("div");er.setAttribute("oninput","return;"),Zn="function"===typeof er.oninput}Xn=Zn}else Xn=!1;Yn=Xn&&(!document.documentMode||9<document.documentMode)}function tr(){Vn&&(Vn.detachEvent("onpropertychange",nr),Jn=Vn=null)}function nr(e){if("value"===e.propertyName&&Gn(Jn)){var t=[];Hn(t,Jn,e,we(e)),Oe(Kn,t)}}function rr(e,t,n){"focusin"===e?(tr(),Jn=n,(Vn=t).attachEvent("onpropertychange",nr)):"focusout"===e&&tr()}function ir(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Gn(Jn)}function sr(e,t){if("click"===e)return Gn(t)}function ar(e,t){if("input"===e||"change"===e)return Gn(t)}var or="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function lr(e,t){if(or(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!d.call(t,i)||!or(e[i],t[i]))return!1}return!0}function ur(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function cr(e,t){var n,r=ur(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=ur(r)}}function dr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?dr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function hr(){for(var e=window,t=K();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=K((e=t.contentWindow).document)}return t}function pr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function fr(e){var t=hr(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&dr(n.ownerDocument.documentElement,n)){if(null!==r&&pr(n))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=void 0===r.end?s:Math.min(r.end,i),!e.extend&&s>r&&(i=r,r=s,s=i),i=cr(n,s);var a=cr(n,r);i&&a&&(1!==e.rangeCount||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&((t=t.createRange()).setStart(i.node,i.offset),e.removeAllRanges(),s>r?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var mr=c&&"documentMode"in document&&11>=document.documentMode,gr=null,vr=null,yr=null,br=!1;function xr(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;br||null==gr||gr!==K(r)||("selectionStart"in(r=gr)&&pr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},yr&&lr(yr,r)||(yr=r,0<(r=Vr(vr,"onSelect")).length&&(t=new cn("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=gr)))}function wr(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var _r={animationend:wr("Animation","AnimationEnd"),animationiteration:wr("Animation","AnimationIteration"),animationstart:wr("Animation","AnimationStart"),transitionend:wr("Transition","TransitionEnd")},kr={},Sr={};function jr(e){if(kr[e])return kr[e];if(!_r[e])return e;var t,n=_r[e];for(t in n)if(n.hasOwnProperty(t)&&t in Sr)return kr[e]=n[t];return e}c&&(Sr=document.createElement("div").style,"AnimationEvent"in window||(delete _r.animationend.animation,delete _r.animationiteration.animation,delete _r.animationstart.animation),"TransitionEvent"in window||delete _r.transitionend.transition);var Cr=jr("animationend"),Er=jr("animationiteration"),Tr=jr("animationstart"),Rr=jr("transitionend"),Pr=new Map,Or="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Nr(e,t){Pr.set(e,t),l(t,[e])}for(var $r=0;$r<Or.length;$r++){var Ir=Or[$r];Nr(Ir.toLowerCase(),"on"+(Ir[0].toUpperCase()+Ir.slice(1)))}Nr(Cr,"onAnimationEnd"),Nr(Er,"onAnimationIteration"),Nr(Tr,"onAnimationStart"),Nr("dblclick","onDoubleClick"),Nr("focusin","onFocus"),Nr("focusout","onBlur"),Nr(Rr,"onTransitionEnd"),u("onMouseEnter",["mouseout","mouseover"]),u("onMouseLeave",["mouseout","mouseover"]),u("onPointerEnter",["pointerout","pointerover"]),u("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ar="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Lr=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ar));function Dr(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,i,a,o,l,u){if(Be.apply(this,arguments),Le){if(!Le)throw Error(s(198));var c=De;Le=!1,De=null,Fe||(Fe=!0,ze=c)}}(r,t,void 0,e),e.currentTarget=null}function Fr(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var s=void 0;if(t)for(var a=r.length-1;0<=a;a--){var o=r[a],l=o.instance,u=o.currentTarget;if(o=o.listener,l!==s&&i.isPropagationStopped())break e;Dr(i,o,u),s=l}else for(a=0;a<r.length;a++){if(l=(o=r[a]).instance,u=o.currentTarget,o=o.listener,l!==s&&i.isPropagationStopped())break e;Dr(i,o,u),s=l}}}if(Fe)throw e=ze,Fe=!1,ze=null,e}function zr(e,t){var n=t[mi];void 0===n&&(n=t[mi]=new Set);var r=e+"__bubble";n.has(r)||(qr(t,e,2,!1),n.add(r))}function Mr(e,t,n){var r=0;t&&(r|=4),qr(n,e,r,t)}var Br="_reactListening"+Math.random().toString(36).slice(2);function Ur(e){if(!e[Br]){e[Br]=!0,a.forEach((function(t){"selectionchange"!==t&&(Lr.has(t)||Mr(t,!1,e),Mr(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Br]||(t[Br]=!0,Mr("selectionchange",!1,t))}}function qr(e,t,n,r){switch(Qt(t)){case 1:var i=Ht;break;case 4:i=Vt;break;default:i=Jt}n=i.bind(null,t,n,e),i=void 0,!$e||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(i=!0),r?void 0!==i?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):void 0!==i?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function Wr(e,t,n,r,i){var s=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var a=r.tag;if(3===a||4===a){var o=r.stateNode.containerInfo;if(o===i||8===o.nodeType&&o.parentNode===i)break;if(4===a)for(a=r.return;null!==a;){var l=a.tag;if((3===l||4===l)&&((l=a.stateNode.containerInfo)===i||8===l.nodeType&&l.parentNode===i))return;a=a.return}for(;null!==o;){if(null===(a=yi(o)))return;if(5===(l=a.tag)||6===l){r=s=a;continue e}o=o.parentNode}}r=r.return}Oe((function(){var r=s,i=we(n),a=[];e:{var o=Pr.get(e);if(void 0!==o){var l=cn,u=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":l=En;break;case"focusin":u="focus",l=gn;break;case"focusout":u="blur",l=gn;break;case"beforeblur":case"afterblur":l=gn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=fn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=mn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=Rn;break;case Cr:case Er:case Tr:l=vn;break;case Rr:l=Pn;break;case"scroll":l=hn;break;case"wheel":l=Nn;break;case"copy":case"cut":case"paste":l=bn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=Tn}var c=0!==(4&t),d=!c&&"scroll"===e,h=c?null!==o?o+"Capture":null:o;c=[];for(var p,f=r;null!==f;){var m=(p=f).stateNode;if(5===p.tag&&null!==m&&(p=m,null!==h&&(null!=(m=Ne(f,h))&&c.push(Hr(f,m,p)))),d)break;f=f.return}0<c.length&&(o=new l(o,u,null,n,i),a.push({event:o,listeners:c}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(o="mouseover"===e||"pointerover"===e)||n===xe||!(u=n.relatedTarget||n.fromElement)||!yi(u)&&!u[fi])&&(l||o)&&(o=i.window===i?i:(o=i.ownerDocument)?o.defaultView||o.parentWindow:window,l?(l=r,null!==(u=(u=n.relatedTarget||n.toElement)?yi(u):null)&&(u!==(d=Ue(u))||5!==u.tag&&6!==u.tag)&&(u=null)):(l=null,u=r),l!==u)){if(c=fn,m="onMouseLeave",h="onMouseEnter",f="mouse","pointerout"!==e&&"pointerover"!==e||(c=Tn,m="onPointerLeave",h="onPointerEnter",f="pointer"),d=null==l?o:xi(l),p=null==u?o:xi(u),(o=new c(m,f+"leave",l,n,i)).target=d,o.relatedTarget=p,m=null,yi(i)===r&&((c=new c(h,f+"enter",u,n,i)).target=p,c.relatedTarget=d,m=c),d=m,l&&u)e:{for(h=u,f=0,p=c=l;p;p=Jr(p))f++;for(p=0,m=h;m;m=Jr(m))p++;for(;0<f-p;)c=Jr(c),f--;for(;0<p-f;)h=Jr(h),p--;for(;f--;){if(c===h||null!==h&&c===h.alternate)break e;c=Jr(c),h=Jr(h)}c=null}else c=null;null!==l&&Kr(a,o,l,c,!1),null!==u&&null!==d&&Kr(a,d,u,c,!0)}if("select"===(l=(o=r?xi(r):window).nodeName&&o.nodeName.toLowerCase())||"input"===l&&"file"===o.type)var g=Qn;else if(Wn(o))if(Yn)g=ar;else{g=ir;var v=rr}else(l=o.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===o.type||"radio"===o.type)&&(g=sr);switch(g&&(g=g(e,r))?Hn(a,g,n,i):(v&&v(e,o,r),"focusout"===e&&(v=o._wrapperState)&&v.controlled&&"number"===o.type&&ee(o,"number",o.value)),v=r?xi(r):window,e){case"focusin":(Wn(v)||"true"===v.contentEditable)&&(gr=v,vr=r,yr=null);break;case"focusout":yr=vr=gr=null;break;case"mousedown":br=!0;break;case"contextmenu":case"mouseup":case"dragend":br=!1,xr(a,n,i);break;case"selectionchange":if(mr)break;case"keydown":case"keyup":xr(a,n,i)}var y;if(In)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else Un?Mn(e,n)&&(b="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(b="onCompositionStart");b&&(Dn&&"ko"!==n.locale&&(Un||"onCompositionStart"!==b?"onCompositionEnd"===b&&Un&&(y=en()):(Xt="value"in(Yt=i)?Yt.value:Yt.textContent,Un=!0)),0<(v=Vr(r,b)).length&&(b=new xn(b,e,null,n,i),a.push({event:b,listeners:v}),y?b.data=y:null!==(y=Bn(n))&&(b.data=y))),(y=Ln?function(e,t){switch(e){case"compositionend":return Bn(t);case"keypress":return 32!==t.which?null:(zn=!0,Fn);case"textInput":return(e=t.data)===Fn&&zn?null:e;default:return null}}(e,n):function(e,t){if(Un)return"compositionend"===e||!In&&Mn(e,t)?(e=en(),Zt=Xt=Yt=null,Un=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Dn&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=Vr(r,"onBeforeInput")).length&&(i=new xn("onBeforeInput","beforeinput",null,n,i),a.push({event:i,listeners:r}),i.data=y))}Fr(a,t)}))}function Hr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Vr(e,t){for(var n=t+"Capture",r=[];null!==e;){var i=e,s=i.stateNode;5===i.tag&&null!==s&&(i=s,null!=(s=Ne(e,n))&&r.unshift(Hr(e,s,i)),null!=(s=Ne(e,t))&&r.push(Hr(e,s,i))),e=e.return}return r}function Jr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Kr(e,t,n,r,i){for(var s=t._reactName,a=[];null!==n&&n!==r;){var o=n,l=o.alternate,u=o.stateNode;if(null!==l&&l===r)break;5===o.tag&&null!==u&&(o=u,i?null!=(l=Ne(n,s))&&a.unshift(Hr(n,l,o)):i||null!=(l=Ne(n,s))&&a.push(Hr(n,l,o))),n=n.return}0!==a.length&&e.push({event:t,listeners:a})}var Gr=/\r\n?/g,Qr=/\u0000|\uFFFD/g;function Yr(e){return("string"===typeof e?e:""+e).replace(Gr,"\n").replace(Qr,"")}function Xr(e,t,n){if(t=Yr(t),Yr(e)!==t&&n)throw Error(s(425))}function Zr(){}var ei=null,ti=null;function ni(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ri="function"===typeof setTimeout?setTimeout:void 0,ii="function"===typeof clearTimeout?clearTimeout:void 0,si="function"===typeof Promise?Promise:void 0,ai="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof si?function(e){return si.resolve(null).then(e).catch(oi)}:ri;function oi(e){setTimeout((function(){throw e}))}function li(e,t){var n=t,r=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&8===i.nodeType)if("/$"===(n=i.data)){if(0===r)return e.removeChild(i),void Ut(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=i}while(n);Ut(t)}function ui(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function ci(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var di=Math.random().toString(36).slice(2),hi="__reactFiber$"+di,pi="__reactProps$"+di,fi="__reactContainer$"+di,mi="__reactEvents$"+di,gi="__reactListeners$"+di,vi="__reactHandles$"+di;function yi(e){var t=e[hi];if(t)return t;for(var n=e.parentNode;n;){if(t=n[fi]||n[hi]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=ci(e);null!==e;){if(n=e[hi])return n;e=ci(e)}return t}n=(e=n).parentNode}return null}function bi(e){return!(e=e[hi]||e[fi])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function xi(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(s(33))}function wi(e){return e[pi]||null}var _i=[],ki=-1;function Si(e){return{current:e}}function ji(e){0>ki||(e.current=_i[ki],_i[ki]=null,ki--)}function Ci(e,t){ki++,_i[ki]=e.current,e.current=t}var Ei={},Ti=Si(Ei),Ri=Si(!1),Pi=Ei;function Oi(e,t){var n=e.type.contextTypes;if(!n)return Ei;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i,s={};for(i in n)s[i]=t[i];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Ni(e){return null!==(e=e.childContextTypes)&&void 0!==e}function $i(){ji(Ri),ji(Ti)}function Ii(e,t,n){if(Ti.current!==Ei)throw Error(s(168));Ci(Ti,t),Ci(Ri,n)}function Ai(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var i in r=r.getChildContext())if(!(i in t))throw Error(s(108,q(e)||"Unknown",i));return D({},n,r)}function Li(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ei,Pi=Ti.current,Ci(Ti,e),Ci(Ri,Ri.current),!0}function Di(e,t,n){var r=e.stateNode;if(!r)throw Error(s(169));n?(e=Ai(e,t,Pi),r.__reactInternalMemoizedMergedChildContext=e,ji(Ri),ji(Ti),Ci(Ti,e)):ji(Ri),Ci(Ri,n)}var Fi=null,zi=!1,Mi=!1;function Bi(e){null===Fi?Fi=[e]:Fi.push(e)}function Ui(){if(!Mi&&null!==Fi){Mi=!0;var e=0,t=bt;try{var n=Fi;for(bt=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}Fi=null,zi=!1}catch(i){throw null!==Fi&&(Fi=Fi.slice(e+1)),Je(Ze,Ui),i}finally{bt=t,Mi=!1}}return null}var qi=[],Wi=0,Hi=null,Vi=0,Ji=[],Ki=0,Gi=null,Qi=1,Yi="";function Xi(e,t){qi[Wi++]=Vi,qi[Wi++]=Hi,Hi=e,Vi=t}function Zi(e,t,n){Ji[Ki++]=Qi,Ji[Ki++]=Yi,Ji[Ki++]=Gi,Gi=e;var r=Qi;e=Yi;var i=32-at(r)-1;r&=~(1<<i),n+=1;var s=32-at(t)+i;if(30<s){var a=i-i%5;s=(r&(1<<a)-1).toString(32),r>>=a,i-=a,Qi=1<<32-at(t)+i|n<<i|r,Yi=s+e}else Qi=1<<s|n<<i|r,Yi=e}function es(e){null!==e.return&&(Xi(e,1),Zi(e,1,0))}function ts(e){for(;e===Hi;)Hi=qi[--Wi],qi[Wi]=null,Vi=qi[--Wi],qi[Wi]=null;for(;e===Gi;)Gi=Ji[--Ki],Ji[Ki]=null,Yi=Ji[--Ki],Ji[Ki]=null,Qi=Ji[--Ki],Ji[Ki]=null}var ns=null,rs=null,is=!1,ss=null;function as(e,t){var n=Nu(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function os(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,ns=e,rs=ui(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,ns=e,rs=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Gi?{id:Qi,overflow:Yi}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Nu(18,null,null,0)).stateNode=t,n.return=e,e.child=n,ns=e,rs=null,!0);default:return!1}}function ls(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function us(e){if(is){var t=rs;if(t){var n=t;if(!os(e,t)){if(ls(e))throw Error(s(418));t=ui(n.nextSibling);var r=ns;t&&os(e,t)?as(r,n):(e.flags=-4097&e.flags|2,is=!1,ns=e)}}else{if(ls(e))throw Error(s(418));e.flags=-4097&e.flags|2,is=!1,ns=e}}}function cs(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;ns=e}function ds(e){if(e!==ns)return!1;if(!is)return cs(e),is=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!ni(e.type,e.memoizedProps)),t&&(t=rs)){if(ls(e))throw hs(),Error(s(418));for(;t;)as(e,t),t=ui(t.nextSibling)}if(cs(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(s(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){rs=ui(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}rs=null}}else rs=ns?ui(e.stateNode.nextSibling):null;return!0}function hs(){for(var e=rs;e;)e=ui(e.nextSibling)}function ps(){rs=ns=null,is=!1}function fs(e){null===ss?ss=[e]:ss.push(e)}var ms=x.ReactCurrentBatchConfig;function gs(e,t){if(e&&e.defaultProps){for(var n in t=D({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}var vs=Si(null),ys=null,bs=null,xs=null;function ws(){xs=bs=ys=null}function _s(e){var t=vs.current;ji(vs),e._currentValue=t}function ks(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Ss(e,t){ys=e,xs=bs=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(xo=!0),e.firstContext=null)}function js(e){var t=e._currentValue;if(xs!==e)if(e={context:e,memoizedValue:t,next:null},null===bs){if(null===ys)throw Error(s(308));bs=e,ys.dependencies={lanes:0,firstContext:e}}else bs=bs.next=e;return t}var Cs=null;function Es(e){null===Cs?Cs=[e]:Cs.push(e)}function Ts(e,t,n,r){var i=t.interleaved;return null===i?(n.next=n,Es(t)):(n.next=i.next,i.next=n),t.interleaved=n,Rs(e,r)}function Rs(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Ps=!1;function Os(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ns(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function $s(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Is(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&Rl)){var i=r.pending;return null===i?t.next=t:(t.next=i.next,i.next=t),r.pending=t,Rs(e,n)}return null===(i=r.interleaved)?(t.next=t,Es(r)):(t.next=i.next,i.next=t),r.interleaved=t,Rs(e,n)}function As(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,yt(e,n)}}function Ls(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var i=null,s=null;if(null!==(n=n.firstBaseUpdate)){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===s?i=s=a:s=s.next=a,n=n.next}while(null!==n);null===s?i=s=t:s=s.next=t}else i=s=t;return n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Ds(e,t,n,r){var i=e.updateQueue;Ps=!1;var s=i.firstBaseUpdate,a=i.lastBaseUpdate,o=i.shared.pending;if(null!==o){i.shared.pending=null;var l=o,u=l.next;l.next=null,null===a?s=u:a.next=u,a=l;var c=e.alternate;null!==c&&((o=(c=c.updateQueue).lastBaseUpdate)!==a&&(null===o?c.firstBaseUpdate=u:o.next=u,c.lastBaseUpdate=l))}if(null!==s){var d=i.baseState;for(a=0,c=u=l=null,o=s;;){var h=o.lane,p=o.eventTime;if((r&h)===h){null!==c&&(c=c.next={eventTime:p,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var f=e,m=o;switch(h=t,p=n,m.tag){case 1:if("function"===typeof(f=m.payload)){d=f.call(p,d,h);break e}d=f;break e;case 3:f.flags=-65537&f.flags|128;case 0:if(null===(h="function"===typeof(f=m.payload)?f.call(p,d,h):f)||void 0===h)break e;d=D({},d,h);break e;case 2:Ps=!0}}null!==o.callback&&0!==o.lane&&(e.flags|=64,null===(h=i.effects)?i.effects=[o]:h.push(o))}else p={eventTime:p,lane:h,tag:o.tag,payload:o.payload,callback:o.callback,next:null},null===c?(u=c=p,l=d):c=c.next=p,a|=h;if(null===(o=o.next)){if(null===(o=i.shared.pending))break;o=(h=o).next,h.next=null,i.lastBaseUpdate=h,i.shared.pending=null}}if(null===c&&(l=d),i.baseState=l,i.firstBaseUpdate=u,i.lastBaseUpdate=c,null!==(t=i.shared.interleaved)){i=t;do{a|=i.lane,i=i.next}while(i!==t)}else null===s&&(i.shared.lanes=0);Dl|=a,e.lanes=a,e.memoizedState=d}}function Fs(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(null!==i){if(r.callback=null,r=n,"function"!==typeof i)throw Error(s(191,i));i.call(r)}}}var zs=(new r.Component).refs;function Ms(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:D({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var Bs={isMounted:function(e){return!!(e=e._reactInternals)&&Ue(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=tu(),i=nu(e),s=$s(r,i);s.payload=t,void 0!==n&&null!==n&&(s.callback=n),null!==(t=Is(e,s,i))&&(ru(t,e,i,r),As(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=tu(),i=nu(e),s=$s(r,i);s.tag=1,s.payload=t,void 0!==n&&null!==n&&(s.callback=n),null!==(t=Is(e,s,i))&&(ru(t,e,i,r),As(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=tu(),r=nu(e),i=$s(n,r);i.tag=2,void 0!==t&&null!==t&&(i.callback=t),null!==(t=Is(e,i,r))&&(ru(t,e,r,n),As(t,e,r))}};function Us(e,t,n,r,i,s,a){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,s,a):!t.prototype||!t.prototype.isPureReactComponent||(!lr(n,r)||!lr(i,s))}function qs(e,t,n){var r=!1,i=Ei,s=t.contextType;return"object"===typeof s&&null!==s?s=js(s):(i=Ni(t)?Pi:Ti.current,s=(r=null!==(r=t.contextTypes)&&void 0!==r)?Oi(e,i):Ei),t=new t(n,s),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=Bs,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=s),t}function Ws(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&Bs.enqueueReplaceState(t,t.state,null)}function Hs(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs=zs,Os(e);var s=t.contextType;"object"===typeof s&&null!==s?i.context=js(s):(s=Ni(t)?Pi:Ti.current,i.context=Oi(e,s)),i.state=e.memoizedState,"function"===typeof(s=t.getDerivedStateFromProps)&&(Ms(e,t,s,n),i.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof i.getSnapshotBeforeUpdate||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||(t=i.state,"function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),t!==i.state&&Bs.enqueueReplaceState(i,i.state,null),Ds(e,n,i,r),i.state=e.memoizedState),"function"===typeof i.componentDidMount&&(e.flags|=4194308)}function Vs(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(s(309));var r=n.stateNode}if(!r)throw Error(s(147,e));var i=r,a=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===a?t.ref:(t=function(e){var t=i.refs;t===zs&&(t=i.refs={}),null===e?delete t[a]:t[a]=e},t._stringRef=a,t)}if("string"!==typeof e)throw Error(s(284));if(!n._owner)throw Error(s(290,e))}return e}function Js(e,t){throw e=Object.prototype.toString.call(t),Error(s(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Ks(e){return(0,e._init)(e._payload)}function Gs(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function i(e,t){return(e=Iu(e,t)).index=0,e.sibling=null,e}function a(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function o(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,n,r){return null===t||6!==t.tag?((t=Fu(n,e.mode,r)).return=e,t):((t=i(t,n)).return=e,t)}function u(e,t,n,r){var s=n.type;return s===k?d(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===s||"object"===typeof s&&null!==s&&s.$$typeof===N&&Ks(s)===t.type)?((r=i(t,n.props)).ref=Vs(e,t,n),r.return=e,r):((r=Au(n.type,n.key,n.props,null,e.mode,r)).ref=Vs(e,t,n),r.return=e,r)}function c(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=zu(n,e.mode,r)).return=e,t):((t=i(t,n.children||[])).return=e,t)}function d(e,t,n,r,s){return null===t||7!==t.tag?((t=Lu(n,e.mode,r,s)).return=e,t):((t=i(t,n)).return=e,t)}function h(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Fu(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case w:return(n=Au(t.type,t.key,t.props,null,e.mode,n)).ref=Vs(e,null,t),n.return=e,n;case _:return(t=zu(t,e.mode,n)).return=e,t;case N:return h(e,(0,t._init)(t._payload),n)}if(te(t)||A(t))return(t=Lu(t,e.mode,n,null)).return=e,t;Js(e,t)}return null}function p(e,t,n,r){var i=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==i?null:l(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case w:return n.key===i?u(e,t,n,r):null;case _:return n.key===i?c(e,t,n,r):null;case N:return p(e,t,(i=n._init)(n._payload),r)}if(te(n)||A(n))return null!==i?null:d(e,t,n,r,null);Js(e,n)}return null}function f(e,t,n,r,i){if("string"===typeof r&&""!==r||"number"===typeof r)return l(t,e=e.get(n)||null,""+r,i);if("object"===typeof r&&null!==r){switch(r.$$typeof){case w:return u(t,e=e.get(null===r.key?n:r.key)||null,r,i);case _:return c(t,e=e.get(null===r.key?n:r.key)||null,r,i);case N:return f(e,t,n,(0,r._init)(r._payload),i)}if(te(r)||A(r))return d(t,e=e.get(n)||null,r,i,null);Js(t,r)}return null}function m(i,s,o,l){for(var u=null,c=null,d=s,m=s=0,g=null;null!==d&&m<o.length;m++){d.index>m?(g=d,d=null):g=d.sibling;var v=p(i,d,o[m],l);if(null===v){null===d&&(d=g);break}e&&d&&null===v.alternate&&t(i,d),s=a(v,s,m),null===c?u=v:c.sibling=v,c=v,d=g}if(m===o.length)return n(i,d),is&&Xi(i,m),u;if(null===d){for(;m<o.length;m++)null!==(d=h(i,o[m],l))&&(s=a(d,s,m),null===c?u=d:c.sibling=d,c=d);return is&&Xi(i,m),u}for(d=r(i,d);m<o.length;m++)null!==(g=f(d,i,m,o[m],l))&&(e&&null!==g.alternate&&d.delete(null===g.key?m:g.key),s=a(g,s,m),null===c?u=g:c.sibling=g,c=g);return e&&d.forEach((function(e){return t(i,e)})),is&&Xi(i,m),u}function g(i,o,l,u){var c=A(l);if("function"!==typeof c)throw Error(s(150));if(null==(l=c.call(l)))throw Error(s(151));for(var d=c=null,m=o,g=o=0,v=null,y=l.next();null!==m&&!y.done;g++,y=l.next()){m.index>g?(v=m,m=null):v=m.sibling;var b=p(i,m,y.value,u);if(null===b){null===m&&(m=v);break}e&&m&&null===b.alternate&&t(i,m),o=a(b,o,g),null===d?c=b:d.sibling=b,d=b,m=v}if(y.done)return n(i,m),is&&Xi(i,g),c;if(null===m){for(;!y.done;g++,y=l.next())null!==(y=h(i,y.value,u))&&(o=a(y,o,g),null===d?c=y:d.sibling=y,d=y);return is&&Xi(i,g),c}for(m=r(i,m);!y.done;g++,y=l.next())null!==(y=f(m,i,g,y.value,u))&&(e&&null!==y.alternate&&m.delete(null===y.key?g:y.key),o=a(y,o,g),null===d?c=y:d.sibling=y,d=y);return e&&m.forEach((function(e){return t(i,e)})),is&&Xi(i,g),c}return function e(r,s,a,l){if("object"===typeof a&&null!==a&&a.type===k&&null===a.key&&(a=a.props.children),"object"===typeof a&&null!==a){switch(a.$$typeof){case w:e:{for(var u=a.key,c=s;null!==c;){if(c.key===u){if((u=a.type)===k){if(7===c.tag){n(r,c.sibling),(s=i(c,a.props.children)).return=r,r=s;break e}}else if(c.elementType===u||"object"===typeof u&&null!==u&&u.$$typeof===N&&Ks(u)===c.type){n(r,c.sibling),(s=i(c,a.props)).ref=Vs(r,c,a),s.return=r,r=s;break e}n(r,c);break}t(r,c),c=c.sibling}a.type===k?((s=Lu(a.props.children,r.mode,l,a.key)).return=r,r=s):((l=Au(a.type,a.key,a.props,null,r.mode,l)).ref=Vs(r,s,a),l.return=r,r=l)}return o(r);case _:e:{for(c=a.key;null!==s;){if(s.key===c){if(4===s.tag&&s.stateNode.containerInfo===a.containerInfo&&s.stateNode.implementation===a.implementation){n(r,s.sibling),(s=i(s,a.children||[])).return=r,r=s;break e}n(r,s);break}t(r,s),s=s.sibling}(s=zu(a,r.mode,l)).return=r,r=s}return o(r);case N:return e(r,s,(c=a._init)(a._payload),l)}if(te(a))return m(r,s,a,l);if(A(a))return g(r,s,a,l);Js(r,a)}return"string"===typeof a&&""!==a||"number"===typeof a?(a=""+a,null!==s&&6===s.tag?(n(r,s.sibling),(s=i(s,a)).return=r,r=s):(n(r,s),(s=Fu(a,r.mode,l)).return=r,r=s),o(r)):n(r,s)}}var Qs=Gs(!0),Ys=Gs(!1),Xs={},Zs=Si(Xs),ea=Si(Xs),ta=Si(Xs);function na(e){if(e===Xs)throw Error(s(174));return e}function ra(e,t){switch(Ci(ta,t),Ci(ea,e),Ci(Zs,Xs),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}ji(Zs),Ci(Zs,t)}function ia(){ji(Zs),ji(ea),ji(ta)}function sa(e){na(ta.current);var t=na(Zs.current),n=le(t,e.type);t!==n&&(Ci(ea,e),Ci(Zs,n))}function aa(e){ea.current===e&&(ji(Zs),ji(ea))}var oa=Si(0);function la(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ua=[];function ca(){for(var e=0;e<ua.length;e++)ua[e]._workInProgressVersionPrimary=null;ua.length=0}var da=x.ReactCurrentDispatcher,ha=x.ReactCurrentBatchConfig,pa=0,fa=null,ma=null,ga=null,va=!1,ya=!1,ba=0,xa=0;function wa(){throw Error(s(321))}function _a(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!or(e[n],t[n]))return!1;return!0}function ka(e,t,n,r,i,a){if(pa=a,fa=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,da.current=null===e||null===e.memoizedState?ao:oo,e=n(r,i),ya){a=0;do{if(ya=!1,ba=0,25<=a)throw Error(s(301));a+=1,ga=ma=null,t.updateQueue=null,da.current=lo,e=n(r,i)}while(ya)}if(da.current=so,t=null!==ma&&null!==ma.next,pa=0,ga=ma=fa=null,va=!1,t)throw Error(s(300));return e}function Sa(){var e=0!==ba;return ba=0,e}function ja(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===ga?fa.memoizedState=ga=e:ga=ga.next=e,ga}function Ca(){if(null===ma){var e=fa.alternate;e=null!==e?e.memoizedState:null}else e=ma.next;var t=null===ga?fa.memoizedState:ga.next;if(null!==t)ga=t,ma=e;else{if(null===e)throw Error(s(310));e={memoizedState:(ma=e).memoizedState,baseState:ma.baseState,baseQueue:ma.baseQueue,queue:ma.queue,next:null},null===ga?fa.memoizedState=ga=e:ga=ga.next=e}return ga}function Ea(e,t){return"function"===typeof t?t(e):t}function Ta(e){var t=Ca(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var r=ma,i=r.baseQueue,a=n.pending;if(null!==a){if(null!==i){var o=i.next;i.next=a.next,a.next=o}r.baseQueue=i=a,n.pending=null}if(null!==i){a=i.next,r=r.baseState;var l=o=null,u=null,c=a;do{var d=c.lane;if((pa&d)===d)null!==u&&(u=u.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:e(r,c.action);else{var h={lane:d,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};null===u?(l=u=h,o=r):u=u.next=h,fa.lanes|=d,Dl|=d}c=c.next}while(null!==c&&c!==a);null===u?o=r:u.next=l,or(r,t.memoizedState)||(xo=!0),t.memoizedState=r,t.baseState=o,t.baseQueue=u,n.lastRenderedState=r}if(null!==(e=n.interleaved)){i=e;do{a=i.lane,fa.lanes|=a,Dl|=a,i=i.next}while(i!==e)}else null===i&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Ra(e){var t=Ca(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,a=t.memoizedState;if(null!==i){n.pending=null;var o=i=i.next;do{a=e(a,o.action),o=o.next}while(o!==i);or(a,t.memoizedState)||(xo=!0),t.memoizedState=a,null===t.baseQueue&&(t.baseState=a),n.lastRenderedState=a}return[a,r]}function Pa(){}function Oa(e,t){var n=fa,r=Ca(),i=t(),a=!or(r.memoizedState,i);if(a&&(r.memoizedState=i,xo=!0),r=r.queue,qa(Ia.bind(null,n,r,e),[e]),r.getSnapshot!==t||a||null!==ga&&1&ga.memoizedState.tag){if(n.flags|=2048,Fa(9,$a.bind(null,n,r,i,t),void 0,null),null===Pl)throw Error(s(349));0!==(30&pa)||Na(n,t,i)}return i}function Na(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=fa.updateQueue)?(t={lastEffect:null,stores:null},fa.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function $a(e,t,n,r){t.value=n,t.getSnapshot=r,Aa(t)&&La(e)}function Ia(e,t,n){return n((function(){Aa(t)&&La(e)}))}function Aa(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!or(e,n)}catch(r){return!0}}function La(e){var t=Rs(e,1);null!==t&&ru(t,e,1,-1)}function Da(e){var t=ja();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ea,lastRenderedState:e},t.queue=e,e=e.dispatch=to.bind(null,fa,e),[t.memoizedState,e]}function Fa(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=fa.updateQueue)?(t={lastEffect:null,stores:null},fa.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function za(){return Ca().memoizedState}function Ma(e,t,n,r){var i=ja();fa.flags|=e,i.memoizedState=Fa(1|t,n,void 0,void 0===r?null:r)}function Ba(e,t,n,r){var i=Ca();r=void 0===r?null:r;var s=void 0;if(null!==ma){var a=ma.memoizedState;if(s=a.destroy,null!==r&&_a(r,a.deps))return void(i.memoizedState=Fa(t,n,s,r))}fa.flags|=e,i.memoizedState=Fa(1|t,n,s,r)}function Ua(e,t){return Ma(8390656,8,e,t)}function qa(e,t){return Ba(2048,8,e,t)}function Wa(e,t){return Ba(4,2,e,t)}function Ha(e,t){return Ba(4,4,e,t)}function Va(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Ja(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Ba(4,4,Va.bind(null,t,e),n)}function Ka(){}function Ga(e,t){var n=Ca();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&_a(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Qa(e,t){var n=Ca();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&_a(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Ya(e,t,n){return 0===(21&pa)?(e.baseState&&(e.baseState=!1,xo=!0),e.memoizedState=n):(or(n,t)||(n=mt(),fa.lanes|=n,Dl|=n,e.baseState=!0),t)}function Xa(e,t){var n=bt;bt=0!==n&&4>n?n:4,e(!0);var r=ha.transition;ha.transition={};try{e(!1),t()}finally{bt=n,ha.transition=r}}function Za(){return Ca().memoizedState}function eo(e,t,n){var r=nu(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},no(e))ro(t,n);else if(null!==(n=Ts(e,t,n,r))){ru(n,e,r,tu()),io(n,t,r)}}function to(e,t,n){var r=nu(e),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(no(e))ro(t,i);else{var s=e.alternate;if(0===e.lanes&&(null===s||0===s.lanes)&&null!==(s=t.lastRenderedReducer))try{var a=t.lastRenderedState,o=s(a,n);if(i.hasEagerState=!0,i.eagerState=o,or(o,a)){var l=t.interleaved;return null===l?(i.next=i,Es(t)):(i.next=l.next,l.next=i),void(t.interleaved=i)}}catch(u){}null!==(n=Ts(e,t,i,r))&&(ru(n,e,r,i=tu()),io(n,t,r))}}function no(e){var t=e.alternate;return e===fa||null!==t&&t===fa}function ro(e,t){ya=va=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function io(e,t,n){if(0!==(4194240&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,yt(e,n)}}var so={readContext:js,useCallback:wa,useContext:wa,useEffect:wa,useImperativeHandle:wa,useInsertionEffect:wa,useLayoutEffect:wa,useMemo:wa,useReducer:wa,useRef:wa,useState:wa,useDebugValue:wa,useDeferredValue:wa,useTransition:wa,useMutableSource:wa,useSyncExternalStore:wa,useId:wa,unstable_isNewReconciler:!1},ao={readContext:js,useCallback:function(e,t){return ja().memoizedState=[e,void 0===t?null:t],e},useContext:js,useEffect:Ua,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Ma(4194308,4,Va.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Ma(4194308,4,e,t)},useInsertionEffect:function(e,t){return Ma(4,2,e,t)},useMemo:function(e,t){var n=ja();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=ja();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=eo.bind(null,fa,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},ja().memoizedState=e},useState:Da,useDebugValue:Ka,useDeferredValue:function(e){return ja().memoizedState=e},useTransition:function(){var e=Da(!1),t=e[0];return e=Xa.bind(null,e[1]),ja().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=fa,i=ja();if(is){if(void 0===n)throw Error(s(407));n=n()}else{if(n=t(),null===Pl)throw Error(s(349));0!==(30&pa)||Na(r,t,n)}i.memoizedState=n;var a={value:n,getSnapshot:t};return i.queue=a,Ua(Ia.bind(null,r,a,e),[e]),r.flags|=2048,Fa(9,$a.bind(null,r,a,n,t),void 0,null),n},useId:function(){var e=ja(),t=Pl.identifierPrefix;if(is){var n=Yi;t=":"+t+"R"+(n=(Qi&~(1<<32-at(Qi)-1)).toString(32)+n),0<(n=ba++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=xa++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},oo={readContext:js,useCallback:Ga,useContext:js,useEffect:qa,useImperativeHandle:Ja,useInsertionEffect:Wa,useLayoutEffect:Ha,useMemo:Qa,useReducer:Ta,useRef:za,useState:function(){return Ta(Ea)},useDebugValue:Ka,useDeferredValue:function(e){return Ya(Ca(),ma.memoizedState,e)},useTransition:function(){return[Ta(Ea)[0],Ca().memoizedState]},useMutableSource:Pa,useSyncExternalStore:Oa,useId:Za,unstable_isNewReconciler:!1},lo={readContext:js,useCallback:Ga,useContext:js,useEffect:qa,useImperativeHandle:Ja,useInsertionEffect:Wa,useLayoutEffect:Ha,useMemo:Qa,useReducer:Ra,useRef:za,useState:function(){return Ra(Ea)},useDebugValue:Ka,useDeferredValue:function(e){var t=Ca();return null===ma?t.memoizedState=e:Ya(t,ma.memoizedState,e)},useTransition:function(){return[Ra(Ea)[0],Ca().memoizedState]},useMutableSource:Pa,useSyncExternalStore:Oa,useId:Za,unstable_isNewReconciler:!1};function uo(e,t){try{var n="",r=t;do{n+=B(r),r=r.return}while(r);var i=n}catch(s){i="\nError generating stack: "+s.message+"\n"+s.stack}return{value:e,source:t,stack:i,digest:null}}function co(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function ho(e,t){try{console.error(t.value)}catch(n){setTimeout((function(){throw n}))}}var po="function"===typeof WeakMap?WeakMap:Map;function fo(e,t,n){(n=$s(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Hl||(Hl=!0,Vl=r),ho(0,t)},n}function mo(e,t,n){(n=$s(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var i=t.value;n.payload=function(){return r(i)},n.callback=function(){ho(0,t)}}var s=e.stateNode;return null!==s&&"function"===typeof s.componentDidCatch&&(n.callback=function(){ho(0,t),"function"!==typeof r&&(null===Jl?Jl=new Set([this]):Jl.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function go(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new po;var i=new Set;r.set(t,i)}else void 0===(i=r.get(t))&&(i=new Set,r.set(t,i));i.has(n)||(i.add(n),e=Cu.bind(null,e,t,n),t.then(e,e))}function vo(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function yo(e,t,n,r,i){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=$s(-1,1)).tag=2,Is(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=i,e)}var bo=x.ReactCurrentOwner,xo=!1;function wo(e,t,n,r){t.child=null===e?Ys(t,null,n,r):Qs(t,e.child,n,r)}function _o(e,t,n,r,i){n=n.render;var s=t.ref;return Ss(t,i),r=ka(e,t,n,r,s,i),n=Sa(),null===e||xo?(is&&n&&es(t),t.flags|=1,wo(e,t,r,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Ho(e,t,i))}function ko(e,t,n,r,i){if(null===e){var s=n.type;return"function"!==typeof s||$u(s)||void 0!==s.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Au(n.type,null,r,t,t.mode,i)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=s,So(e,t,s,r,i))}if(s=e.child,0===(e.lanes&i)){var a=s.memoizedProps;if((n=null!==(n=n.compare)?n:lr)(a,r)&&e.ref===t.ref)return Ho(e,t,i)}return t.flags|=1,(e=Iu(s,r)).ref=t.ref,e.return=t,t.child=e}function So(e,t,n,r,i){if(null!==e){var s=e.memoizedProps;if(lr(s,r)&&e.ref===t.ref){if(xo=!1,t.pendingProps=r=s,0===(e.lanes&i))return t.lanes=e.lanes,Ho(e,t,i);0!==(131072&e.flags)&&(xo=!0)}}return Eo(e,t,n,r,i)}function jo(e,t,n){var r=t.pendingProps,i=r.children,s=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ci(Il,$l),$l|=n;else{if(0===(1073741824&n))return e=null!==s?s.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ci(Il,$l),$l|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==s?s.baseLanes:n,Ci(Il,$l),$l|=r}else null!==s?(r=s.baseLanes|n,t.memoizedState=null):r=n,Ci(Il,$l),$l|=r;return wo(e,t,i,n),t.child}function Co(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Eo(e,t,n,r,i){var s=Ni(n)?Pi:Ti.current;return s=Oi(t,s),Ss(t,i),n=ka(e,t,n,r,s,i),r=Sa(),null===e||xo?(is&&r&&es(t),t.flags|=1,wo(e,t,n,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Ho(e,t,i))}function To(e,t,n,r,i){if(Ni(n)){var s=!0;Li(t)}else s=!1;if(Ss(t,i),null===t.stateNode)Wo(e,t),qs(t,n,r),Hs(t,n,r,i),r=!0;else if(null===e){var a=t.stateNode,o=t.memoizedProps;a.props=o;var l=a.context,u=n.contextType;"object"===typeof u&&null!==u?u=js(u):u=Oi(t,u=Ni(n)?Pi:Ti.current);var c=n.getDerivedStateFromProps,d="function"===typeof c||"function"===typeof a.getSnapshotBeforeUpdate;d||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(o!==r||l!==u)&&Ws(t,a,r,u),Ps=!1;var h=t.memoizedState;a.state=h,Ds(t,r,a,i),l=t.memoizedState,o!==r||h!==l||Ri.current||Ps?("function"===typeof c&&(Ms(t,n,c,r),l=t.memoizedState),(o=Ps||Us(t,n,o,r,h,l,u))?(d||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||("function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount()),"function"===typeof a.componentDidMount&&(t.flags|=4194308)):("function"===typeof a.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=l),a.props=r,a.state=l,a.context=u,r=o):("function"===typeof a.componentDidMount&&(t.flags|=4194308),r=!1)}else{a=t.stateNode,Ns(e,t),o=t.memoizedProps,u=t.type===t.elementType?o:gs(t.type,o),a.props=u,d=t.pendingProps,h=a.context,"object"===typeof(l=n.contextType)&&null!==l?l=js(l):l=Oi(t,l=Ni(n)?Pi:Ti.current);var p=n.getDerivedStateFromProps;(c="function"===typeof p||"function"===typeof a.getSnapshotBeforeUpdate)||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(o!==d||h!==l)&&Ws(t,a,r,l),Ps=!1,h=t.memoizedState,a.state=h,Ds(t,r,a,i);var f=t.memoizedState;o!==d||h!==f||Ri.current||Ps?("function"===typeof p&&(Ms(t,n,p,r),f=t.memoizedState),(u=Ps||Us(t,n,u,r,h,f,l)||!1)?(c||"function"!==typeof a.UNSAFE_componentWillUpdate&&"function"!==typeof a.componentWillUpdate||("function"===typeof a.componentWillUpdate&&a.componentWillUpdate(r,f,l),"function"===typeof a.UNSAFE_componentWillUpdate&&a.UNSAFE_componentWillUpdate(r,f,l)),"function"===typeof a.componentDidUpdate&&(t.flags|=4),"function"===typeof a.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof a.componentDidUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=f),a.props=r,a.state=f,a.context=l,r=u):("function"!==typeof a.componentDidUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),r=!1)}return Ro(e,t,n,r,s,i)}function Ro(e,t,n,r,i,s){Co(e,t);var a=0!==(128&t.flags);if(!r&&!a)return i&&Di(t,n,!1),Ho(e,t,s);r=t.stateNode,bo.current=t;var o=a&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&a?(t.child=Qs(t,e.child,null,s),t.child=Qs(t,null,o,s)):wo(e,t,o,s),t.memoizedState=r.state,i&&Di(t,n,!0),t.child}function Po(e){var t=e.stateNode;t.pendingContext?Ii(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Ii(0,t.context,!1),ra(e,t.containerInfo)}function Oo(e,t,n,r,i){return ps(),fs(i),t.flags|=256,wo(e,t,n,r),t.child}var No,$o,Io,Ao,Lo={dehydrated:null,treeContext:null,retryLane:0};function Do(e){return{baseLanes:e,cachePool:null,transitions:null}}function Fo(e,t,n){var r,i=t.pendingProps,a=oa.current,o=!1,l=0!==(128&t.flags);if((r=l)||(r=(null===e||null!==e.memoizedState)&&0!==(2&a)),r?(o=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(a|=1),Ci(oa,1&a),null===e)return us(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=i.children,e=i.fallback,o?(i=t.mode,o=t.child,l={mode:"hidden",children:l},0===(1&i)&&null!==o?(o.childLanes=0,o.pendingProps=l):o=Du(l,i,0,null),e=Lu(e,i,n,null),o.return=t,e.return=t,o.sibling=e,t.child=o,t.child.memoizedState=Do(n),t.memoizedState=Lo,e):zo(t,l));if(null!==(a=e.memoizedState)&&null!==(r=a.dehydrated))return function(e,t,n,r,i,a,o){if(n)return 256&t.flags?(t.flags&=-257,Mo(e,t,o,r=co(Error(s(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(a=r.fallback,i=t.mode,r=Du({mode:"visible",children:r.children},i,0,null),(a=Lu(a,i,o,null)).flags|=2,r.return=t,a.return=t,r.sibling=a,t.child=r,0!==(1&t.mode)&&Qs(t,e.child,null,o),t.child.memoizedState=Do(o),t.memoizedState=Lo,a);if(0===(1&t.mode))return Mo(e,t,o,null);if("$!"===i.data){if(r=i.nextSibling&&i.nextSibling.dataset)var l=r.dgst;return r=l,Mo(e,t,o,r=co(a=Error(s(419)),r,void 0))}if(l=0!==(o&e.childLanes),xo||l){if(null!==(r=Pl)){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}0!==(i=0!==(i&(r.suspendedLanes|o))?0:i)&&i!==a.retryLane&&(a.retryLane=i,Rs(e,i),ru(r,e,i,-1))}return gu(),Mo(e,t,o,r=co(Error(s(421))))}return"$?"===i.data?(t.flags|=128,t.child=e.child,t=Tu.bind(null,e),i._reactRetry=t,null):(e=a.treeContext,rs=ui(i.nextSibling),ns=t,is=!0,ss=null,null!==e&&(Ji[Ki++]=Qi,Ji[Ki++]=Yi,Ji[Ki++]=Gi,Qi=e.id,Yi=e.overflow,Gi=t),t=zo(t,r.children),t.flags|=4096,t)}(e,t,l,i,r,a,n);if(o){o=i.fallback,l=t.mode,r=(a=e.child).sibling;var u={mode:"hidden",children:i.children};return 0===(1&l)&&t.child!==a?((i=t.child).childLanes=0,i.pendingProps=u,t.deletions=null):(i=Iu(a,u)).subtreeFlags=14680064&a.subtreeFlags,null!==r?o=Iu(r,o):(o=Lu(o,l,n,null)).flags|=2,o.return=t,i.return=t,i.sibling=o,t.child=i,i=o,o=t.child,l=null===(l=e.child.memoizedState)?Do(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},o.memoizedState=l,o.childLanes=e.childLanes&~n,t.memoizedState=Lo,i}return e=(o=e.child).sibling,i=Iu(o,{mode:"visible",children:i.children}),0===(1&t.mode)&&(i.lanes=n),i.return=t,i.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=i,t.memoizedState=null,i}function zo(e,t){return(t=Du({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Mo(e,t,n,r){return null!==r&&fs(r),Qs(t,e.child,null,n),(e=zo(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Bo(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),ks(e.return,t,n)}function Uo(e,t,n,r,i){var s=e.memoizedState;null===s?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function qo(e,t,n){var r=t.pendingProps,i=r.revealOrder,s=r.tail;if(wo(e,t,r.children,n),0!==(2&(r=oa.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Bo(e,n,t);else if(19===e.tag)Bo(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Ci(oa,r),0===(1&t.mode))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;null!==n;)null!==(e=n.alternate)&&null===la(e)&&(i=n),n=n.sibling;null===(n=i)?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),Uo(t,!1,i,n,s);break;case"backwards":for(n=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===la(e)){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}Uo(t,!0,n,null,s);break;case"together":Uo(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Wo(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Ho(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Dl|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(s(153));if(null!==t.child){for(n=Iu(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Iu(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Vo(e,t){if(!is)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Jo(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=14680064&i.subtreeFlags,r|=14680064&i.flags,i.return=e,i=i.sibling;else for(i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Ko(e,t,n){var r=t.pendingProps;switch(ts(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Jo(t),null;case 1:case 17:return Ni(t.type)&&$i(),Jo(t),null;case 3:return r=t.stateNode,ia(),ji(Ri),ji(Ti),ca(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(ds(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==ss&&(ou(ss),ss=null))),$o(e,t),Jo(t),null;case 5:aa(t);var i=na(ta.current);if(n=t.type,null!==e&&null!=t.stateNode)Io(e,t,n,r,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(s(166));return Jo(t),null}if(e=na(Zs.current),ds(t)){r=t.stateNode,n=t.type;var a=t.memoizedProps;switch(r[hi]=t,r[pi]=a,e=0!==(1&t.mode),n){case"dialog":zr("cancel",r),zr("close",r);break;case"iframe":case"object":case"embed":zr("load",r);break;case"video":case"audio":for(i=0;i<Ar.length;i++)zr(Ar[i],r);break;case"source":zr("error",r);break;case"img":case"image":case"link":zr("error",r),zr("load",r);break;case"details":zr("toggle",r);break;case"input":Q(r,a),zr("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!a.multiple},zr("invalid",r);break;case"textarea":ie(r,a),zr("invalid",r)}for(var l in ye(n,a),i=null,a)if(a.hasOwnProperty(l)){var u=a[l];"children"===l?"string"===typeof u?r.textContent!==u&&(!0!==a.suppressHydrationWarning&&Xr(r.textContent,u,e),i=["children",u]):"number"===typeof u&&r.textContent!==""+u&&(!0!==a.suppressHydrationWarning&&Xr(r.textContent,u,e),i=["children",""+u]):o.hasOwnProperty(l)&&null!=u&&"onScroll"===l&&zr("scroll",r)}switch(n){case"input":V(r),Z(r,a,!0);break;case"textarea":V(r),ae(r);break;case"select":case"option":break;default:"function"===typeof a.onClick&&(r.onclick=Zr)}r=i,t.updateQueue=r,null!==r&&(t.flags|=4)}else{l=9===i.nodeType?i:i.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=oe(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=l.createElement(n,{is:r.is}):(e=l.createElement(n),"select"===n&&(l=e,r.multiple?l.multiple=!0:r.size&&(l.size=r.size))):e=l.createElementNS(e,n),e[hi]=t,e[pi]=r,No(e,t,!1,!1),t.stateNode=e;e:{switch(l=be(n,r),n){case"dialog":zr("cancel",e),zr("close",e),i=r;break;case"iframe":case"object":case"embed":zr("load",e),i=r;break;case"video":case"audio":for(i=0;i<Ar.length;i++)zr(Ar[i],e);i=r;break;case"source":zr("error",e),i=r;break;case"img":case"image":case"link":zr("error",e),zr("load",e),i=r;break;case"details":zr("toggle",e),i=r;break;case"input":Q(e,r),i=G(e,r),zr("invalid",e);break;case"option":default:i=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},i=D({},r,{value:void 0}),zr("invalid",e);break;case"textarea":ie(e,r),i=re(e,r),zr("invalid",e)}for(a in ye(n,i),u=i)if(u.hasOwnProperty(a)){var c=u[a];"style"===a?ge(e,c):"dangerouslySetInnerHTML"===a?null!=(c=c?c.__html:void 0)&&de(e,c):"children"===a?"string"===typeof c?("textarea"!==n||""!==c)&&he(e,c):"number"===typeof c&&he(e,""+c):"suppressContentEditableWarning"!==a&&"suppressHydrationWarning"!==a&&"autoFocus"!==a&&(o.hasOwnProperty(a)?null!=c&&"onScroll"===a&&zr("scroll",e):null!=c&&b(e,a,c,l))}switch(n){case"input":V(e),Z(e,r,!1);break;case"textarea":V(e),ae(e);break;case"option":null!=r.value&&e.setAttribute("value",""+W(r.value));break;case"select":e.multiple=!!r.multiple,null!=(a=r.value)?ne(e,!!r.multiple,a,!1):null!=r.defaultValue&&ne(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof i.onClick&&(e.onclick=Zr)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Jo(t),null;case 6:if(e&&null!=t.stateNode)Ao(e,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(s(166));if(n=na(ta.current),na(Zs.current),ds(t)){if(r=t.stateNode,n=t.memoizedProps,r[hi]=t,(a=r.nodeValue!==n)&&null!==(e=ns))switch(e.tag){case 3:Xr(r.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Xr(r.nodeValue,n,0!==(1&e.mode))}a&&(t.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[hi]=t,t.stateNode=r}return Jo(t),null;case 13:if(ji(oa),r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(is&&null!==rs&&0!==(1&t.mode)&&0===(128&t.flags))hs(),ps(),t.flags|=98560,a=!1;else if(a=ds(t),null!==r&&null!==r.dehydrated){if(null===e){if(!a)throw Error(s(318));if(!(a=null!==(a=t.memoizedState)?a.dehydrated:null))throw Error(s(317));a[hi]=t}else ps(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Jo(t),a=!1}else null!==ss&&(ou(ss),ss=null),a=!0;if(!a)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((r=null!==r)!==(null!==e&&null!==e.memoizedState)&&r&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&oa.current)?0===Al&&(Al=3):gu())),null!==t.updateQueue&&(t.flags|=4),Jo(t),null);case 4:return ia(),$o(e,t),null===e&&Ur(t.stateNode.containerInfo),Jo(t),null;case 10:return _s(t.type._context),Jo(t),null;case 19:if(ji(oa),null===(a=t.memoizedState))return Jo(t),null;if(r=0!==(128&t.flags),null===(l=a.rendering))if(r)Vo(a,!1);else{if(0!==Al||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(l=la(e))){for(t.flags|=128,Vo(a,!1),null!==(r=l.updateQueue)&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;null!==n;)e=r,(a=n).flags&=14680066,null===(l=a.alternate)?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=l.childLanes,a.lanes=l.lanes,a.child=l.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=l.memoizedProps,a.memoizedState=l.memoizedState,a.updateQueue=l.updateQueue,a.type=l.type,e=l.dependencies,a.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Ci(oa,1&oa.current|2),t.child}e=e.sibling}null!==a.tail&&Ye()>ql&&(t.flags|=128,r=!0,Vo(a,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=la(l))){if(t.flags|=128,r=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Vo(a,!0),null===a.tail&&"hidden"===a.tailMode&&!l.alternate&&!is)return Jo(t),null}else 2*Ye()-a.renderingStartTime>ql&&1073741824!==n&&(t.flags|=128,r=!0,Vo(a,!1),t.lanes=4194304);a.isBackwards?(l.sibling=t.child,t.child=l):(null!==(n=a.last)?n.sibling=l:t.child=l,a.last=l)}return null!==a.tail?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=Ye(),t.sibling=null,n=oa.current,Ci(oa,r?1&n|2:1&n),t):(Jo(t),null);case 22:case 23:return hu(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&0!==(1&t.mode)?0!==(1073741824&$l)&&(Jo(t),6&t.subtreeFlags&&(t.flags|=8192)):Jo(t),null;case 24:case 25:return null}throw Error(s(156,t.tag))}function Go(e,t){switch(ts(t),t.tag){case 1:return Ni(t.type)&&$i(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return ia(),ji(Ri),ji(Ti),ca(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return aa(t),null;case 13:if(ji(oa),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(s(340));ps()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return ji(oa),null;case 4:return ia(),null;case 10:return _s(t.type._context),null;case 22:case 23:return hu(),null;default:return null}}No=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},$o=function(){},Io=function(e,t,n,r){var i=e.memoizedProps;if(i!==r){e=t.stateNode,na(Zs.current);var s,a=null;switch(n){case"input":i=G(e,i),r=G(e,r),a=[];break;case"select":i=D({},i,{value:void 0}),r=D({},r,{value:void 0}),a=[];break;case"textarea":i=re(e,i),r=re(e,r),a=[];break;default:"function"!==typeof i.onClick&&"function"===typeof r.onClick&&(e.onclick=Zr)}for(c in ye(n,r),n=null,i)if(!r.hasOwnProperty(c)&&i.hasOwnProperty(c)&&null!=i[c])if("style"===c){var l=i[c];for(s in l)l.hasOwnProperty(s)&&(n||(n={}),n[s]="")}else"dangerouslySetInnerHTML"!==c&&"children"!==c&&"suppressContentEditableWarning"!==c&&"suppressHydrationWarning"!==c&&"autoFocus"!==c&&(o.hasOwnProperty(c)?a||(a=[]):(a=a||[]).push(c,null));for(c in r){var u=r[c];if(l=null!=i?i[c]:void 0,r.hasOwnProperty(c)&&u!==l&&(null!=u||null!=l))if("style"===c)if(l){for(s in l)!l.hasOwnProperty(s)||u&&u.hasOwnProperty(s)||(n||(n={}),n[s]="");for(s in u)u.hasOwnProperty(s)&&l[s]!==u[s]&&(n||(n={}),n[s]=u[s])}else n||(a||(a=[]),a.push(c,n)),n=u;else"dangerouslySetInnerHTML"===c?(u=u?u.__html:void 0,l=l?l.__html:void 0,null!=u&&l!==u&&(a=a||[]).push(c,u)):"children"===c?"string"!==typeof u&&"number"!==typeof u||(a=a||[]).push(c,""+u):"suppressContentEditableWarning"!==c&&"suppressHydrationWarning"!==c&&(o.hasOwnProperty(c)?(null!=u&&"onScroll"===c&&zr("scroll",e),a||l===u||(a=[])):(a=a||[]).push(c,u))}n&&(a=a||[]).push("style",n);var c=a;(t.updateQueue=c)&&(t.flags|=4)}},Ao=function(e,t,n,r){n!==r&&(t.flags|=4)};var Qo=!1,Yo=!1,Xo="function"===typeof WeakSet?WeakSet:Set,Zo=null;function el(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(r){ju(e,t,r)}else n.current=null}function tl(e,t,n){try{n()}catch(r){ju(e,t,r)}}var nl=!1;function rl(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var i=r=r.next;do{if((i.tag&e)===e){var s=i.destroy;i.destroy=void 0,void 0!==s&&tl(t,n,s)}i=i.next}while(i!==r)}}function il(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function sl(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function al(e){var t=e.alternate;null!==t&&(e.alternate=null,al(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[hi],delete t[pi],delete t[mi],delete t[gi],delete t[vi])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function ol(e){return 5===e.tag||3===e.tag||4===e.tag}function ll(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||ol(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function ul(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Zr));else if(4!==r&&null!==(e=e.child))for(ul(e,t,n),e=e.sibling;null!==e;)ul(e,t,n),e=e.sibling}function cl(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(cl(e,t,n),e=e.sibling;null!==e;)cl(e,t,n),e=e.sibling}var dl=null,hl=!1;function pl(e,t,n){for(n=n.child;null!==n;)fl(e,t,n),n=n.sibling}function fl(e,t,n){if(st&&"function"===typeof st.onCommitFiberUnmount)try{st.onCommitFiberUnmount(it,n)}catch(o){}switch(n.tag){case 5:Yo||el(n,t);case 6:var r=dl,i=hl;dl=null,pl(e,t,n),hl=i,null!==(dl=r)&&(hl?(e=dl,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):dl.removeChild(n.stateNode));break;case 18:null!==dl&&(hl?(e=dl,n=n.stateNode,8===e.nodeType?li(e.parentNode,n):1===e.nodeType&&li(e,n),Ut(e)):li(dl,n.stateNode));break;case 4:r=dl,i=hl,dl=n.stateNode.containerInfo,hl=!0,pl(e,t,n),dl=r,hl=i;break;case 0:case 11:case 14:case 15:if(!Yo&&(null!==(r=n.updateQueue)&&null!==(r=r.lastEffect))){i=r=r.next;do{var s=i,a=s.destroy;s=s.tag,void 0!==a&&(0!==(2&s)||0!==(4&s))&&tl(n,t,a),i=i.next}while(i!==r)}pl(e,t,n);break;case 1:if(!Yo&&(el(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(o){ju(n,t,o)}pl(e,t,n);break;case 21:pl(e,t,n);break;case 22:1&n.mode?(Yo=(r=Yo)||null!==n.memoizedState,pl(e,t,n),Yo=r):pl(e,t,n);break;default:pl(e,t,n)}}function ml(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Xo),t.forEach((function(t){var r=Ru.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}}function gl(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var i=n[r];try{var a=e,o=t,l=o;e:for(;null!==l;){switch(l.tag){case 5:dl=l.stateNode,hl=!1;break e;case 3:case 4:dl=l.stateNode.containerInfo,hl=!0;break e}l=l.return}if(null===dl)throw Error(s(160));fl(a,o,i),dl=null,hl=!1;var u=i.alternate;null!==u&&(u.return=null),i.return=null}catch(c){ju(i,t,c)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)vl(t,e),t=t.sibling}function vl(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(gl(t,e),yl(e),4&r){try{rl(3,e,e.return),il(3,e)}catch(g){ju(e,e.return,g)}try{rl(5,e,e.return)}catch(g){ju(e,e.return,g)}}break;case 1:gl(t,e),yl(e),512&r&&null!==n&&el(n,n.return);break;case 5:if(gl(t,e),yl(e),512&r&&null!==n&&el(n,n.return),32&e.flags){var i=e.stateNode;try{he(i,"")}catch(g){ju(e,e.return,g)}}if(4&r&&null!=(i=e.stateNode)){var a=e.memoizedProps,o=null!==n?n.memoizedProps:a,l=e.type,u=e.updateQueue;if(e.updateQueue=null,null!==u)try{"input"===l&&"radio"===a.type&&null!=a.name&&Y(i,a),be(l,o);var c=be(l,a);for(o=0;o<u.length;o+=2){var d=u[o],h=u[o+1];"style"===d?ge(i,h):"dangerouslySetInnerHTML"===d?de(i,h):"children"===d?he(i,h):b(i,d,h,c)}switch(l){case"input":X(i,a);break;case"textarea":se(i,a);break;case"select":var p=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!a.multiple;var f=a.value;null!=f?ne(i,!!a.multiple,f,!1):p!==!!a.multiple&&(null!=a.defaultValue?ne(i,!!a.multiple,a.defaultValue,!0):ne(i,!!a.multiple,a.multiple?[]:"",!1))}i[pi]=a}catch(g){ju(e,e.return,g)}}break;case 6:if(gl(t,e),yl(e),4&r){if(null===e.stateNode)throw Error(s(162));i=e.stateNode,a=e.memoizedProps;try{i.nodeValue=a}catch(g){ju(e,e.return,g)}}break;case 3:if(gl(t,e),yl(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{Ut(t.containerInfo)}catch(g){ju(e,e.return,g)}break;case 4:default:gl(t,e),yl(e);break;case 13:gl(t,e),yl(e),8192&(i=e.child).flags&&(a=null!==i.memoizedState,i.stateNode.isHidden=a,!a||null!==i.alternate&&null!==i.alternate.memoizedState||(Ul=Ye())),4&r&&ml(e);break;case 22:if(d=null!==n&&null!==n.memoizedState,1&e.mode?(Yo=(c=Yo)||d,gl(t,e),Yo=c):gl(t,e),yl(e),8192&r){if(c=null!==e.memoizedState,(e.stateNode.isHidden=c)&&!d&&0!==(1&e.mode))for(Zo=e,d=e.child;null!==d;){for(h=Zo=d;null!==Zo;){switch(f=(p=Zo).child,p.tag){case 0:case 11:case 14:case 15:rl(4,p,p.return);break;case 1:el(p,p.return);var m=p.stateNode;if("function"===typeof m.componentWillUnmount){r=p,n=p.return;try{t=r,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(g){ju(r,n,g)}}break;case 5:el(p,p.return);break;case 22:if(null!==p.memoizedState){_l(h);continue}}null!==f?(f.return=p,Zo=f):_l(h)}d=d.sibling}e:for(d=null,h=e;;){if(5===h.tag){if(null===d){d=h;try{i=h.stateNode,c?"function"===typeof(a=i.style).setProperty?a.setProperty("display","none","important"):a.display="none":(l=h.stateNode,o=void 0!==(u=h.memoizedProps.style)&&null!==u&&u.hasOwnProperty("display")?u.display:null,l.style.display=me("display",o))}catch(g){ju(e,e.return,g)}}}else if(6===h.tag){if(null===d)try{h.stateNode.nodeValue=c?"":h.memoizedProps}catch(g){ju(e,e.return,g)}}else if((22!==h.tag&&23!==h.tag||null===h.memoizedState||h===e)&&null!==h.child){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;null===h.sibling;){if(null===h.return||h.return===e)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:gl(t,e),yl(e),4&r&&ml(e);case 21:}}function yl(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(ol(n)){var r=n;break e}n=n.return}throw Error(s(160))}switch(r.tag){case 5:var i=r.stateNode;32&r.flags&&(he(i,""),r.flags&=-33),cl(e,ll(e),i);break;case 3:case 4:var a=r.stateNode.containerInfo;ul(e,ll(e),a);break;default:throw Error(s(161))}}catch(o){ju(e,e.return,o)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function bl(e,t,n){Zo=e,xl(e,t,n)}function xl(e,t,n){for(var r=0!==(1&e.mode);null!==Zo;){var i=Zo,s=i.child;if(22===i.tag&&r){var a=null!==i.memoizedState||Qo;if(!a){var o=i.alternate,l=null!==o&&null!==o.memoizedState||Yo;o=Qo;var u=Yo;if(Qo=a,(Yo=l)&&!u)for(Zo=i;null!==Zo;)l=(a=Zo).child,22===a.tag&&null!==a.memoizedState?kl(i):null!==l?(l.return=a,Zo=l):kl(i);for(;null!==s;)Zo=s,xl(s,t,n),s=s.sibling;Zo=i,Qo=o,Yo=u}wl(e)}else 0!==(8772&i.subtreeFlags)&&null!==s?(s.return=i,Zo=s):wl(e)}}function wl(e){for(;null!==Zo;){var t=Zo;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Yo||il(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!Yo)if(null===n)r.componentDidMount();else{var i=t.elementType===t.type?n.memoizedProps:gs(t.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;null!==a&&Fs(t,a,r);break;case 3:var o=t.updateQueue;if(null!==o){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}Fs(t,o,n)}break;case 5:var l=t.stateNode;if(null===n&&4&t.flags){n=l;var u=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var c=t.alternate;if(null!==c){var d=c.memoizedState;if(null!==d){var h=d.dehydrated;null!==h&&Ut(h)}}}break;default:throw Error(s(163))}Yo||512&t.flags&&sl(t)}catch(p){ju(t,t.return,p)}}if(t===e){Zo=null;break}if(null!==(n=t.sibling)){n.return=t.return,Zo=n;break}Zo=t.return}}function _l(e){for(;null!==Zo;){var t=Zo;if(t===e){Zo=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Zo=n;break}Zo=t.return}}function kl(e){for(;null!==Zo;){var t=Zo;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{il(4,t)}catch(l){ju(t,n,l)}break;case 1:var r=t.stateNode;if("function"===typeof r.componentDidMount){var i=t.return;try{r.componentDidMount()}catch(l){ju(t,i,l)}}var s=t.return;try{sl(t)}catch(l){ju(t,s,l)}break;case 5:var a=t.return;try{sl(t)}catch(l){ju(t,a,l)}}}catch(l){ju(t,t.return,l)}if(t===e){Zo=null;break}var o=t.sibling;if(null!==o){o.return=t.return,Zo=o;break}Zo=t.return}}var Sl,jl=Math.ceil,Cl=x.ReactCurrentDispatcher,El=x.ReactCurrentOwner,Tl=x.ReactCurrentBatchConfig,Rl=0,Pl=null,Ol=null,Nl=0,$l=0,Il=Si(0),Al=0,Ll=null,Dl=0,Fl=0,zl=0,Ml=null,Bl=null,Ul=0,ql=1/0,Wl=null,Hl=!1,Vl=null,Jl=null,Kl=!1,Gl=null,Ql=0,Yl=0,Xl=null,Zl=-1,eu=0;function tu(){return 0!==(6&Rl)?Ye():-1!==Zl?Zl:Zl=Ye()}function nu(e){return 0===(1&e.mode)?1:0!==(2&Rl)&&0!==Nl?Nl&-Nl:null!==ms.transition?(0===eu&&(eu=mt()),eu):0!==(e=bt)?e:e=void 0===(e=window.event)?16:Qt(e.type)}function ru(e,t,n,r){if(50<Yl)throw Yl=0,Xl=null,Error(s(185));vt(e,n,r),0!==(2&Rl)&&e===Pl||(e===Pl&&(0===(2&Rl)&&(Fl|=n),4===Al&&lu(e,Nl)),iu(e,r),1===n&&0===Rl&&0===(1&t.mode)&&(ql=Ye()+500,zi&&Ui()))}function iu(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,s=e.pendingLanes;0<s;){var a=31-at(s),o=1<<a,l=i[a];-1===l?0!==(o&n)&&0===(o&r)||(i[a]=pt(o,t)):l<=t&&(e.expiredLanes|=o),s&=~o}}(e,t);var r=ht(e,e===Pl?Nl:0);if(0===r)null!==n&&Ke(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&Ke(n),1===t)0===e.tag?function(e){zi=!0,Bi(e)}(uu.bind(null,e)):Bi(uu.bind(null,e)),ai((function(){0===(6&Rl)&&Ui()})),n=null;else{switch(xt(r)){case 1:n=Ze;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=rt}n=Pu(n,su.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function su(e,t){if(Zl=-1,eu=0,0!==(6&Rl))throw Error(s(327));var n=e.callbackNode;if(ku()&&e.callbackNode!==n)return null;var r=ht(e,e===Pl?Nl:0);if(0===r)return null;if(0!==(30&r)||0!==(r&e.expiredLanes)||t)t=vu(e,r);else{t=r;var i=Rl;Rl|=2;var a=mu();for(Pl===e&&Nl===t||(Wl=null,ql=Ye()+500,pu(e,t));;)try{bu();break}catch(l){fu(e,l)}ws(),Cl.current=a,Rl=i,null!==Ol?t=0:(Pl=null,Nl=0,t=Al)}if(0!==t){if(2===t&&(0!==(i=ft(e))&&(r=i,t=au(e,i))),1===t)throw n=Ll,pu(e,0),lu(e,r),iu(e,Ye()),n;if(6===t)lu(e,r);else{if(i=e.current.alternate,0===(30&r)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!or(s(),i))return!1}catch(o){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(i)&&(2===(t=vu(e,r))&&(0!==(a=ft(e))&&(r=a,t=au(e,a))),1===t))throw n=Ll,pu(e,0),lu(e,r),iu(e,Ye()),n;switch(e.finishedWork=i,e.finishedLanes=r,t){case 0:case 1:throw Error(s(345));case 2:case 5:_u(e,Bl,Wl);break;case 3:if(lu(e,r),(130023424&r)===r&&10<(t=Ul+500-Ye())){if(0!==ht(e,0))break;if(((i=e.suspendedLanes)&r)!==r){tu(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=ri(_u.bind(null,e,Bl,Wl),t);break}_u(e,Bl,Wl);break;case 4:if(lu(e,r),(4194240&r)===r)break;for(t=e.eventTimes,i=-1;0<r;){var o=31-at(r);a=1<<o,(o=t[o])>i&&(i=o),r&=~a}if(r=i,10<(r=(120>(r=Ye()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*jl(r/1960))-r)){e.timeoutHandle=ri(_u.bind(null,e,Bl,Wl),r);break}_u(e,Bl,Wl);break;default:throw Error(s(329))}}}return iu(e,Ye()),e.callbackNode===n?su.bind(null,e):null}function au(e,t){var n=Ml;return e.current.memoizedState.isDehydrated&&(pu(e,t).flags|=256),2!==(e=vu(e,t))&&(t=Bl,Bl=n,null!==t&&ou(t)),e}function ou(e){null===Bl?Bl=e:Bl.push.apply(Bl,e)}function lu(e,t){for(t&=~zl,t&=~Fl,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-at(t),r=1<<n;e[n]=-1,t&=~r}}function uu(e){if(0!==(6&Rl))throw Error(s(327));ku();var t=ht(e,0);if(0===(1&t))return iu(e,Ye()),null;var n=vu(e,t);if(0!==e.tag&&2===n){var r=ft(e);0!==r&&(t=r,n=au(e,r))}if(1===n)throw n=Ll,pu(e,0),lu(e,t),iu(e,Ye()),n;if(6===n)throw Error(s(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,_u(e,Bl,Wl),iu(e,Ye()),null}function cu(e,t){var n=Rl;Rl|=1;try{return e(t)}finally{0===(Rl=n)&&(ql=Ye()+500,zi&&Ui())}}function du(e){null!==Gl&&0===Gl.tag&&0===(6&Rl)&&ku();var t=Rl;Rl|=1;var n=Tl.transition,r=bt;try{if(Tl.transition=null,bt=1,e)return e()}finally{bt=r,Tl.transition=n,0===(6&(Rl=t))&&Ui()}}function hu(){$l=Il.current,ji(Il)}function pu(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,ii(n)),null!==Ol)for(n=Ol.return;null!==n;){var r=n;switch(ts(r),r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&$i();break;case 3:ia(),ji(Ri),ji(Ti),ca();break;case 5:aa(r);break;case 4:ia();break;case 13:case 19:ji(oa);break;case 10:_s(r.type._context);break;case 22:case 23:hu()}n=n.return}if(Pl=e,Ol=e=Iu(e.current,null),Nl=$l=t,Al=0,Ll=null,zl=Fl=Dl=0,Bl=Ml=null,null!==Cs){for(t=0;t<Cs.length;t++)if(null!==(r=(n=Cs[t]).interleaved)){n.interleaved=null;var i=r.next,s=n.pending;if(null!==s){var a=s.next;s.next=i,r.next=a}n.pending=r}Cs=null}return e}function fu(e,t){for(;;){var n=Ol;try{if(ws(),da.current=so,va){for(var r=fa.memoizedState;null!==r;){var i=r.queue;null!==i&&(i.pending=null),r=r.next}va=!1}if(pa=0,ga=ma=fa=null,ya=!1,ba=0,El.current=null,null===n||null===n.return){Al=1,Ll=t,Ol=null;break}e:{var a=e,o=n.return,l=n,u=t;if(t=Nl,l.flags|=32768,null!==u&&"object"===typeof u&&"function"===typeof u.then){var c=u,d=l,h=d.tag;if(0===(1&d.mode)&&(0===h||11===h||15===h)){var p=d.alternate;p?(d.updateQueue=p.updateQueue,d.memoizedState=p.memoizedState,d.lanes=p.lanes):(d.updateQueue=null,d.memoizedState=null)}var f=vo(o);if(null!==f){f.flags&=-257,yo(f,o,l,0,t),1&f.mode&&go(a,c,t),u=c;var m=(t=f).updateQueue;if(null===m){var g=new Set;g.add(u),t.updateQueue=g}else m.add(u);break e}if(0===(1&t)){go(a,c,t),gu();break e}u=Error(s(426))}else if(is&&1&l.mode){var v=vo(o);if(null!==v){0===(65536&v.flags)&&(v.flags|=256),yo(v,o,l,0,t),fs(uo(u,l));break e}}a=u=uo(u,l),4!==Al&&(Al=2),null===Ml?Ml=[a]:Ml.push(a),a=o;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t,Ls(a,fo(0,u,t));break e;case 1:l=u;var y=a.type,b=a.stateNode;if(0===(128&a.flags)&&("function"===typeof y.getDerivedStateFromError||null!==b&&"function"===typeof b.componentDidCatch&&(null===Jl||!Jl.has(b)))){a.flags|=65536,t&=-t,a.lanes|=t,Ls(a,mo(a,l,t));break e}}a=a.return}while(null!==a)}wu(n)}catch(x){t=x,Ol===n&&null!==n&&(Ol=n=n.return);continue}break}}function mu(){var e=Cl.current;return Cl.current=so,null===e?so:e}function gu(){0!==Al&&3!==Al&&2!==Al||(Al=4),null===Pl||0===(268435455&Dl)&&0===(268435455&Fl)||lu(Pl,Nl)}function vu(e,t){var n=Rl;Rl|=2;var r=mu();for(Pl===e&&Nl===t||(Wl=null,pu(e,t));;)try{yu();break}catch(i){fu(e,i)}if(ws(),Rl=n,Cl.current=r,null!==Ol)throw Error(s(261));return Pl=null,Nl=0,Al}function yu(){for(;null!==Ol;)xu(Ol)}function bu(){for(;null!==Ol&&!Ge();)xu(Ol)}function xu(e){var t=Sl(e.alternate,e,$l);e.memoizedProps=e.pendingProps,null===t?wu(e):Ol=t,El.current=null}function wu(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Ko(n,t,$l)))return void(Ol=n)}else{if(null!==(n=Go(n,t)))return n.flags&=32767,void(Ol=n);if(null===e)return Al=6,void(Ol=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Ol=t);Ol=t=e}while(null!==t);0===Al&&(Al=5)}function _u(e,t,n){var r=bt,i=Tl.transition;try{Tl.transition=null,bt=1,function(e,t,n,r){do{ku()}while(null!==Gl);if(0!==(6&Rl))throw Error(s(327));n=e.finishedWork;var i=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(s(177));e.callbackNode=null,e.callbackPriority=0;var a=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var i=31-at(n),s=1<<i;t[i]=0,r[i]=-1,e[i]=-1,n&=~s}}(e,a),e===Pl&&(Ol=Pl=null,Nl=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Kl||(Kl=!0,Pu(tt,(function(){return ku(),null}))),a=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||a){a=Tl.transition,Tl.transition=null;var o=bt;bt=1;var l=Rl;Rl|=4,El.current=null,function(e,t){if(ei=Wt,pr(e=hr())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var i=r.anchorOffset,a=r.focusNode;r=r.focusOffset;try{n.nodeType,a.nodeType}catch(w){n=null;break e}var o=0,l=-1,u=-1,c=0,d=0,h=e,p=null;t:for(;;){for(var f;h!==n||0!==i&&3!==h.nodeType||(l=o+i),h!==a||0!==r&&3!==h.nodeType||(u=o+r),3===h.nodeType&&(o+=h.nodeValue.length),null!==(f=h.firstChild);)p=h,h=f;for(;;){if(h===e)break t;if(p===n&&++c===i&&(l=o),p===a&&++d===r&&(u=o),null!==(f=h.nextSibling))break;p=(h=p).parentNode}h=f}n=-1===l||-1===u?null:{start:l,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(ti={focusedElem:e,selectionRange:n},Wt=!1,Zo=t;null!==Zo;)if(e=(t=Zo).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Zo=e;else for(;null!==Zo;){t=Zo;try{var m=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==m){var g=m.memoizedProps,v=m.memoizedState,y=t.stateNode,b=y.getSnapshotBeforeUpdate(t.elementType===t.type?g:gs(t.type,g),v);y.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var x=t.stateNode.containerInfo;1===x.nodeType?x.textContent="":9===x.nodeType&&x.documentElement&&x.removeChild(x.documentElement);break;default:throw Error(s(163))}}catch(w){ju(t,t.return,w)}if(null!==(e=t.sibling)){e.return=t.return,Zo=e;break}Zo=t.return}m=nl,nl=!1}(e,n),vl(n,e),fr(ti),Wt=!!ei,ti=ei=null,e.current=n,bl(n,e,i),Qe(),Rl=l,bt=o,Tl.transition=a}else e.current=n;if(Kl&&(Kl=!1,Gl=e,Ql=i),a=e.pendingLanes,0===a&&(Jl=null),function(e){if(st&&"function"===typeof st.onCommitFiberRoot)try{st.onCommitFiberRoot(it,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),iu(e,Ye()),null!==t)for(r=e.onRecoverableError,n=0;n<t.length;n++)i=t[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Hl)throw Hl=!1,e=Vl,Vl=null,e;0!==(1&Ql)&&0!==e.tag&&ku(),a=e.pendingLanes,0!==(1&a)?e===Xl?Yl++:(Yl=0,Xl=e):Yl=0,Ui()}(e,t,n,r)}finally{Tl.transition=i,bt=r}return null}function ku(){if(null!==Gl){var e=xt(Ql),t=Tl.transition,n=bt;try{if(Tl.transition=null,bt=16>e?16:e,null===Gl)var r=!1;else{if(e=Gl,Gl=null,Ql=0,0!==(6&Rl))throw Error(s(331));var i=Rl;for(Rl|=4,Zo=e.current;null!==Zo;){var a=Zo,o=a.child;if(0!==(16&Zo.flags)){var l=a.deletions;if(null!==l){for(var u=0;u<l.length;u++){var c=l[u];for(Zo=c;null!==Zo;){var d=Zo;switch(d.tag){case 0:case 11:case 15:rl(8,d,a)}var h=d.child;if(null!==h)h.return=d,Zo=h;else for(;null!==Zo;){var p=(d=Zo).sibling,f=d.return;if(al(d),d===c){Zo=null;break}if(null!==p){p.return=f,Zo=p;break}Zo=f}}}var m=a.alternate;if(null!==m){var g=m.child;if(null!==g){m.child=null;do{var v=g.sibling;g.sibling=null,g=v}while(null!==g)}}Zo=a}}if(0!==(2064&a.subtreeFlags)&&null!==o)o.return=a,Zo=o;else e:for(;null!==Zo;){if(0!==(2048&(a=Zo).flags))switch(a.tag){case 0:case 11:case 15:rl(9,a,a.return)}var y=a.sibling;if(null!==y){y.return=a.return,Zo=y;break e}Zo=a.return}}var b=e.current;for(Zo=b;null!==Zo;){var x=(o=Zo).child;if(0!==(2064&o.subtreeFlags)&&null!==x)x.return=o,Zo=x;else e:for(o=b;null!==Zo;){if(0!==(2048&(l=Zo).flags))try{switch(l.tag){case 0:case 11:case 15:il(9,l)}}catch(_){ju(l,l.return,_)}if(l===o){Zo=null;break e}var w=l.sibling;if(null!==w){w.return=l.return,Zo=w;break e}Zo=l.return}}if(Rl=i,Ui(),st&&"function"===typeof st.onPostCommitFiberRoot)try{st.onPostCommitFiberRoot(it,e)}catch(_){}r=!0}return r}finally{bt=n,Tl.transition=t}}return!1}function Su(e,t,n){e=Is(e,t=fo(0,t=uo(n,t),1),1),t=tu(),null!==e&&(vt(e,1,t),iu(e,t))}function ju(e,t,n){if(3===e.tag)Su(e,e,n);else for(;null!==t;){if(3===t.tag){Su(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Jl||!Jl.has(r))){t=Is(t,e=mo(t,e=uo(n,e),1),1),e=tu(),null!==t&&(vt(t,1,e),iu(t,e));break}}t=t.return}}function Cu(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=tu(),e.pingedLanes|=e.suspendedLanes&n,Pl===e&&(Nl&n)===n&&(4===Al||3===Al&&(130023424&Nl)===Nl&&500>Ye()-Ul?pu(e,0):zl|=n),iu(e,t)}function Eu(e,t){0===t&&(0===(1&e.mode)?t=1:(t=ct,0===(130023424&(ct<<=1))&&(ct=4194304)));var n=tu();null!==(e=Rs(e,t))&&(vt(e,t,n),iu(e,n))}function Tu(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Eu(e,n)}function Ru(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,i=e.memoizedState;null!==i&&(n=i.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(s(314))}null!==r&&r.delete(t),Eu(e,n)}function Pu(e,t){return Je(e,t)}function Ou(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Nu(e,t,n,r){return new Ou(e,t,n,r)}function $u(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Iu(e,t){var n=e.alternate;return null===n?((n=Nu(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Au(e,t,n,r,i,a){var o=2;if(r=e,"function"===typeof e)$u(e)&&(o=1);else if("string"===typeof e)o=5;else e:switch(e){case k:return Lu(n.children,i,a,t);case S:o=8,i|=8;break;case j:return(e=Nu(12,n,t,2|i)).elementType=j,e.lanes=a,e;case R:return(e=Nu(13,n,t,i)).elementType=R,e.lanes=a,e;case P:return(e=Nu(19,n,t,i)).elementType=P,e.lanes=a,e;case $:return Du(n,i,a,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case C:o=10;break e;case E:o=9;break e;case T:o=11;break e;case O:o=14;break e;case N:o=16,r=null;break e}throw Error(s(130,null==e?e:typeof e,""))}return(t=Nu(o,n,t,i)).elementType=e,t.type=r,t.lanes=a,t}function Lu(e,t,n,r){return(e=Nu(7,e,r,t)).lanes=n,e}function Du(e,t,n,r){return(e=Nu(22,e,r,t)).elementType=$,e.lanes=n,e.stateNode={isHidden:!1},e}function Fu(e,t,n){return(e=Nu(6,e,null,t)).lanes=n,e}function zu(e,t,n){return(t=Nu(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Mu(e,t,n,r,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gt(0),this.expirationTimes=gt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gt(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Bu(e,t,n,r,i,s,a,o,l){return e=new Mu(e,t,n,o,l),1===t?(t=1,!0===s&&(t|=8)):t=0,s=Nu(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Os(s),e}function Uu(e){if(!e)return Ei;e:{if(Ue(e=e._reactInternals)!==e||1!==e.tag)throw Error(s(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Ni(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(s(171))}if(1===e.tag){var n=e.type;if(Ni(n))return Ai(e,n,t)}return t}function qu(e,t,n,r,i,s,a,o,l){return(e=Bu(n,r,!0,e,0,s,0,o,l)).context=Uu(null),n=e.current,(s=$s(r=tu(),i=nu(n))).callback=void 0!==t&&null!==t?t:null,Is(n,s,i),e.current.lanes=i,vt(e,i,r),iu(e,r),e}function Wu(e,t,n,r){var i=t.current,s=tu(),a=nu(i);return n=Uu(n),null===t.context?t.context=n:t.pendingContext=n,(t=$s(s,a)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),null!==(e=Is(i,t,a))&&(ru(e,i,a,s),As(e,i,a)),a}function Hu(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Vu(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Ju(e,t){Vu(e,t),(e=e.alternate)&&Vu(e,t)}Sl=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Ri.current)xo=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return xo=!1,function(e,t,n){switch(t.tag){case 3:Po(t),ps();break;case 5:sa(t);break;case 1:Ni(t.type)&&Li(t);break;case 4:ra(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,i=t.memoizedProps.value;Ci(vs,r._currentValue),r._currentValue=i;break;case 13:if(null!==(r=t.memoizedState))return null!==r.dehydrated?(Ci(oa,1&oa.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Fo(e,t,n):(Ci(oa,1&oa.current),null!==(e=Ho(e,t,n))?e.sibling:null);Ci(oa,1&oa.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(128&e.flags)){if(r)return qo(e,t,n);t.flags|=128}if(null!==(i=t.memoizedState)&&(i.rendering=null,i.tail=null,i.lastEffect=null),Ci(oa,oa.current),r)break;return null;case 22:case 23:return t.lanes=0,jo(e,t,n)}return Ho(e,t,n)}(e,t,n);xo=0!==(131072&e.flags)}else xo=!1,is&&0!==(1048576&t.flags)&&Zi(t,Vi,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Wo(e,t),e=t.pendingProps;var i=Oi(t,Ti.current);Ss(t,n),i=ka(null,t,r,e,i,n);var a=Sa();return t.flags|=1,"object"===typeof i&&null!==i&&"function"===typeof i.render&&void 0===i.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Ni(r)?(a=!0,Li(t)):a=!1,t.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,Os(t),i.updater=Bs,t.stateNode=i,i._reactInternals=t,Hs(t,r,e,n),t=Ro(null,t,r,!0,a,n)):(t.tag=0,is&&a&&es(t),wo(null,t,i,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Wo(e,t),e=t.pendingProps,r=(i=r._init)(r._payload),t.type=r,i=t.tag=function(e){if("function"===typeof e)return $u(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===T)return 11;if(e===O)return 14}return 2}(r),e=gs(r,e),i){case 0:t=Eo(null,t,r,e,n);break e;case 1:t=To(null,t,r,e,n);break e;case 11:t=_o(null,t,r,e,n);break e;case 14:t=ko(null,t,r,gs(r.type,e),n);break e}throw Error(s(306,r,""))}return t;case 0:return r=t.type,i=t.pendingProps,Eo(e,t,r,i=t.elementType===r?i:gs(r,i),n);case 1:return r=t.type,i=t.pendingProps,To(e,t,r,i=t.elementType===r?i:gs(r,i),n);case 3:e:{if(Po(t),null===e)throw Error(s(387));r=t.pendingProps,i=(a=t.memoizedState).element,Ns(e,t),Ds(t,r,null,n);var o=t.memoizedState;if(r=o.element,a.isDehydrated){if(a={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=a,t.memoizedState=a,256&t.flags){t=Oo(e,t,r,n,i=uo(Error(s(423)),t));break e}if(r!==i){t=Oo(e,t,r,n,i=uo(Error(s(424)),t));break e}for(rs=ui(t.stateNode.containerInfo.firstChild),ns=t,is=!0,ss=null,n=Ys(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(ps(),r===i){t=Ho(e,t,n);break e}wo(e,t,r,n)}t=t.child}return t;case 5:return sa(t),null===e&&us(t),r=t.type,i=t.pendingProps,a=null!==e?e.memoizedProps:null,o=i.children,ni(r,i)?o=null:null!==a&&ni(r,a)&&(t.flags|=32),Co(e,t),wo(e,t,o,n),t.child;case 6:return null===e&&us(t),null;case 13:return Fo(e,t,n);case 4:return ra(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=Qs(t,null,r,n):wo(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,_o(e,t,r,i=t.elementType===r?i:gs(r,i),n);case 7:return wo(e,t,t.pendingProps,n),t.child;case 8:case 12:return wo(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,i=t.pendingProps,a=t.memoizedProps,o=i.value,Ci(vs,r._currentValue),r._currentValue=o,null!==a)if(or(a.value,o)){if(a.children===i.children&&!Ri.current){t=Ho(e,t,n);break e}}else for(null!==(a=t.child)&&(a.return=t);null!==a;){var l=a.dependencies;if(null!==l){o=a.child;for(var u=l.firstContext;null!==u;){if(u.context===r){if(1===a.tag){(u=$s(-1,n&-n)).tag=2;var c=a.updateQueue;if(null!==c){var d=(c=c.shared).pending;null===d?u.next=u:(u.next=d.next,d.next=u),c.pending=u}}a.lanes|=n,null!==(u=a.alternate)&&(u.lanes|=n),ks(a.return,n,t),l.lanes|=n;break}u=u.next}}else if(10===a.tag)o=a.type===t.type?null:a.child;else if(18===a.tag){if(null===(o=a.return))throw Error(s(341));o.lanes|=n,null!==(l=o.alternate)&&(l.lanes|=n),ks(o,n,t),o=a.sibling}else o=a.child;if(null!==o)o.return=a;else for(o=a;null!==o;){if(o===t){o=null;break}if(null!==(a=o.sibling)){a.return=o.return,o=a;break}o=o.return}a=o}wo(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=t.pendingProps.children,Ss(t,n),r=r(i=js(i)),t.flags|=1,wo(e,t,r,n),t.child;case 14:return i=gs(r=t.type,t.pendingProps),ko(e,t,r,i=gs(r.type,i),n);case 15:return So(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:gs(r,i),Wo(e,t),t.tag=1,Ni(r)?(e=!0,Li(t)):e=!1,Ss(t,n),qs(t,r,i),Hs(t,r,i,n),Ro(null,t,r,!0,e,n);case 19:return qo(e,t,n);case 22:return jo(e,t,n)}throw Error(s(156,t.tag))};var Ku="function"===typeof reportError?reportError:function(e){console.error(e)};function Gu(e){this._internalRoot=e}function Qu(e){this._internalRoot=e}function Yu(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Xu(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Zu(){}function ec(e,t,n,r,i){var s=n._reactRootContainer;if(s){var a=s;if("function"===typeof i){var o=i;i=function(){var e=Hu(a);o.call(e)}}Wu(t,a,e,i)}else a=function(e,t,n,r,i){if(i){if("function"===typeof r){var s=r;r=function(){var e=Hu(a);s.call(e)}}var a=qu(t,r,e,0,null,!1,0,"",Zu);return e._reactRootContainer=a,e[fi]=a.current,Ur(8===e.nodeType?e.parentNode:e),du(),a}for(;i=e.lastChild;)e.removeChild(i);if("function"===typeof r){var o=r;r=function(){var e=Hu(l);o.call(e)}}var l=Bu(e,0,!1,null,0,!1,0,"",Zu);return e._reactRootContainer=l,e[fi]=l.current,Ur(8===e.nodeType?e.parentNode:e),du((function(){Wu(t,l,n,r)})),l}(n,t,e,i,r);return Hu(a)}Qu.prototype.render=Gu.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(s(409));Wu(e,t,null,null)},Qu.prototype.unmount=Gu.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;du((function(){Wu(null,e,null,null)})),t[fi]=null}},Qu.prototype.unstable_scheduleHydration=function(e){if(e){var t=St();e={blockedOn:null,target:e,priority:t};for(var n=0;n<$t.length&&0!==t&&t<$t[n].priority;n++);$t.splice(n,0,e),0===n&&Dt(e)}},wt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=dt(t.pendingLanes);0!==n&&(yt(t,1|n),iu(t,Ye()),0===(6&Rl)&&(ql=Ye()+500,Ui()))}break;case 13:du((function(){var t=Rs(e,1);if(null!==t){var n=tu();ru(t,e,1,n)}})),Ju(e,1)}},_t=function(e){if(13===e.tag){var t=Rs(e,134217728);if(null!==t)ru(t,e,134217728,tu());Ju(e,134217728)}},kt=function(e){if(13===e.tag){var t=nu(e),n=Rs(e,t);if(null!==n)ru(n,e,t,tu());Ju(e,t)}},St=function(){return bt},jt=function(e,t){var n=bt;try{return bt=e,t()}finally{bt=n}},_e=function(e,t,n){switch(t){case"input":if(X(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=wi(r);if(!i)throw Error(s(90));J(r),X(r,i)}}}break;case"textarea":se(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Te=cu,Re=du;var tc={usingClientEntryPoint:!1,Events:[bi,xi,wi,Ce,Ee,cu]},nc={findFiberByHostInstance:yi,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},rc={bundleType:nc.bundleType,version:nc.version,rendererPackageName:nc.rendererPackageName,rendererConfig:nc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:x.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=He(e))?null:e.stateNode},findFiberByHostInstance:nc.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var ic=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ic.isDisabled&&ic.supportsFiber)try{it=ic.inject(rc),st=ic}catch(ce){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tc,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Yu(t))throw Error(s(200));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:_,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!Yu(e))throw Error(s(299));var n=!1,r="",i=Ku;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onRecoverableError&&(i=t.onRecoverableError)),t=Bu(e,1,!1,null,0,n,0,r,i),e[fi]=t.current,Ur(8===e.nodeType?e.parentNode:e),new Gu(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(s(188));throw e=Object.keys(e).join(","),Error(s(268,e))}return e=null===(e=He(t))?null:e.stateNode},t.flushSync=function(e){return du(e)},t.hydrate=function(e,t,n){if(!Xu(t))throw Error(s(200));return ec(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Yu(e))throw Error(s(405));var r=null!=n&&n.hydratedSources||null,i=!1,a="",o=Ku;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(i=!0),void 0!==n.identifierPrefix&&(a=n.identifierPrefix),void 0!==n.onRecoverableError&&(o=n.onRecoverableError)),t=qu(t,null,e,1,null!=n?n:null,i,0,a,o),e[fi]=t.current,Ur(e),r)for(e=0;e<r.length;e++)i=(i=(n=r[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,i]:t.mutableSourceEagerHydrationData.push(n,i);return new Qu(t)},t.render=function(e,t,n){if(!Xu(t))throw Error(s(200));return ec(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Xu(e))throw Error(s(40));return!!e._reactRootContainer&&(du((function(){ec(null,null,e,!1,(function(){e._reactRootContainer=null,e[fi]=null}))})),!0)},t.unstable_batchedUpdates=cu,t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Xu(n))throw Error(s(200));if(null==e||void 0===e._reactInternals)throw Error(s(38));return ec(e,t,n,!1,r)},t.version="18.2.0-next-9e3b772b8-20220608"},736:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(n(374));class s extends i.default{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}in(e,t){const n=Array.from(new Set(t)).map((e=>"string"===typeof e&&new RegExp("[,()]").test(e)?`"${e}"`:`${e}`)).join(",");return this.url.searchParams.append(e,`in.(${n})`),this}contains(e,t){return"string"===typeof t?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return"string"===typeof t?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return"string"===typeof t?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t){let{config:n,type:r}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i="";"plain"===r?i="pl":"phrase"===r?i="ph":"websearch"===r&&(i="w");const s=void 0===n?"":`(${n})`;return this.url.searchParams.append(e,`${i}fts${s}.${t}`),this}match(e){return Object.entries(e).forEach((e=>{let[t,n]=e;this.url.searchParams.append(t,`eq.${n}`)})),this}not(e,t,n){return this.url.searchParams.append(e,`not.${t}.${n}`),this}or(e){let{foreignTable:t,referencedTable:n=t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=n?`${n}.or`:"or";return this.url.searchParams.append(r,`(${e})`),this}filter(e,t,n){return this.url.searchParams.append(e,`${t}.${n}`),this}}t.default=s},745:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_HEADERS=void 0;const r=n(400);t.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${r.version}`}},829:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(n(736));t.default=class{constructor(e,t){let{headers:n={},schema:r,fetch:i}=t;this.url=e,this.headers=n,this.schema=r,this.fetch=i}select(e){let{head:t=!1,count:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=t?"HEAD":"GET";let s=!1;const a=(null!==e&&void 0!==e?e:"*").split("").map((e=>/\s/.test(e)&&!s?"":('"'===e&&(s=!s),e))).join("");return this.url.searchParams.set("select",a),n&&(this.headers.Prefer=`count=${n}`),new i.default({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e){let{count:t,defaultToNull:n=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=[];if(this.headers.Prefer&&r.push(this.headers.Prefer),t&&r.push(`count=${t}`),n||r.push("missing=default"),this.headers.Prefer=r.join(","),Array.isArray(e)){const t=e.reduce(((e,t)=>e.concat(Object.keys(t))),[]);if(t.length>0){const e=[...new Set(t)].map((e=>`"${e}"`));this.url.searchParams.set("columns",e.join(","))}}return new i.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e){let{onConflict:t,ignoreDuplicates:n=!1,count:r,defaultToNull:s=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const a=[`resolution=${n?"ignore":"merge"}-duplicates`];if(void 0!==t&&this.url.searchParams.set("on_conflict",t),this.headers.Prefer&&a.push(this.headers.Prefer),r&&a.push(`count=${r}`),s||a.push("missing=default"),this.headers.Prefer=a.join(","),Array.isArray(e)){const t=e.reduce(((e,t)=>e.concat(Object.keys(t))),[]);if(t.length>0){const e=[...new Set(t)].map((e=>`"${e}"`));this.url.searchParams.set("columns",e.join(","))}}return new i.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e){let{count:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=[];return this.headers.Prefer&&n.push(this.headers.Prefer),t&&n.push(`count=${t}`),this.headers.Prefer=n.join(","),new i.default({method:"PATCH",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete(){let{count:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=[];return e&&t.push(`count=${e}`),this.headers.Prefer&&t.unshift(this.headers.Prefer),this.headers.Prefer=t.join(","),new i.default({method:"DELETE",url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}},853:(e,t,n)=>{e.exports=n(234)},950:(e,t,n)=>{!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(730)},980:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.PostgrestError=t.PostgrestBuilder=t.PostgrestTransformBuilder=t.PostgrestFilterBuilder=t.PostgrestQueryBuilder=t.PostgrestClient=void 0;const i=r(n(210));t.PostgrestClient=i.default;const s=r(n(829));t.PostgrestQueryBuilder=s.default;const a=r(n(736));t.PostgrestFilterBuilder=a.default;const o=r(n(374));t.PostgrestTransformBuilder=o.default;const l=r(n(286));t.PostgrestBuilder=l.default;const u=r(n(611));t.PostgrestError=u.default,t.default={PostgrestClient:i.default,PostgrestQueryBuilder:s.default,PostgrestFilterBuilder:a.default,PostgrestTransformBuilder:o.default,PostgrestBuilder:l.default,PostgrestError:u.default}}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var s=t[r]={exports:{}};return e[r].call(s.exports,s,s.exports,n),s.exports}n.m=e,(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;n.t=function(r,i){if(1&i&&(r=this(r)),8&i)return r;if("object"===typeof r&&r){if(4&i&&r.__esModule)return r;if(16&i&&"function"===typeof r.then)return r}var s=Object.create(null);n.r(s);var a={};e=e||[null,t({}),t([]),t(t)];for(var o=2&i&&r;"object"==typeof o&&!~e.indexOf(o);o=t(o))Object.getOwnPropertyNames(o).forEach((e=>a[e]=()=>r[e]));return a.default=()=>r,n.d(s,a),s}})(),n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.f={},n.e=e=>Promise.all(Object.keys(n.f).reduce(((t,r)=>(n.f[r](e,t),t)),[])),n.u=e=>"static/js/"+e+"."+{198:"1a8570be",453:"d0297691"}[e]+".chunk.js",n.miniCssF=e=>{},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={},t="giver-ui:";n.l=(r,i,s,a)=>{if(e[r])e[r].push(i);else{var o,l;if(void 0!==s)for(var u=document.getElementsByTagName("script"),c=0;c<u.length;c++){var d=u[c];if(d.getAttribute("src")==r||d.getAttribute("data-webpack")==t+s){o=d;break}}o||(l=!0,(o=document.createElement("script")).charset="utf-8",o.timeout=120,n.nc&&o.setAttribute("nonce",n.nc),o.setAttribute("data-webpack",t+s),o.src=r),e[r]=[i];var h=(t,n)=>{o.onerror=o.onload=null,clearTimeout(p);var i=e[r];if(delete e[r],o.parentNode&&o.parentNode.removeChild(o),i&&i.forEach((e=>e(n))),t)return t(n)},p=setTimeout(h.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=h.bind(null,o.onerror),o.onload=h.bind(null,o.onload),l&&document.head.appendChild(o)}}})(),n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.p="/",(()=>{var e={792:0};n.f.j=(t,r)=>{var i=n.o(e,t)?e[t]:void 0;if(0!==i)if(i)r.push(i[2]);else{var s=new Promise(((n,r)=>i=e[t]=[n,r]));r.push(i[2]=s);var a=n.p+n.u(t),o=new Error;n.l(a,(r=>{if(n.o(e,t)&&(0!==(i=e[t])&&(e[t]=void 0),i)){var s=r&&("load"===r.type?"missing":r.type),a=r&&r.target&&r.target.src;o.message="Loading chunk "+t+" failed.\n("+s+": "+a+")",o.name="ChunkLoadError",o.type=s,o.request=a,i[1](o)}}),"chunk-"+t,t)}};var t=(t,r)=>{var i,s,a=r[0],o=r[1],l=r[2],u=0;if(a.some((t=>0!==e[t]))){for(i in o)n.o(o,i)&&(n.m[i]=o[i]);if(l)l(n)}for(t&&t(r);u<a.length;u++)s=a[u],n.o(e,s)&&e[s]&&e[s][0](),e[s]=0},r=self.webpackChunkgiver_ui=self.webpackChunkgiver_ui||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})();var r=n(43),i=n(391),s=(n(358),"popstate");function a(){return p((function(e,t){let{pathname:n,search:r,hash:i}=e.location;return c("",{pathname:n,search:r,hash:i},t.state&&t.state.usr||null,t.state&&t.state.key||"default")}),(function(e,t){return"string"===typeof t?t:d(t)}),null,arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}function o(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}function l(e,t){if(!e){"undefined"!==typeof console&&console.warn(t);try{throw new Error(t)}catch(n){}}}function u(e,t){return{usr:e.state,key:e.key,idx:t}}function c(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3?arguments[3]:void 0;return{pathname:"string"===typeof e?e:e.pathname,search:"",hash:"",..."string"===typeof t?h(t):t,state:n,key:t&&t.key||r||Math.random().toString(36).substring(2,10)}}function d(e){let{pathname:t="/",search:n="",hash:r=""}=e;return n&&"?"!==n&&(t+="?"===n.charAt(0)?n:"?"+n),r&&"#"!==r&&(t+="#"===r.charAt(0)?r:"#"+r),t}function h(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substring(n),e=e.substring(0,n));let r=e.indexOf("?");r>=0&&(t.search=e.substring(r),e=e.substring(0,r)),e&&(t.pathname=e)}return t}function p(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},{window:i=document.defaultView,v5Compat:a=!1}=r,l=i.history,h="POP",p=null,f=m();function m(){return(l.state||{idx:null}).idx}function g(){h="POP";let e=m(),t=null==e?null:e-f;f=e,p&&p({action:h,location:y.location,delta:t})}function v(e){let t="null"!==i.location.origin?i.location.origin:i.location.href,n="string"===typeof e?e:d(e);return n=n.replace(/ $/,"%20"),o(t,`No window.location.(origin|href) available to create URL for href: ${n}`),new URL(n,t)}null==f&&(f=0,l.replaceState({...l.state,idx:f},""));let y={get action(){return h},get location(){return e(i,l)},listen(e){if(p)throw new Error("A history only accepts one active listener");return i.addEventListener(s,g),p=e,()=>{i.removeEventListener(s,g),p=null}},createHref:e=>t(i,e),createURL:v,encodeLocation(e){let t=v(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(e,t){h="PUSH";let r=c(y.location,e,t);n&&n(r,e),f=m()+1;let s=u(r,f),o=y.createHref(r);try{l.pushState(s,"",o)}catch(d){if(d instanceof DOMException&&"DataCloneError"===d.name)throw d;i.location.assign(o)}a&&p&&p({action:h,location:y.location,delta:1})},replace:function(e,t){h="REPLACE";let r=c(y.location,e,t);n&&n(r,e),f=m();let i=u(r,f),s=y.createHref(r);l.replaceState(i,"",s),a&&p&&p({action:h,location:y.location,delta:0})},go:e=>l.go(e)};return y}new WeakMap;function f(e,t){return m(e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:"/",!1)}function m(e,t,n,r){let i=R(("string"===typeof t?h(t):t).pathname||"/",n);if(null==i)return null;let s=g(e);!function(e){e.sort(((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){let n=e.length===t.length&&e.slice(0,-1).every(((e,n)=>e===t[n]));return n?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map((e=>e.childrenIndex)),t.routesMeta.map((e=>e.childrenIndex)))))}(s);let a=null;for(let o=0;null==a&&o<s.length;++o){let e=T(i);a=C(s[o],e,r)}return a}function g(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",i=(e,i,s)=>{let a={relativePath:void 0===s?e.path||"":s,caseSensitive:!0===e.caseSensitive,childrenIndex:i,route:e};a.relativePath.startsWith("/")&&(o(a.relativePath.startsWith(r),`Absolute route path "${a.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),a.relativePath=a.relativePath.slice(r.length));let l=I([r,a.relativePath]),u=n.concat(a);e.children&&e.children.length>0&&(o(!0!==e.index,`Index routes must not have child routes. Please remove all child routes from route path "${l}".`),g(e.children,t,u,l)),(null!=e.path||e.index)&&t.push({path:l,score:j(l,e.index),routesMeta:u})};return e.forEach(((e,t)=>{if(""!==e.path&&e.path?.includes("?"))for(let n of v(e.path))i(e,t,n);else i(e,t)})),t}function v(e){let t=e.split("/");if(0===t.length)return[];let[n,...r]=t,i=n.endsWith("?"),s=n.replace(/\?$/,"");if(0===r.length)return i?[s,""]:[s];let a=v(r.join("/")),o=[];return o.push(...a.map((e=>""===e?s:[s,e].join("/")))),i&&o.push(...a),o.map((t=>e.startsWith("/")&&""===t?"/":t))}var y=/^:[\w-]+$/,b=3,x=2,w=1,_=10,k=-2,S=e=>"*"===e;function j(e,t){let n=e.split("/"),r=n.length;return n.some(S)&&(r+=k),t&&(r+=x),n.filter((e=>!S(e))).reduce(((e,t)=>e+(y.test(t)?b:""===t?w:_)),r)}function C(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],{routesMeta:r}=e,i={},s="/",a=[];for(let o=0;o<r.length;++o){let e=r[o],l=o===r.length-1,u="/"===s?t:t.slice(s.length)||"/",c=E({path:e.relativePath,caseSensitive:e.caseSensitive,end:l},u),d=e.route;if(!c&&l&&n&&!r[r.length-1].route.index&&(c=E({path:e.relativePath,caseSensitive:e.caseSensitive,end:!1},u)),!c)return null;Object.assign(i,c.params),a.push({params:i,pathname:I([s,c.pathname]),pathnameBase:A(I([s,c.pathnameBase])),route:d}),"/"!==c.pathnameBase&&(s=I([s,c.pathnameBase]))}return a}function E(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[n,r]=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];l("*"===e||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let r=[],i="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,((e,t,n)=>(r.push({paramName:t,isOptional:null!=n}),n?"/?([^\\/]+)?":"/([^\\/]+)")));e.endsWith("*")?(r.push({paramName:"*"}),i+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":""!==e&&"/"!==e&&(i+="(?:(?=\\/|$))");let s=new RegExp(i,t?void 0:"i");return[s,r]}(e.path,e.caseSensitive,e.end),i=t.match(n);if(!i)return null;let s=i[0],a=s.replace(/(.)\/+$/,"$1"),o=i.slice(1);return{params:r.reduce(((e,t,n)=>{let{paramName:r,isOptional:i}=t;if("*"===r){let e=o[n]||"";a=s.slice(0,s.length-e.length).replace(/(.)\/+$/,"$1")}const l=o[n];return e[r]=i&&!l?void 0:(l||"").replace(/%2F/g,"/"),e}),{}),pathname:s,pathnameBase:a,pattern:e}}function T(e){try{return e.split("/").map((e=>decodeURIComponent(e).replace(/\//g,"%2F"))).join("/")}catch(t){return l(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),e}}function R(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&"/"!==r?null:e.slice(n)||"/"}function P(e,t,n,r){return`Cannot include a '${e}' character in a manually specified \`to.${t}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function O(e){return e.filter(((e,t)=>0===t||e.route.path&&e.route.path.length>0))}function N(e){let t=O(e);return t.map(((e,n)=>n===t.length-1?e.pathname:e.pathnameBase))}function $(e,t,n){let r,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];"string"===typeof e?r=h(e):(r={...e},o(!r.pathname||!r.pathname.includes("?"),P("?","pathname","search",r)),o(!r.pathname||!r.pathname.includes("#"),P("#","pathname","hash",r)),o(!r.search||!r.search.includes("#"),P("#","search","hash",r)));let s,a=""===e||""===r.pathname,l=a?"/":r.pathname;if(null==l)s=n;else{let e=t.length-1;if(!i&&l.startsWith("..")){let t=l.split("/");for(;".."===t[0];)t.shift(),e-=1;r.pathname=t.join("/")}s=e>=0?t[e]:"/"}let u=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"/",{pathname:n,search:r="",hash:i=""}="string"===typeof e?h(e):e,s=n?n.startsWith("/")?n:function(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach((e=>{".."===e?n.length>1&&n.pop():"."!==e&&n.push(e)})),n.length>1?n.join("/"):"/"}(n,t):t;return{pathname:s,search:L(r),hash:D(i)}}(r,s),c=l&&"/"!==l&&l.endsWith("/"),d=(a||"."===l)&&n.endsWith("/");return u.pathname.endsWith("/")||!c&&!d||(u.pathname+="/"),u}var I=e=>e.join("/").replace(/\/\/+/g,"/"),A=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),L=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",D=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";function F(e){return null!=e&&"number"===typeof e.status&&"string"===typeof e.statusText&&"boolean"===typeof e.internal&&"data"in e}var z=["POST","PUT","PATCH","DELETE"],M=(new Set(z),["GET",...z]);new Set(M),Symbol("ResetLoaderData");var B=r.createContext(null);B.displayName="DataRouter";var U=r.createContext(null);U.displayName="DataRouterState";var q=r.createContext({isTransitioning:!1});q.displayName="ViewTransition";var W=r.createContext(new Map);W.displayName="Fetchers";var H=r.createContext(null);H.displayName="Await";var V=r.createContext(null);V.displayName="Navigation";var J=r.createContext(null);J.displayName="Location";var K=r.createContext({outlet:null,matches:[],isDataRoute:!1});K.displayName="Route";var G=r.createContext(null);G.displayName="RouteError";function Q(){return null!=r.useContext(J)}function Y(){return o(Q(),"useLocation() may be used only in the context of a <Router> component."),r.useContext(J).location}var X="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Z(e){r.useContext(V).static||r.useLayoutEffect(e)}function ee(){let{isDataRoute:e}=r.useContext(K);return e?function(){let{router:e}=ce("useNavigate"),t=he("useNavigate"),n=r.useRef(!1);Z((()=>{n.current=!0}));let i=r.useCallback((async function(r){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};l(n.current,X),n.current&&("number"===typeof r?e.navigate(r):await e.navigate(r,{fromRouteId:t,...i}))}),[e,t]);return i}():function(){o(Q(),"useNavigate() may be used only in the context of a <Router> component.");let e=r.useContext(B),{basename:t,navigator:n}=r.useContext(V),{matches:i}=r.useContext(K),{pathname:s}=Y(),a=JSON.stringify(N(i)),u=r.useRef(!1);Z((()=>{u.current=!0}));let c=r.useCallback((function(r){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(l(u.current,X),!u.current)return;if("number"===typeof r)return void n.go(r);let o=$(r,JSON.parse(a),s,"path"===i.relative);null==e&&"/"!==t&&(o.pathname="/"===o.pathname?t:I([t,o.pathname])),(i.replace?n.replace:n.push)(o,i.state,i)}),[t,n,a,s,e]);return c}()}r.createContext(null);function te(){let{matches:e}=r.useContext(K),t=e[e.length-1];return t?t.params:{}}function ne(e){let{relative:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{matches:n}=r.useContext(K),{pathname:i}=Y(),s=JSON.stringify(N(n));return r.useMemo((()=>$(e,JSON.parse(s),i,"path"===t)),[e,s,i,t])}function re(e,t,n,i){o(Q(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:s,static:a}=r.useContext(V),{matches:u}=r.useContext(K),c=u[u.length-1],d=c?c.params:{},p=c?c.pathname:"/",m=c?c.pathnameBase:"/",g=c&&c.route;{let e=g&&g.path||"";me(p,!g||e.endsWith("*")||e.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${p}" (under <Route path="${e}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.\n\nPlease change the parent <Route path="${e}"> to <Route path="${"/"===e?"*":`${e}/*`}">.`)}let v,y=Y();if(t){let e="string"===typeof t?h(t):t;o("/"===m||e.pathname?.startsWith(m),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${m}" but pathname "${e.pathname}" was given in the \`location\` prop.`),v=e}else v=y;let b=v.pathname||"/",x=b;if("/"!==m){let e=m.replace(/^\//,"").split("/");x="/"+b.replace(/^\//,"").split("/").slice(e.length).join("/")}let w=!a&&n&&n.matches&&n.matches.length>0?n.matches:f(e,{pathname:x});l(g||null!=w,`No routes matched location "${v.pathname}${v.search}${v.hash}" `),l(null==w||void 0!==w[w.length-1].route.element||void 0!==w[w.length-1].route.Component||void 0!==w[w.length-1].route.lazy,`Matched leaf route at location "${v.pathname}${v.search}${v.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let _=le(w&&w.map((e=>Object.assign({},e,{params:Object.assign({},d,e.params),pathname:I([m,s.encodeLocation?s.encodeLocation(e.pathname).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?m:I([m,s.encodeLocation?s.encodeLocation(e.pathnameBase).pathname:e.pathnameBase])}))),u,n,i);return t&&_?r.createElement(J.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...v},navigationType:"POP"}},_):_}function ie(){let e=pe(),t=F(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,i="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:i},a={padding:"2px 4px",backgroundColor:i},o=null;return console.error("Error handled by React Router default ErrorBoundary:",e),o=r.createElement(r.Fragment,null,r.createElement("p",null,"\ud83d\udcbf Hey developer \ud83d\udc4b"),r.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",r.createElement("code",{style:a},"ErrorBoundary")," or"," ",r.createElement("code",{style:a},"errorElement")," prop on your route.")),r.createElement(r.Fragment,null,r.createElement("h2",null,"Unexpected Application Error!"),r.createElement("h3",{style:{fontStyle:"italic"}},t),n?r.createElement("pre",{style:s},n):null,o)}var se=r.createElement(ie,null),ae=class extends r.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return void 0!==this.state.error?r.createElement(K.Provider,{value:this.props.routeContext},r.createElement(G.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function oe(e){let{routeContext:t,match:n,children:i}=e,s=r.useContext(B);return s&&s.static&&s.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=n.route.id),r.createElement(K.Provider,{value:t},i)}function le(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(null==e){if(!n)return null;if(n.errors)e=n.matches;else{if(0!==t.length||n.initialized||!(n.matches.length>0))return null;e=n.matches}}let i=e,s=n?.errors;if(null!=s){let e=i.findIndex((e=>e.route.id&&void 0!==s?.[e.route.id]));o(e>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(s).join(",")}`),i=i.slice(0,Math.min(i.length,e+1))}let a=!1,l=-1;if(n)for(let r=0;r<i.length;r++){let e=i[r];if((e.route.HydrateFallback||e.route.hydrateFallbackElement)&&(l=r),e.route.id){let{loaderData:t,errors:r}=n,s=e.route.loader&&!t.hasOwnProperty(e.route.id)&&(!r||void 0===r[e.route.id]);if(e.route.lazy||s){a=!0,i=l>=0?i.slice(0,l+1):[i[0]];break}}}return i.reduceRight(((e,o,u)=>{let c,d=!1,h=null,p=null;n&&(c=s&&o.route.id?s[o.route.id]:void 0,h=o.route.errorElement||se,a&&(l<0&&0===u?(me("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),d=!0,p=null):l===u&&(d=!0,p=o.route.hydrateFallbackElement||null)));let f=t.concat(i.slice(0,u+1)),m=()=>{let t;return t=c?h:d?p:o.route.Component?r.createElement(o.route.Component,null):o.route.element?o.route.element:e,r.createElement(oe,{match:o,routeContext:{outlet:e,matches:f,isDataRoute:null!=n},children:t})};return n&&(o.route.ErrorBoundary||o.route.errorElement||0===u)?r.createElement(ae,{location:n.location,revalidation:n.revalidation,component:h,error:c,children:m(),routeContext:{outlet:null,matches:f,isDataRoute:!0}}):m()}),null)}function ue(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function ce(e){let t=r.useContext(B);return o(t,ue(e)),t}function de(e){let t=r.useContext(U);return o(t,ue(e)),t}function he(e){let t=function(e){let t=r.useContext(K);return o(t,ue(e)),t}(e),n=t.matches[t.matches.length-1];return o(n.route.id,`${e} can only be used on routes that contain a unique "id"`),n.route.id}function pe(){let e=r.useContext(G),t=de("useRouteError"),n=he("useRouteError");return void 0!==e?e:t.errors?.[n]}var fe={};function me(e,t,n){t||fe[e]||(fe[e]=!0,l(!1,n))}r.memo((function(e){let{routes:t,future:n,state:r}=e;return re(t,void 0,r,n)}));function ge(e){let{to:t,replace:n,state:i,relative:s}=e;o(Q(),"<Navigate> may be used only in the context of a <Router> component.");let{static:a}=r.useContext(V);l(!a,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:u}=r.useContext(K),{pathname:c}=Y(),d=ee(),h=$(t,N(u),c,"path"===s),p=JSON.stringify(h);return r.useEffect((()=>{d(JSON.parse(p),{replace:n,state:i,relative:s})}),[d,p,s,n,i]),null}function ve(e){o(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function ye(e){let{basename:t="/",children:n=null,location:i,navigationType:s="POP",navigator:a,static:u=!1}=e;o(!Q(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let c=t.replace(/^\/*/,"/"),d=r.useMemo((()=>({basename:c,navigator:a,static:u,future:{}})),[c,a,u]);"string"===typeof i&&(i=h(i));let{pathname:p="/",search:f="",hash:m="",state:g=null,key:v="default"}=i,y=r.useMemo((()=>{let e=R(p,c);return null==e?null:{location:{pathname:e,search:f,hash:m,state:g,key:v},navigationType:s}}),[c,p,f,m,g,v,s]);return l(null!=y,`<Router basename="${c}"> is not able to match the URL "${p}${f}${m}" because it does not start with the basename, so the <Router> won't render anything.`),null==y?null:r.createElement(V.Provider,{value:d},r.createElement(J.Provider,{children:n,value:y}))}function be(e){let{children:t,location:n}=e;return re(xe(t),n)}r.Component;function xe(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=[];return r.Children.forEach(e,((e,i)=>{if(!r.isValidElement(e))return;let s=[...t,i];if(e.type===r.Fragment)return void n.push.apply(n,xe(e.props.children,s));o(e.type===ve,`[${"string"===typeof e.type?e.type:e.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),o(!e.props.index||!e.props.children,"An index route cannot have child routes.");let a={id:e.props.id||s.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,Component:e.props.Component,index:e.props.index,path:e.props.path,loader:e.props.loader,action:e.props.action,hydrateFallbackElement:e.props.hydrateFallbackElement,HydrateFallback:e.props.HydrateFallback,errorElement:e.props.errorElement,ErrorBoundary:e.props.ErrorBoundary,hasErrorBoundary:!0===e.props.hasErrorBoundary||null!=e.props.ErrorBoundary||null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle,lazy:e.props.lazy};e.props.children&&(a.children=xe(e.props.children,s)),n.push(a)})),n}var we="get",_e="application/x-www-form-urlencoded";function ke(e){return null!=e&&"string"===typeof e.tagName}function Se(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return new URLSearchParams("string"===typeof e||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce(((t,n)=>{let r=e[n];return t.concat(Array.isArray(r)?r.map((e=>[n,e])):[[n,r]])}),[]))}var je=null;var Ce=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Ee(e){return null==e||Ce.has(e)?e:(l(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${_e}"`),null)}function Te(e,t){let n,r,i,s,a;if(ke(o=e)&&"form"===o.tagName.toLowerCase()){let a=e.getAttribute("action");r=a?R(a,t):null,n=e.getAttribute("method")||we,i=Ee(e.getAttribute("enctype"))||_e,s=new FormData(e)}else if(function(e){return ke(e)&&"button"===e.tagName.toLowerCase()}(e)||function(e){return ke(e)&&"input"===e.tagName.toLowerCase()}(e)&&("submit"===e.type||"image"===e.type)){let a=e.form;if(null==a)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let o=e.getAttribute("formaction")||a.getAttribute("action");if(r=o?R(o,t):null,n=e.getAttribute("formmethod")||a.getAttribute("method")||we,i=Ee(e.getAttribute("formenctype"))||Ee(a.getAttribute("enctype"))||_e,s=new FormData(a,e),!function(){if(null===je)try{new FormData(document.createElement("form"),0),je=!1}catch(e){je=!0}return je}()){let{name:t,type:n,value:r}=e;if("image"===n){let e=t?`${t}.`:"";s.append(`${e}x`,"0"),s.append(`${e}y`,"0")}else t&&s.append(t,r)}}else{if(ke(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=we,r=null,i=_e,a=e}var o;return s&&"text/plain"===i&&(a=s,s=void 0),{action:r,method:n.toLowerCase(),encType:i,formData:s,body:a}}function Re(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}async function Pe(e,t){if(e.id in t)return t[e.id];try{let n=await import(e.module);return t[e.id]=n,n}catch(n){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise((()=>{}))}}function Oe(e){return null!=e&&"string"===typeof e.page}function Ne(e){return null!=e&&(null==e.href?"preload"===e.rel&&"string"===typeof e.imageSrcSet&&"string"===typeof e.imageSizes:"string"===typeof e.rel&&"string"===typeof e.href)}function $e(e,t,n,r,i,s){let a=(e,t)=>!n[t]||e.route.id!==n[t].route.id,o=(e,t)=>n[t].pathname!==e.pathname||n[t].route.path?.endsWith("*")&&n[t].params["*"]!==e.params["*"];return"assets"===s?t.filter(((e,t)=>a(e,t)||o(e,t))):"data"===s?t.filter(((t,s)=>{let l=r.routes[t.route.id];if(!l||!l.hasLoader)return!1;if(a(t,s)||o(t,s))return!0;if(t.route.shouldRevalidate){let r=t.route.shouldRevalidate({currentUrl:new URL(i.pathname+i.search+i.hash,window.origin),currentParams:n[0]?.params||{},nextUrl:new URL(e,window.origin),nextParams:t.params,defaultShouldRevalidate:!0});if("boolean"===typeof r)return r}return!0})):[]}function Ie(e,t){let{includeHydrateFallback:n}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return r=e.map((e=>{let r=t.routes[e.route.id];if(!r)return[];let i=[r.module];return r.clientActionModule&&(i=i.concat(r.clientActionModule)),r.clientLoaderModule&&(i=i.concat(r.clientLoaderModule)),n&&r.hydrateFallbackModule&&(i=i.concat(r.hydrateFallbackModule)),r.imports&&(i=i.concat(r.imports)),i})).flat(1),[...new Set(r)];var r}function Ae(e,t){let n=new Set,r=new Set(t);return e.reduce(((e,i)=>{if(t&&!Oe(i)&&"script"===i.as&&i.href&&r.has(i.href))return e;let s=JSON.stringify(function(e){let t={},n=Object.keys(e).sort();for(let r of n)t[r]=e[r];return t}(i));return n.has(s)||(n.add(s),e.push({key:s,link:i})),e}),[])}function Le(e){return{__html:e}}Symbol("SingleFetchRedirect");function De(e,t){let n="string"===typeof e?new URL(e,"undefined"===typeof window?"server://singlefetch/":window.location.origin):e;return"/"===n.pathname?n.pathname="_root.data":t&&"/"===R(n.pathname,t)?n.pathname=`${t.replace(/\/$/,"")}/_root.data`:n.pathname=`${n.pathname.replace(/\/$/,"")}.data`,n}r.Component;function Fe(e){let{error:t,isOutsideRemixApp:n}=e;console.error(t);let i,s=r.createElement("script",{dangerouslySetInnerHTML:{__html:'\n        console.log(\n          "\ud83d\udcbf Hey developer \ud83d\udc4b. You can provide a way better UX than this when your app throws errors. Check out https://remix.run/guides/errors for more information."\n        );\n      '}});if(F(t))return r.createElement(ze,{title:"Unhandled Thrown Response!"},r.createElement("h1",{style:{fontSize:"24px"}},t.status," ",t.statusText),s);if(t instanceof Error)i=t;else{let e=null==t?"Unknown Error":"object"===typeof t&&"toString"in t?t.toString():JSON.stringify(t);i=new Error(e)}return r.createElement(ze,{title:"Application Error!",isOutsideRemixApp:n},r.createElement("h1",{style:{fontSize:"24px"}},"Application Error"),r.createElement("pre",{style:{padding:"2rem",background:"hsla(10, 50%, 50%, 0.1)",color:"red",overflow:"auto"}},i.stack),s)}function ze(e){let{title:t,renderScripts:n,isOutsideRemixApp:i,children:s}=e,{routeModules:a}=We();return a.root?.Layout&&!i?s:r.createElement("html",{lang:"en"},r.createElement("head",null,r.createElement("meta",{charSet:"utf-8"}),r.createElement("meta",{name:"viewport",content:"width=device-width,initial-scale=1,viewport-fit=cover"}),r.createElement("title",null,t)),r.createElement("body",null,r.createElement("main",{style:{fontFamily:"system-ui, sans-serif",padding:"2rem"}},s,n?r.createElement(Ye,null):null)))}function Me(e){return!0===e}function Be(){let e=r.useContext(B);return Re(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function Ue(){let e=r.useContext(U);return Re(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var qe=r.createContext(void 0);function We(){let e=r.useContext(qe);return Re(e,"You must render this element inside a <HydratedRouter> element"),e}function He(e,t){return n=>{e&&e(n),n.defaultPrevented||t(n)}}function Ve(e,t,n){if(n&&!Qe)return[e[0]];if(t){let n=e.findIndex((e=>void 0!==t[e.route.id]));return e.slice(0,n+1)}return e}function Je(e){let{page:t,...n}=e,{router:i}=Be(),s=r.useMemo((()=>f(i.routes,t,i.basename)),[i.routes,t,i.basename]);return s?r.createElement(Ge,{page:t,matches:s,...n}):null}function Ke(e){let{manifest:t,routeModules:n}=We(),[i,s]=r.useState([]);return r.useEffect((()=>{let r=!1;return async function(e,t,n){return Ae((await Promise.all(e.map((async e=>{let r=t.routes[e.route.id];if(r){let e=await Pe(r,n);return e.links?e.links():[]}return[]})))).flat(1).filter(Ne).filter((e=>"stylesheet"===e.rel||"preload"===e.rel)).map((e=>"stylesheet"===e.rel?{...e,rel:"prefetch",as:"style"}:{...e,rel:"prefetch"})))}(e,t,n).then((e=>{r||s(e)})),()=>{r=!0}}),[e,t,n]),i}function Ge(e){let{page:t,matches:n,...i}=e,s=Y(),{manifest:a,routeModules:o}=We(),{basename:l}=Be(),{loaderData:u,matches:c}=Ue(),d=r.useMemo((()=>$e(t,n,c,a,s,"data")),[t,n,c,a,s]),h=r.useMemo((()=>$e(t,n,c,a,s,"assets")),[t,n,c,a,s]),p=r.useMemo((()=>{if(t===s.pathname+s.search+s.hash)return[];let e=new Set,r=!1;if(n.forEach((t=>{let n=a.routes[t.route.id];n&&n.hasLoader&&(!d.some((e=>e.route.id===t.route.id))&&t.route.id in u&&o[t.route.id]?.shouldRevalidate||n.hasClientLoader?r=!0:e.add(t.route.id))})),0===e.size)return[];let i=De(t,l);return r&&e.size>0&&i.searchParams.set("_routes",n.filter((t=>e.has(t.route.id))).map((e=>e.route.id)).join(",")),[i.pathname+i.search]}),[l,u,s,a,d,n,t,o]),f=r.useMemo((()=>Ie(h,a)),[h,a]),m=Ke(h);return r.createElement(r.Fragment,null,p.map((e=>r.createElement("link",{key:e,rel:"prefetch",as:"fetch",href:e,...i}))),f.map((e=>r.createElement("link",{key:e,rel:"modulepreload",href:e,...i}))),m.map((e=>{let{key:t,link:n}=e;return r.createElement("link",{key:t,...n})})))}qe.displayName="FrameworkContext";var Qe=!1;function Ye(e){let{manifest:t,serverHandoffString:n,isSpaMode:i,ssr:s,renderMeta:a}=We(),{router:o,static:l,staticContext:u}=Be(),{matches:c}=Ue(),d=Me(s);a&&(a.didRenderScripts=!0);let h=Ve(c,null,i);r.useEffect((()=>{Qe=!0}),[]);let p=r.useMemo((()=>{let i=u?`window.__reactRouterContext = ${n};window.__reactRouterContext.stream = new ReadableStream({start(controller){window.__reactRouterContext.streamController = controller;}}).pipeThrough(new TextEncoderStream());`:" ",s=l?`${t.hmr?.runtime?`import ${JSON.stringify(t.hmr.runtime)};`:""}${d?"":`import ${JSON.stringify(t.url)}`};\n${h.map(((e,n)=>{let r=`route${n}`,i=t.routes[e.route.id];Re(i,`Route ${e.route.id} not found in manifest`);let{clientActionModule:s,clientLoaderModule:a,hydrateFallbackModule:o,module:l}=i,u=[...s?[{module:s,varName:`${r}_clientAction`}]:[],...a?[{module:a,varName:`${r}_clientLoader`}]:[],...o?[{module:o,varName:`${r}_HydrateFallback`}]:[],{module:l,varName:`${r}_main`}];return 1===u.length?`import * as ${r} from ${JSON.stringify(l)};`:[u.map((e=>`import * as ${e.varName} from "${e.module}";`)).join("\n"),`const ${r} = {${u.map((e=>`...${e.varName}`)).join(",")}};`].join("\n")})).join("\n")}\n  ${d?`window.__reactRouterManifest = ${JSON.stringify(function(e,t){let n=new Set(t.state.matches.map((e=>e.route.id))),r=t.state.location.pathname.split("/").filter(Boolean),i=["/"];for(r.pop();r.length>0;)i.push(`/${r.join("/")}`),r.pop();i.forEach((e=>{let r=f(t.routes,e,t.basename);r&&r.forEach((e=>n.add(e.route.id)))}));let s=[...n].reduce(((t,n)=>Object.assign(t,{[n]:e.routes[n]})),{});return{...e,routes:s}}(t,o),null,2)};`:""}\n  window.__reactRouterRouteModules = {${h.map(((e,t)=>`${JSON.stringify(e.route.id)}:route${t}`)).join(",")}};\n\nimport(${JSON.stringify(t.entry.module)});`:" ";return r.createElement(r.Fragment,null,r.createElement("script",{...e,suppressHydrationWarning:!0,dangerouslySetInnerHTML:Le(i),type:void 0}),r.createElement("script",{...e,suppressHydrationWarning:!0,dangerouslySetInnerHTML:Le(s),type:"module",async:!0}))}),[]),m=Qe?[]:t.entry.imports.concat(Ie(h,t,{includeHydrateFallback:!0}));return Qe?null:r.createElement(r.Fragment,null,d?null:r.createElement("link",{rel:"modulepreload",href:t.url,crossOrigin:e.crossOrigin}),r.createElement("link",{rel:"modulepreload",href:t.entry.module,crossOrigin:e.crossOrigin}),(g=m,[...new Set(g)]).map((t=>r.createElement("link",{key:t,rel:"modulepreload",href:t,crossOrigin:e.crossOrigin}))),p);var g}function Xe(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return e=>{t.forEach((t=>{"function"===typeof t?t(e):null!=t&&(t.current=e)}))}}var Ze="undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement;try{Ze&&(window.__reactRouterVersion="7.4.0")}catch(us){}function et(e){let{basename:t,children:n,window:i}=e,s=r.useRef();null==s.current&&(s.current=a({window:i,v5Compat:!0}));let o=s.current,[l,u]=r.useState({action:o.action,location:o.location}),c=r.useCallback((e=>{r.startTransition((()=>u(e)))}),[u]);return r.useLayoutEffect((()=>o.listen(c)),[o,c]),r.createElement(ye,{basename:t,children:n,location:l.location,navigationType:l.action,navigator:o})}var tt=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,nt=r.forwardRef((function(e,t){let n,{onClick:i,discover:s="render",prefetch:a="none",relative:u,reloadDocument:c,replace:h,state:p,target:f,to:m,preventScrollReset:g,viewTransition:v,...y}=e,{basename:b}=r.useContext(V),x="string"===typeof m&&tt.test(m),w=!1;if("string"===typeof m&&x&&(n=m,Ze))try{let e=new URL(window.location.href),t=m.startsWith("//")?new URL(e.protocol+m):new URL(m),n=R(t.pathname,b);t.origin===e.origin&&null!=n?m=n+t.search+t.hash:w=!0}catch(us){l(!1,`<Link to="${m}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let _=function(e){let{relative:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};o(Q(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:i}=r.useContext(V),{hash:s,pathname:a,search:l}=ne(e,{relative:t}),u=a;return"/"!==n&&(u="/"===a?n:I([n,a])),i.createHref({pathname:u,search:l,hash:s})}(m,{relative:u}),[k,S,j]=function(e,t){let n=r.useContext(qe),[i,s]=r.useState(!1),[a,o]=r.useState(!1),{onFocus:l,onBlur:u,onMouseEnter:c,onMouseLeave:d,onTouchStart:h}=t,p=r.useRef(null);r.useEffect((()=>{if("render"===e&&o(!0),"viewport"===e){let e=new IntersectionObserver((e=>{e.forEach((e=>{o(e.isIntersecting)}))}),{threshold:.5});return p.current&&e.observe(p.current),()=>{e.disconnect()}}}),[e]),r.useEffect((()=>{if(i){let e=setTimeout((()=>{o(!0)}),100);return()=>{clearTimeout(e)}}}),[i]);let f=()=>{s(!0)},m=()=>{s(!1),o(!1)};return n?"intent"!==e?[a,p,{}]:[a,p,{onFocus:He(l,f),onBlur:He(u,m),onMouseEnter:He(c,f),onMouseLeave:He(d,m),onTouchStart:He(h,f)}]:[!1,p,{}]}(a,y),C=function(e){let{target:t,replace:n,state:i,preventScrollReset:s,relative:a,viewTransition:o}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},l=ee(),u=Y(),c=ne(e,{relative:a});return r.useCallback((r=>{if(function(e,t){return 0===e.button&&(!t||"_self"===t)&&!function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e)}(r,t)){r.preventDefault();let t=void 0!==n?n:d(u)===d(c);l(e,{replace:t,state:i,preventScrollReset:s,relative:a,viewTransition:o})}}),[u,l,c,n,i,t,e,s,a,o])}(m,{replace:h,state:p,target:f,preventScrollReset:g,relative:u,viewTransition:v});let E=r.createElement("a",{...y,...j,href:n||_,onClick:w||c?i:function(e){i&&i(e),e.defaultPrevented||C(e)},ref:Xe(t,S),target:f,"data-discover":x||"render"!==s?void 0:"true"});return k&&!x?r.createElement(r.Fragment,null,E,r.createElement(Je,{page:_})):E}));nt.displayName="Link",r.forwardRef((function(e,t){let{"aria-current":n="page",caseSensitive:i=!1,className:s="",end:a=!1,style:l,to:u,viewTransition:c,children:d,...h}=e,p=ne(u,{relative:h.relative}),f=Y(),m=r.useContext(U),{navigator:g,basename:v}=r.useContext(V),y=null!=m&&function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=r.useContext(q);o(null!=n,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:i}=st("useViewTransitionState"),s=ne(e,{relative:t.relative});if(!n.isTransitioning)return!1;let a=R(n.currentLocation.pathname,i)||n.currentLocation.pathname,l=R(n.nextLocation.pathname,i)||n.nextLocation.pathname;return null!=E(s.pathname,l)||null!=E(s.pathname,a)}(p)&&!0===c,b=g.encodeLocation?g.encodeLocation(p).pathname:p.pathname,x=f.pathname,w=m&&m.navigation&&m.navigation.location?m.navigation.location.pathname:null;i||(x=x.toLowerCase(),w=w?w.toLowerCase():null,b=b.toLowerCase()),w&&v&&(w=R(w,v)||w);const _="/"!==b&&b.endsWith("/")?b.length-1:b.length;let k,S=x===b||!a&&x.startsWith(b)&&"/"===x.charAt(_),j=null!=w&&(w===b||!a&&w.startsWith(b)&&"/"===w.charAt(b.length)),C={isActive:S,isPending:j,isTransitioning:y},T=S?n:void 0;k="function"===typeof s?s(C):[s,S?"active":null,j?"pending":null,y?"transitioning":null].filter(Boolean).join(" ");let P="function"===typeof l?l(C):l;return r.createElement(nt,{...h,"aria-current":T,className:k,ref:t,style:P,to:u,viewTransition:c},"function"===typeof d?d(C):d)})).displayName="NavLink";var rt=r.forwardRef(((e,t)=>{let{discover:n="render",fetcherKey:i,navigate:s,reloadDocument:a,replace:l,state:u,method:c=we,action:h,onSubmit:p,relative:f,preventScrollReset:m,viewTransition:g,...v}=e,y=ut(),b=function(e){let{relative:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{basename:n}=r.useContext(V),i=r.useContext(K);o(i,"useFormAction must be used inside a RouteContext");let[s]=i.matches.slice(-1),a={...ne(e||".",{relative:t})},l=Y();if(null==e){a.search=l.search;let e=new URLSearchParams(a.search),t=e.getAll("index");if(t.some((e=>""===e))){e.delete("index"),t.filter((e=>e)).forEach((t=>e.append("index",t)));let n=e.toString();a.search=n?`?${n}`:""}}e&&"."!==e||!s.route.index||(a.search=a.search?a.search.replace(/^\?/,"?index&"):"?index");"/"!==n&&(a.pathname="/"===a.pathname?n:I([n,a.pathname]));return d(a)}(h,{relative:f}),x="get"===c.toLowerCase()?"get":"post",w="string"===typeof h&&tt.test(h);return r.createElement("form",{ref:t,method:x,action:b,onSubmit:a?p:e=>{if(p&&p(e),e.defaultPrevented)return;e.preventDefault();let t=e.nativeEvent.submitter,n=t?.getAttribute("formmethod")||c;y(t||e.currentTarget,{fetcherKey:i,method:n,navigate:s,replace:l,state:u,relative:f,preventScrollReset:m,viewTransition:g})},...v,"data-discover":w||"render"!==n?void 0:"true"})}));function it(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function st(e){let t=r.useContext(B);return o(t,it(e)),t}function at(e){l("undefined"!==typeof URLSearchParams,"You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let t=r.useRef(Se(e)),n=r.useRef(!1),i=Y(),s=r.useMemo((()=>function(e,t){let n=Se(e);return t&&t.forEach(((e,r)=>{n.has(r)||t.getAll(r).forEach((e=>{n.append(r,e)}))})),n}(i.search,n.current?null:t.current)),[i.search]),a=ee(),o=r.useCallback(((e,t)=>{const r=Se("function"===typeof e?e(s):e);n.current=!0,a("?"+r,t)}),[a,s]);return[s,o]}rt.displayName="Form";var ot=0,lt=()=>`__${String(++ot)}__`;function ut(){let{router:e}=st("useSubmit"),{basename:t}=r.useContext(V),n=he("useRouteId");return r.useCallback((async function(r){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{action:s,method:a,encType:o,formData:l,body:u}=Te(r,t);if(!1===i.navigate){let t=i.fetcherKey||lt();await e.fetch(t,n,i.action||s,{preventScrollReset:i.preventScrollReset,formData:l,body:u,formMethod:i.method||a,formEncType:i.encType||o,flushSync:i.flushSync})}else await e.navigate(i.action||s,{preventScrollReset:i.preventScrollReset,formData:l,body:u,formMethod:i.method||a,formEncType:i.encType||o,replace:i.replace,state:i.state,fromRouteId:n,flushSync:i.flushSync,viewTransition:i.viewTransition})}),[e,t,n])}new TextEncoder;class ct extends Error{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"FunctionsError",n=arguments.length>2?arguments[2]:void 0;super(e),this.name=t,this.context=n}}class dt extends ct{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class ht extends ct{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class pt extends ct{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var ft;!function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"}(ft||(ft={}));var mt=function(e,t,n,r){return new(n||(n=Promise))((function(i,s){function a(e){try{l(r.next(e))}catch(us){s(us)}}function o(e){try{l(r.throw(e))}catch(us){s(us)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,o)}l((r=r.apply(e,t||[])).next())}))};class gt{constructor(e){let{headers:t={},customFetch:r,region:i=ft.Any}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.url=e,this.headers=t,this.region=i,this.fetch=(e=>{let t;return t=e||("undefined"===typeof fetch?function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return Promise.resolve().then(n.bind(n,630)).then((e=>{let{default:n}=e;return n(...t)}))}:fetch),function(){return t(...arguments)}})(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var n;return mt(this,void 0,void 0,(function*(){try{const{headers:r,method:i,body:s}=t;let a,o={},{region:l}=t;l||(l=this.region),l&&"any"!==l&&(o["x-region"]=l),s&&(r&&!Object.prototype.hasOwnProperty.call(r,"Content-Type")||!r)&&("undefined"!==typeof Blob&&s instanceof Blob||s instanceof ArrayBuffer?(o["Content-Type"]="application/octet-stream",a=s):"string"===typeof s?(o["Content-Type"]="text/plain",a=s):"undefined"!==typeof FormData&&s instanceof FormData?a=s:(o["Content-Type"]="application/json",a=JSON.stringify(s)));const u=yield this.fetch(`${this.url}/${e}`,{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},o),this.headers),r),body:a}).catch((e=>{throw new dt(e)})),c=u.headers.get("x-relay-error");if(c&&"true"===c)throw new ht(u);if(!u.ok)throw new pt(u);let d,h=(null!==(n=u.headers.get("Content-Type"))&&void 0!==n?n:"text/plain").split(";")[0].trim();return d="application/json"===h?yield u.json():"application/octet-stream"===h?yield u.blob():"text/event-stream"===h?u:"multipart/form-data"===h?yield u.formData():yield u.text(),{data:d,error:null}}catch(r){return{data:null,error:r}}}))}}var vt=n(980);const{PostgrestClient:yt,PostgrestQueryBuilder:bt,PostgrestFilterBuilder:xt,PostgrestTransformBuilder:wt,PostgrestBuilder:_t,PostgrestError:kt}=vt,St={"X-Client-Info":"realtime-js/2.11.2"};var jt,Ct,Et,Tt,Rt,Pt;!function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"}(jt||(jt={})),function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"}(Ct||(Ct={})),function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"}(Et||(Et={})),function(e){e.websocket="websocket"}(Tt||(Tt={})),function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"}(Rt||(Rt={}));class Ot{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t("string"===typeof e?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),n=new TextDecoder;return this._decodeBroadcast(e,t,n)}_decodeBroadcast(e,t,n){const r=t.getUint8(1),i=t.getUint8(2);let s=this.HEADER_LENGTH+2;const a=n.decode(e.slice(s,s+r));s+=r;const o=n.decode(e.slice(s,s+i));s+=i;return{ref:null,topic:a,event:o,payload:JSON.parse(n.decode(e.slice(s,e.byteLength)))}}}class Nt{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout((()=>{this.tries=this.tries+1,this.callback()}),this.timerCalc(this.tries+1))}}!function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"}(Pt||(Pt={}));const $t=function(e,t){var n;const r=null!==(n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).skipTypes)&&void 0!==n?n:[];return Object.keys(t).reduce(((n,i)=>(n[i]=It(i,e,t,r),n)),{})},It=(e,t,n,r)=>{const i=t.find((t=>t.name===e)),s=null===i||void 0===i?void 0:i.type,a=n[e];return s&&!r.includes(s)?At(s,a):Lt(a)},At=(e,t)=>{if("_"===e.charAt(0)){const n=e.slice(1,e.length);return Mt(t,n)}switch(e){case Pt.bool:return Dt(t);case Pt.float4:case Pt.float8:case Pt.int2:case Pt.int4:case Pt.int8:case Pt.numeric:case Pt.oid:return Ft(t);case Pt.json:case Pt.jsonb:return zt(t);case Pt.timestamp:return Bt(t);case Pt.abstime:case Pt.date:case Pt.daterange:case Pt.int4range:case Pt.int8range:case Pt.money:case Pt.reltime:case Pt.text:case Pt.time:case Pt.timestamptz:case Pt.timetz:case Pt.tsrange:case Pt.tstzrange:default:return Lt(t)}},Lt=e=>e,Dt=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},Ft=e=>{if("string"===typeof e){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},zt=e=>{if("string"===typeof e)try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},Mt=(e,t)=>{if("string"!==typeof e)return e;const n=e.length-1,r=e[n];if("{"===e[0]&&"}"===r){let r;const s=e.slice(1,n);try{r=JSON.parse("["+s+"]")}catch(i){r=s?s.split(","):[]}return r.map((e=>At(t,e)))}return e},Bt=e=>"string"===typeof e?e.replace(" ","T"):e,Ut=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")};class qt{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e4;this.channel=e,this.event=t,this.payload=n,this.timeout=r,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var n;return this._hasReceived(e)&&t(null===(n=this.receivedResp)||void 0===n?void 0:n.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);this.channel._on(this.refEvent,{},(e=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=e,this._matchReceive(e)})),this.timeoutTimer=setTimeout((()=>{this.trigger("timeout",{})}),this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive(e){let{status:t,response:n}=e;this.recHooks.filter((e=>e.status===t)).forEach((e=>e.callback(n)))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Wt,Ht,Vt,Jt;!function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"}(Wt||(Wt={}));class Kt{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(null===t||void 0===t?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},(e=>{const{onJoin:t,onLeave:n,onSync:r}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Kt.syncState(this.state,e,t,n),this.pendingDiffs.forEach((e=>{this.state=Kt.syncDiff(this.state,e,t,n)})),this.pendingDiffs=[],r()})),this.channel._on(n.diff,{},(e=>{const{onJoin:t,onLeave:n,onSync:r}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(e):(this.state=Kt.syncDiff(this.state,e,t,n),r())})),this.onJoin(((e,t,n)=>{this.channel._trigger("presence",{event:"join",key:e,currentPresences:t,newPresences:n})})),this.onLeave(((e,t,n)=>{this.channel._trigger("presence",{event:"leave",key:e,currentPresences:t,leftPresences:n})})),this.onSync((()=>{this.channel._trigger("presence",{event:"sync"})}))}static syncState(e,t,n,r){const i=this.cloneDeep(e),s=this.transformState(t),a={},o={};return this.map(i,((e,t)=>{s[e]||(o[e]=t)})),this.map(s,((e,t)=>{const n=i[e];if(n){const r=t.map((e=>e.presence_ref)),i=n.map((e=>e.presence_ref)),s=t.filter((e=>i.indexOf(e.presence_ref)<0)),l=n.filter((e=>r.indexOf(e.presence_ref)<0));s.length>0&&(a[e]=s),l.length>0&&(o[e]=l)}else a[e]=t})),this.syncDiff(i,{joins:a,leaves:o},n,r)}static syncDiff(e,t,n,r){const{joins:i,leaves:s}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return n||(n=()=>{}),r||(r=()=>{}),this.map(i,((t,r)=>{var i;const s=null!==(i=e[t])&&void 0!==i?i:[];if(e[t]=this.cloneDeep(r),s.length>0){const n=e[t].map((e=>e.presence_ref)),r=s.filter((e=>n.indexOf(e.presence_ref)<0));e[t].unshift(...r)}n(t,s,r)})),this.map(s,((t,n)=>{let i=e[t];if(!i)return;const s=n.map((e=>e.presence_ref));i=i.filter((e=>s.indexOf(e.presence_ref)<0)),e[t]=i,r(t,i,n),0===i.length&&delete e[t]})),e}static map(e,t){return Object.getOwnPropertyNames(e).map((n=>t(n,e[n])))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce(((t,n)=>{const r=e[n];return t[n]="metas"in r?r.metas.map((e=>(e.presence_ref=e.phx_ref,delete e.phx_ref,delete e.phx_ref_prev,e))):r,t}),{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}!function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"}(Ht||(Ht={})),function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"}(Vt||(Vt={})),function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"}(Jt||(Jt={}));class Gt{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{config:{}},n=arguments.length>2?arguments[2]:void 0;this.topic=e,this.params=t,this.socket=n,this.bindings={},this.state=Ct.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new qt(this,Et.join,this.params,this.timeout),this.rejoinTimer=new Nt((()=>this._rejoinUntilConnected()),this.socket.reconnectAfterMs),this.joinPush.receive("ok",(()=>{this.state=Ct.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach((e=>e.send())),this.pushBuffer=[]})),this._onClose((()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Ct.closed,this.socket._remove(this)})),this._onError((e=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,e),this.state=Ct.errored,this.rejoinTimer.scheduleTimeout())})),this.joinPush.receive("timeout",(()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Ct.errored,this.rejoinTimer.scheduleTimeout())})),this._on(Et.reply,{},((e,t)=>{this._trigger(this._replyEventName(t),e)})),this.presence=new Kt(this),this.broadcastEndpointURL=Ut(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.timeout;var n,r;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:i,presence:s,private:a}}=this.params;this._onError((t=>null===e||void 0===e?void 0:e(Jt.CHANNEL_ERROR,t))),this._onClose((()=>null===e||void 0===e?void 0:e(Jt.CLOSED)));const o={},l={broadcast:i,presence:s,postgres_changes:null!==(r=null===(n=this.bindings.postgres_changes)||void 0===n?void 0:n.map((e=>e.filter)))&&void 0!==r?r:[],private:a};this.socket.accessTokenValue&&(o.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:l},o)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",(async t=>{let{postgres_changes:n}=t;var r;if(this.socket.setAuth(),void 0!==n){const t=this.bindings.postgres_changes,i=null!==(r=null===t||void 0===t?void 0:t.length)&&void 0!==r?r:0,s=[];for(let r=0;r<i;r++){const i=t[r],{filter:{event:a,schema:o,table:l,filter:u}}=i,c=n&&n[r];if(!c||c.event!==a||c.schema!==o||c.table!==l||c.filter!==u)return this.unsubscribe(),void(null===e||void 0===e||e(Jt.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes")));s.push(Object.assign(Object.assign({},i),{id:c.id}))}return this.bindings.postgres_changes=s,void(e&&e(Jt.SUBSCRIBED))}null===e||void 0===e||e(Jt.SUBSCRIBED)})).receive("error",(t=>{null===e||void 0===e||e(Jt.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(t).join(", ")||"error")))})).receive("timeout",(()=>{null===e||void 0===e||e(Jt.TIMED_OUT)}))}return this}presenceState(){return this.presence.state}async track(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return await this.send({type:"presence",event:"untrack"},e)}on(e,t,n){return this._on(e,t,n)}async send(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var n,r;if(this._canPush()||"broadcast"!==e.type)return new Promise((n=>{var r,i,s;const a=this._push(e.type,e,t.timeout||this.timeout);"broadcast"!==e.type||(null===(s=null===(i=null===(r=this.params)||void 0===r?void 0:r.config)||void 0===i?void 0:i.broadcast)||void 0===s?void 0:s.ack)||n("ok"),a.receive("ok",(()=>n("ok"))),a.receive("error",(()=>n("error"))),a.receive("timeout",(()=>n("timed out")))}));{const{event:s,payload:a}=e,o={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:a,private:this.private}]})};try{const e=await this._fetchWithTimeout(this.broadcastEndpointURL,o,null!==(n=t.timeout)&&void 0!==n?n:this.timeout);return await(null===(r=e.body)||void 0===r?void 0:r.cancel()),e.ok?"ok":"error"}catch(i){return"AbortError"===i.name?"timed out":"error"}}}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.timeout;this.state=Ct.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Et.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise((n=>{const r=new qt(this,Et.leave,{},e);r.receive("ok",(()=>{t(),n("ok")})).receive("timeout",(()=>{t(),n("timed out")})).receive("error",(()=>{n("error")})),r.send(),this._canPush()||r.trigger("ok",{})}))}async _fetchWithTimeout(e,t,n){const r=new AbortController,i=setTimeout((()=>r.abort()),n),s=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:r.signal}));return clearTimeout(i),s}_push(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.timeout;if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let r=new qt(this,e,t,n);return this._canPush()?r.send():(r.startTimeout(),this.pushBuffer.push(r)),r}_onMessage(e,t,n){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,n){var r,i;const s=e.toLocaleLowerCase(),{close:a,error:o,leave:l,join:u}=Et;if(n&&[a,o,l,u].indexOf(s)>=0&&n!==this._joinRef())return;let c=this._onMessage(s,t,n);if(t&&!c)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(s)?null===(r=this.bindings.postgres_changes)||void 0===r||r.filter((e=>{var t,n,r;return"*"===(null===(t=e.filter)||void 0===t?void 0:t.event)||(null===(r=null===(n=e.filter)||void 0===n?void 0:n.event)||void 0===r?void 0:r.toLocaleLowerCase())===s})).map((e=>e.callback(c,n))):null===(i=this.bindings[s])||void 0===i||i.filter((e=>{var n,r,i,a,o,l;if(["broadcast","presence","postgres_changes"].includes(s)){if("id"in e){const s=e.id,a=null===(n=e.filter)||void 0===n?void 0:n.event;return s&&(null===(r=t.ids)||void 0===r?void 0:r.includes(s))&&("*"===a||(null===a||void 0===a?void 0:a.toLocaleLowerCase())===(null===(i=t.data)||void 0===i?void 0:i.type.toLocaleLowerCase()))}{const n=null===(o=null===(a=null===e||void 0===e?void 0:e.filter)||void 0===a?void 0:a.event)||void 0===o?void 0:o.toLocaleLowerCase();return"*"===n||n===(null===(l=null===t||void 0===t?void 0:t.event)||void 0===l?void 0:l.toLocaleLowerCase())}}return e.type.toLocaleLowerCase()===s})).map((e=>{if("object"===typeof c&&"ids"in c){const e=c.data,{schema:t,table:n,commit_timestamp:r,type:i,errors:s}=e,a={schema:t,table:n,commit_timestamp:r,eventType:i,new:{},old:{},errors:s};c=Object.assign(Object.assign({},a),this._getPayloadRecords(e))}e.callback(c,n)}))}_isClosed(){return this.state===Ct.closed}_isJoined(){return this.state===Ct.joined}_isJoining(){return this.state===Ct.joining}_isLeaving(){return this.state===Ct.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,n){const r=e.toLocaleLowerCase(),i={type:r,filter:t,callback:n};return this.bindings[r]?this.bindings[r].push(i):this.bindings[r]=[i],this}_off(e,t){const n=e.toLocaleLowerCase();return this.bindings[n]=this.bindings[n].filter((e=>{var r;return!((null===(r=e.type)||void 0===r?void 0:r.toLocaleLowerCase())===n&&Gt.isEqual(e.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e)if(e[n]!==t[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Et.close,{},e)}_onError(e){this._on(Et.error,{},(t=>e(t)))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.timeout;this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Ct.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return"INSERT"!==e.type&&"UPDATE"!==e.type||(t.new=$t(e.columns,e.record)),"UPDATE"!==e.type&&"DELETE"!==e.type||(t.old=$t(e.columns,e.old_record)),t}}const Qt=()=>{},Yt="undefined"!==typeof WebSocket;class Xt{constructor(e,t){var r;this.accessTokenValue=null,this.apiKey=null,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers=St,this.params={},this.timeout=1e4,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=Qt,this.conn=null,this.sendBuffer=[],this.serializer=new Ot,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=e=>{let t;return t=e||("undefined"===typeof fetch?function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return Promise.resolve().then(n.bind(n,630)).then((e=>{let{default:n}=e;return n(...t)}))}:fetch),function(){return t(...arguments)}},this.endPoint=`${e}/${Tt.websocket}`,this.httpEndpoint=Ut(e),(null===t||void 0===t?void 0:t.transport)?this.transport=t.transport:this.transport=null,(null===t||void 0===t?void 0:t.params)&&(this.params=t.params),(null===t||void 0===t?void 0:t.headers)&&(this.headers=Object.assign(Object.assign({},this.headers),t.headers)),(null===t||void 0===t?void 0:t.timeout)&&(this.timeout=t.timeout),(null===t||void 0===t?void 0:t.logger)&&(this.logger=t.logger),(null===t||void 0===t?void 0:t.heartbeatIntervalMs)&&(this.heartbeatIntervalMs=t.heartbeatIntervalMs);const i=null===(r=null===t||void 0===t?void 0:t.params)||void 0===r?void 0:r.apikey;if(i&&(this.accessTokenValue=i,this.apiKey=i),this.reconnectAfterMs=(null===t||void 0===t?void 0:t.reconnectAfterMs)?t.reconnectAfterMs:e=>[1e3,2e3,5e3,1e4][e-1]||1e4,this.encode=(null===t||void 0===t?void 0:t.encode)?t.encode:(e,t)=>t(JSON.stringify(e)),this.decode=(null===t||void 0===t?void 0:t.decode)?t.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new Nt((async()=>{this.disconnect(),this.connect()}),this.reconnectAfterMs),this.fetch=this._resolveFetch(null===t||void 0===t?void 0:t.fetch),null===t||void 0===t?void 0:t.worker){if("undefined"!==typeof window&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(null===t||void 0===t?void 0:t.worker)||!1,this.workerUrl=null===t||void 0===t?void 0:t.workerUrl}this.accessToken=(null===t||void 0===t?void 0:t.accessToken)||null}connect(){if(!this.conn)if(this.transport)this.conn=new this.transport(this.endpointURL(),void 0,{headers:this.headers});else{if(Yt)return this.conn=new WebSocket(this.endpointURL()),void this.setupConnection();this.conn=new Zt(this.endpointURL(),void 0,{close:()=>{this.conn=null}}),n.e(198).then(n.t.bind(n,198,23)).then((e=>{let{default:t}=e;this.conn=new t(this.endpointURL(),void 0,{headers:this.headers}),this.setupConnection()}))}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:"1.0.0"}))}disconnect(e,t){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,null!==t&&void 0!==t?t:""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return 0===this.channels.length&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map((e=>e.unsubscribe())));return this.disconnect(),e}log(e,t,n){this.logger(e,t,n)}connectionState(){switch(this.conn&&this.conn.readyState){case jt.connecting:return Rt.Connecting;case jt.open:return Rt.Open;case jt.closing:return Rt.Closing;default:return Rt.Closed}}isConnected(){return this.connectionState()===Rt.Open}channel(e){const t=new Gt(`realtime:${e}`,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{config:{}},this);return this.channels.push(t),t}push(e){const{topic:t,event:n,payload:r,ref:i}=e,s=()=>{this.encode(e,(e=>{var t;null===(t=this.conn)||void 0===t||t.send(e)}))};this.log("push",`${t} ${n} (${i})`,r),this.isConnected()?s():this.sendBuffer.push(s)}async setAuth(){let e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:null)||this.accessToken&&await this.accessToken()||this.accessTokenValue;if(e){let n=null;try{n=JSON.parse(atob(e.split(".")[1]))}catch(t){}if(n&&n.exp){if(!(Math.floor(Date.now()/1e3)-n.exp<0))return this.log("auth",`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${n.exp}`),Promise.reject(`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${n.exp}`)}this.accessTokenValue=e,this.channels.forEach((t=>{e&&t.updateJoinPayload({access_token:e}),t.joinedOnce&&t._isJoined()&&t._push(Et.access_token,{access_token:e})}))}}async sendHeartbeat(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef)return this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),void(null===(e=this.conn)||void 0===e||e.close(1e3,"hearbeat timeout"));this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth()}}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach((e=>e())),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find((t=>t.topic===e&&(t._isJoined()||t._isJoining())));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter((t=>t._joinRef()!==e._joinRef()))}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_onConnMessage(e){this.decode(e.data,(e=>{let{topic:t,event:n,payload:r,ref:i}=e;i&&i===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${r.status||""} ${t} ${n} ${i&&"("+i+")"||""}`,r),this.channels.filter((e=>e._isMember(t))).forEach((e=>e._trigger(n,r,i))),this.stateChangeCallbacks.message.forEach((t=>t(e)))}))}async _onConnOpen(){if(this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),this.worker){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=e=>{this.log("worker","worker error",e.message),this.workerRef.terminate()},this.workerRef.onmessage=e=>{"keepAlive"===e.data.event&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}else this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval((()=>this.sendHeartbeat()),this.heartbeatIntervalMs);this.stateChangeCallbacks.open.forEach((e=>e()))}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach((t=>t(e)))}_onConnError(e){this.log("transport",e.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach((t=>t(e)))}_triggerChanError(){this.channels.forEach((e=>e._trigger(Et.error)))}_appendParams(e,t){if(0===Object.keys(t).length)return e;const n=e.match(/\?/)?"&":"?";return`${e}${n}${new URLSearchParams(t)}`}_workerObjectUrl(e){let t;if(e)t=e;else{const e=new Blob(['\n  addEventListener("message", (e) => {\n    if (e.data.event === "start") {\n      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);\n    }\n  });'],{type:"application/javascript"});t=URL.createObjectURL(e)}return t}}class Zt{constructor(e,t,n){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=jt.connecting,this.send=()=>{},this.url=null,this.url=e,this.close=n.close}}class en extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function tn(e){return"object"===typeof e&&null!==e&&"__isStorageError"in e}class nn extends en{constructor(e,t){super(e),this.name="StorageApiError",this.status=t}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class rn extends en{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var sn=function(e,t,n,r){return new(n||(n=Promise))((function(i,s){function a(e){try{l(r.next(e))}catch(us){s(us)}}function o(e){try{l(r.throw(e))}catch(us){s(us)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,o)}l((r=r.apply(e,t||[])).next())}))};const an=e=>{let t;return t=e||("undefined"===typeof fetch?function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return Promise.resolve().then(n.bind(n,630)).then((e=>{let{default:n}=e;return n(...t)}))}:fetch),function(){return t(...arguments)}},on=e=>{if(Array.isArray(e))return e.map((e=>on(e)));if("function"===typeof e||e!==Object(e))return e;const t={};return Object.entries(e).forEach((e=>{let[n,r]=e;const i=n.replace(/([-_][a-z])/gi,(e=>e.toUpperCase().replace(/[-_]/g,"")));t[i]=on(r)})),t};var ln=function(e,t,n,r){return new(n||(n=Promise))((function(i,s){function a(e){try{l(r.next(e))}catch(us){s(us)}}function o(e){try{l(r.throw(e))}catch(us){s(us)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,o)}l((r=r.apply(e,t||[])).next())}))};const un=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),cn=(e,t,r)=>ln(void 0,void 0,void 0,(function*(){const i=yield sn(void 0,void 0,void 0,(function*(){return"undefined"===typeof Response?(yield Promise.resolve().then(n.bind(n,630))).Response:Response}));e instanceof i&&!(null===r||void 0===r?void 0:r.noResolveJson)?e.json().then((n=>{t(new nn(un(n),e.status||500))})).catch((e=>{t(new rn(un(e),e))})):t(new rn(un(e),e))}));function dn(e,t,n,r,i,s){return ln(this,void 0,void 0,(function*(){return new Promise(((a,o)=>{e(n,((e,t,n,r)=>{const i={method:e,headers:(null===t||void 0===t?void 0:t.headers)||{}};return"GET"===e?i:(i.headers=Object.assign({"Content-Type":"application/json"},null===t||void 0===t?void 0:t.headers),r&&(i.body=JSON.stringify(r)),Object.assign(Object.assign({},i),n))})(t,r,i,s)).then((e=>{if(!e.ok)throw e;return(null===r||void 0===r?void 0:r.noResolveJson)?e:e.json()})).then((e=>a(e))).catch((e=>cn(e,o,r)))}))}))}function hn(e,t,n,r){return ln(this,void 0,void 0,(function*(){return dn(e,"GET",t,n,r)}))}function pn(e,t,n,r,i){return ln(this,void 0,void 0,(function*(){return dn(e,"POST",t,r,i,n)}))}function fn(e,t,n,r,i){return ln(this,void 0,void 0,(function*(){return dn(e,"DELETE",t,r,i,n)}))}var mn=function(e,t,n,r){return new(n||(n=Promise))((function(i,s){function a(e){try{l(r.next(e))}catch(us){s(us)}}function o(e){try{l(r.throw(e))}catch(us){s(us)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,o)}l((r=r.apply(e,t||[])).next())}))};const gn={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},vn={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class yn{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;this.url=e,this.headers=t,this.bucketId=n,this.fetch=an(r)}uploadOrUpdate(e,t,n,r){return mn(this,void 0,void 0,(function*(){try{let i;const s=Object.assign(Object.assign({},vn),r);let a=Object.assign(Object.assign({},this.headers),"POST"===e&&{"x-upsert":String(s.upsert)});const o=s.metadata;"undefined"!==typeof Blob&&n instanceof Blob?(i=new FormData,i.append("cacheControl",s.cacheControl),o&&i.append("metadata",this.encodeMetadata(o)),i.append("",n)):"undefined"!==typeof FormData&&n instanceof FormData?(i=n,i.append("cacheControl",s.cacheControl),o&&i.append("metadata",this.encodeMetadata(o))):(i=n,a["cache-control"]=`max-age=${s.cacheControl}`,a["content-type"]=s.contentType,o&&(a["x-metadata"]=this.toBase64(this.encodeMetadata(o)))),(null===r||void 0===r?void 0:r.headers)&&(a=Object.assign(Object.assign({},a),r.headers));const l=this._removeEmptyFolders(t),u=this._getFinalPath(l),c=yield this.fetch(`${this.url}/object/${u}`,Object.assign({method:e,body:i,headers:a},(null===s||void 0===s?void 0:s.duplex)?{duplex:s.duplex}:{})),d=yield c.json();if(c.ok)return{data:{path:l,id:d.Id,fullPath:d.Key},error:null};return{data:null,error:d}}catch(i){if(tn(i))return{data:null,error:i};throw i}}))}upload(e,t,n){return mn(this,void 0,void 0,(function*(){return this.uploadOrUpdate("POST",e,t,n)}))}uploadToSignedUrl(e,t,n,r){return mn(this,void 0,void 0,(function*(){const i=this._removeEmptyFolders(e),s=this._getFinalPath(i),a=new URL(this.url+`/object/upload/sign/${s}`);a.searchParams.set("token",t);try{let e;const t=Object.assign({upsert:vn.upsert},r),s=Object.assign(Object.assign({},this.headers),{"x-upsert":String(t.upsert)});"undefined"!==typeof Blob&&n instanceof Blob?(e=new FormData,e.append("cacheControl",t.cacheControl),e.append("",n)):"undefined"!==typeof FormData&&n instanceof FormData?(e=n,e.append("cacheControl",t.cacheControl)):(e=n,s["cache-control"]=`max-age=${t.cacheControl}`,s["content-type"]=t.contentType);const o=yield this.fetch(a.toString(),{method:"PUT",body:e,headers:s}),l=yield o.json();if(o.ok)return{data:{path:i,fullPath:l.Key},error:null};return{data:null,error:l}}catch(o){if(tn(o))return{data:null,error:o};throw o}}))}createSignedUploadUrl(e,t){return mn(this,void 0,void 0,(function*(){try{let n=this._getFinalPath(e);const r=Object.assign({},this.headers);(null===t||void 0===t?void 0:t.upsert)&&(r["x-upsert"]="true");const i=yield pn(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:r}),s=new URL(this.url+i.url),a=s.searchParams.get("token");if(!a)throw new en("No token returned by API");return{data:{signedUrl:s.toString(),path:e,token:a},error:null}}catch(n){if(tn(n))return{data:null,error:n};throw n}}))}update(e,t,n){return mn(this,void 0,void 0,(function*(){return this.uploadOrUpdate("PUT",e,t,n)}))}move(e,t,n){return mn(this,void 0,void 0,(function*(){try{return{data:yield pn(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null===n||void 0===n?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(r){if(tn(r))return{data:null,error:r};throw r}}))}copy(e,t,n){return mn(this,void 0,void 0,(function*(){try{return{data:{path:(yield pn(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null===n||void 0===n?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(r){if(tn(r))return{data:null,error:r};throw r}}))}createSignedUrl(e,t,n){return mn(this,void 0,void 0,(function*(){try{let r=this._getFinalPath(e),i=yield pn(this.fetch,`${this.url}/object/sign/${r}`,Object.assign({expiresIn:t},(null===n||void 0===n?void 0:n.transform)?{transform:n.transform}:{}),{headers:this.headers});const s=(null===n||void 0===n?void 0:n.download)?`&download=${!0===n.download?"":n.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${s}`)},{data:i,error:null}}catch(r){if(tn(r))return{data:null,error:r};throw r}}))}createSignedUrls(e,t,n){return mn(this,void 0,void 0,(function*(){try{const r=yield pn(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),i=(null===n||void 0===n?void 0:n.download)?`&download=${!0===n.download?"":n.download}`:"";return{data:r.map((e=>Object.assign(Object.assign({},e),{signedUrl:e.signedURL?encodeURI(`${this.url}${e.signedURL}${i}`):null}))),error:null}}catch(r){if(tn(r))return{data:null,error:r};throw r}}))}download(e,t){return mn(this,void 0,void 0,(function*(){const n="undefined"!==typeof(null===t||void 0===t?void 0:t.transform)?"render/image/authenticated":"object",r=this.transformOptsToQueryString((null===t||void 0===t?void 0:t.transform)||{}),i=r?`?${r}`:"";try{const t=this._getFinalPath(e),r=yield hn(this.fetch,`${this.url}/${n}/${t}${i}`,{headers:this.headers,noResolveJson:!0});return{data:yield r.blob(),error:null}}catch(s){if(tn(s))return{data:null,error:s};throw s}}))}info(e){return mn(this,void 0,void 0,(function*(){const t=this._getFinalPath(e);try{const e=yield hn(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:on(e),error:null}}catch(n){if(tn(n))return{data:null,error:n};throw n}}))}exists(e){return mn(this,void 0,void 0,(function*(){const t=this._getFinalPath(e);try{return yield function(e,t,n,r){return ln(this,void 0,void 0,(function*(){return dn(e,"HEAD",t,Object.assign(Object.assign({},n),{noResolveJson:!0}),r)}))}(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(tn(n)&&n instanceof rn){const e=n.originalError;if([400,404].includes(null===e||void 0===e?void 0:e.status))return{data:!1,error:n}}throw n}}))}getPublicUrl(e,t){const n=this._getFinalPath(e),r=[],i=(null===t||void 0===t?void 0:t.download)?`download=${!0===t.download?"":t.download}`:"";""!==i&&r.push(i);const s="undefined"!==typeof(null===t||void 0===t?void 0:t.transform)?"render/image":"object",a=this.transformOptsToQueryString((null===t||void 0===t?void 0:t.transform)||{});""!==a&&r.push(a);let o=r.join("&");return""!==o&&(o=`?${o}`),{data:{publicUrl:encodeURI(`${this.url}/${s}/public/${n}${o}`)}}}remove(e){return mn(this,void 0,void 0,(function*(){try{return{data:yield fn(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(tn(t))return{data:null,error:t};throw t}}))}list(e,t,n){return mn(this,void 0,void 0,(function*(){try{const r=Object.assign(Object.assign(Object.assign({},gn),t),{prefix:e||""});return{data:yield pn(this.fetch,`${this.url}/object/list/${this.bucketId}`,r,{headers:this.headers},n),error:null}}catch(r){if(tn(r))return{data:null,error:r};throw r}}))}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return"undefined"!==typeof Buffer?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const bn={"X-Client-Info":"storage-js/2.7.1"};var xn=function(e,t,n,r){return new(n||(n=Promise))((function(i,s){function a(e){try{l(r.next(e))}catch(us){s(us)}}function o(e){try{l(r.throw(e))}catch(us){s(us)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,o)}l((r=r.apply(e,t||[])).next())}))};class wn{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;this.url=e,this.headers=Object.assign(Object.assign({},bn),t),this.fetch=an(n)}listBuckets(){return xn(this,void 0,void 0,(function*(){try{return{data:yield hn(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(tn(e))return{data:null,error:e};throw e}}))}getBucket(e){return xn(this,void 0,void 0,(function*(){try{return{data:yield hn(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(tn(t))return{data:null,error:t};throw t}}))}createBucket(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{public:!1};return xn(this,void 0,void 0,(function*(){try{return{data:yield pn(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(tn(n))return{data:null,error:n};throw n}}))}updateBucket(e,t){return xn(this,void 0,void 0,(function*(){try{const n=yield function(e,t,n,r,i){return ln(this,void 0,void 0,(function*(){return dn(e,"PUT",t,r,i,n)}))}(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers});return{data:n,error:null}}catch(n){if(tn(n))return{data:null,error:n};throw n}}))}emptyBucket(e){return xn(this,void 0,void 0,(function*(){try{return{data:yield pn(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(tn(t))return{data:null,error:t};throw t}}))}deleteBucket(e){return xn(this,void 0,void 0,(function*(){try{return{data:yield fn(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(tn(t))return{data:null,error:t};throw t}}))}}class _n extends wn{constructor(e){super(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},arguments.length>2?arguments[2]:void 0)}from(e){return new yn(this.url,this.headers,e,this.fetch)}}let kn="";kn="undefined"!==typeof Deno?"deno":"undefined"!==typeof document?"web":"undefined"!==typeof navigator&&"ReactNative"===navigator.product?"react-native":"node";const Sn={headers:{"X-Client-Info":`supabase-js-${kn}/2.49.1`}},jn={schema:"public"},Cn={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},En={};var Tn=n(630),Rn=function(e,t,n,r){return new(n||(n=Promise))((function(i,s){function a(e){try{l(r.next(e))}catch(us){s(us)}}function o(e){try{l(r.throw(e))}catch(us){s(us)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,o)}l((r=r.apply(e,t||[])).next())}))};const Pn=e=>{let t;return t=e||("undefined"===typeof fetch?Tn.default:fetch),function(){return t(...arguments)}},On=(e,t,n)=>{const r=Pn(n),i="undefined"===typeof Headers?Tn.Headers:Headers;return(n,s)=>Rn(void 0,void 0,void 0,(function*(){var a;const o=null!==(a=yield t())&&void 0!==a?a:e;let l=new i(null===s||void 0===s?void 0:s.headers);return l.has("apikey")||l.set("apikey",e),l.has("Authorization")||l.set("Authorization",`Bearer ${o}`),r(n,Object.assign(Object.assign({},s),{headers:l}))}))};var Nn=function(e,t,n,r){return new(n||(n=Promise))((function(i,s){function a(e){try{l(r.next(e))}catch(us){s(us)}}function o(e){try{l(r.throw(e))}catch(us){s(us)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,o)}l((r=r.apply(e,t||[])).next())}))};const $n="2.68.0",In=3e4,An=9e4,Ln={"X-Client-Info":`gotrue-js/${$n}`},Dn="X-Supabase-Api-Version",Fn={timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"};const zn=()=>"undefined"!==typeof window&&"undefined"!==typeof document,Mn={tested:!1,writable:!1},Bn=()=>{if(!zn())return!1;try{if("object"!==typeof globalThis.localStorage)return!1}catch(us){return!1}if(Mn.tested)return Mn.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Mn.tested=!0,Mn.writable=!0}catch(us){Mn.tested=!0,Mn.writable=!1}return Mn.writable};const Un=e=>{let t;return t=e||("undefined"===typeof fetch?function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return Promise.resolve().then(n.bind(n,630)).then((e=>{let{default:n}=e;return n(...t)}))}:fetch),function(){return t(...arguments)}},qn=async(e,t,n)=>{await e.setItem(t,JSON.stringify(n))},Wn=async(e,t)=>{const n=await e.getItem(t);if(!n)return null;try{return JSON.parse(n)}catch(r){return n}},Hn=async(e,t)=>{await e.removeItem(t)};class Vn{constructor(){this.promise=new Vn.promiseConstructor(((e,t)=>{this.resolve=e,this.reject=t}))}}function Jn(e){const t=e.split(".");if(3!==t.length)throw new Error("JWT is not valid: not a JWT structure");if(!/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}=?$|[a-z0-9_-]{2}(==)?$)$/i.test(t[1]))throw new Error("JWT is not valid: payload is not in base64url format");const n=t[1];return JSON.parse(function(e){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let n,r,i,s,a,o,l,u="",c=0;for(e=e.replace("-","+").replace("_","/");c<e.length;)s=t.indexOf(e.charAt(c++)),a=t.indexOf(e.charAt(c++)),o=t.indexOf(e.charAt(c++)),l=t.indexOf(e.charAt(c++)),n=s<<2|a>>4,r=(15&a)<<4|o>>2,i=(3&o)<<6|l,u+=String.fromCharCode(n),64!=o&&0!=r&&(u+=String.fromCharCode(r)),64!=l&&0!=i&&(u+=String.fromCharCode(i));return u}(n))}function Kn(e){return("0"+e.toString(16)).substr(-2)}async function Gn(e){if(!("undefined"!==typeof crypto&&"undefined"!==typeof crypto.subtle&&"undefined"!==typeof TextEncoder))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const t=await async function(e){const t=(new TextEncoder).encode(e),n=await crypto.subtle.digest("SHA-256",t),r=new Uint8Array(n);return Array.from(r).map((e=>String.fromCharCode(e))).join("")}(e);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Qn(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=function(){const e=new Uint32Array(56);if("undefined"===typeof crypto){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",t=e.length;let n="";for(let r=0;r<56;r++)n+=e.charAt(Math.floor(Math.random()*t));return n}return crypto.getRandomValues(e),Array.from(e,Kn).join("")}();let i=r;n&&(i+="/PASSWORD_RECOVERY"),await qn(e,`${t}-code-verifier`,i);const s=await Gn(r);return[s,r===s?"plain":"s256"]}Vn.promiseConstructor=Promise;const Yn=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;class Xn extends Error{constructor(e,t,n){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=n}}function Zn(e){return"object"===typeof e&&null!==e&&"__isAuthError"in e}class er extends Xn{constructor(e,t,n){super(e,t,n),this.name="AuthApiError",this.status=t,this.code=n}}class tr extends Xn{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class nr extends Xn{constructor(e,t,n,r){super(e,n,r),this.name=t,this.status=n}}class rr extends nr{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}class ir extends nr{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class sr extends nr{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class ar extends nr{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class or extends nr{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class lr extends nr{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function ur(e){return Zn(e)&&"AuthRetryableFetchError"===e.name}class cr extends nr{constructor(e,t,n){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=n}}var dr=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};const hr=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),pr=[502,503,504];async function fr(e){var t,n;if(!("object"===typeof(n=e)&&null!==n&&"status"in n&&"ok"in n&&"json"in n&&"function"===typeof n.json))throw new lr(hr(e),0);if(pr.includes(e.status))throw new lr(hr(e),e.status);let r,i;try{r=await e.json()}catch(us){throw new tr(hr(us),us)}const s=function(e){const t=e.headers.get(Dn);if(!t)return null;if(!t.match(Yn))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch(us){return null}}(e);if(s&&s.getTime()>=Fn.timestamp&&"object"===typeof r&&r&&"string"===typeof r.code?i=r.code:"object"===typeof r&&r&&"string"===typeof r.error_code&&(i=r.error_code),i){if("weak_password"===i)throw new cr(hr(r),e.status,(null===(t=r.weak_password)||void 0===t?void 0:t.reasons)||[]);if("session_not_found"===i)throw new rr}else if("object"===typeof r&&r&&"object"===typeof r.weak_password&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce(((e,t)=>e&&"string"===typeof t),!0))throw new cr(hr(r),e.status,r.weak_password.reasons);throw new er(hr(r),e.status||500,i)}async function mr(e,t,n,r){var i;const s=Object.assign({},null===r||void 0===r?void 0:r.headers);s[Dn]||(s[Dn]=Fn.name),(null===r||void 0===r?void 0:r.jwt)&&(s.Authorization=`Bearer ${r.jwt}`);const a=null!==(i=null===r||void 0===r?void 0:r.query)&&void 0!==i?i:{};(null===r||void 0===r?void 0:r.redirectTo)&&(a.redirect_to=r.redirectTo);const o=Object.keys(a).length?"?"+new URLSearchParams(a).toString():"",l=await async function(e,t,n,r,i,s){const a=((e,t,n,r)=>{const i={method:e,headers:(null===t||void 0===t?void 0:t.headers)||{}};return"GET"===e?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},null===t||void 0===t?void 0:t.headers),i.body=JSON.stringify(r),Object.assign(Object.assign({},i),n))})(t,r,i,s);let o;try{o=await e(n,Object.assign({},a))}catch(us){throw console.error(us),new lr(hr(us),0)}o.ok||await fr(o);if(null===r||void 0===r?void 0:r.noResolveJson)return o;try{return await o.json()}catch(us){await fr(us)}}(e,t,n+o,{headers:s,noResolveJson:null===r||void 0===r?void 0:r.noResolveJson},{},null===r||void 0===r?void 0:r.body);return(null===r||void 0===r?void 0:r.xform)?null===r||void 0===r?void 0:r.xform(l):{data:Object.assign({},l),error:null}}function gr(e){var t;let n=null;var r;(function(e){return e.access_token&&e.refresh_token&&e.expires_in})(e)&&(n=Object.assign({},e),e.expires_at||(n.expires_at=(r=e.expires_in,Math.round(Date.now()/1e3)+r)));return{data:{session:n,user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function vr(e){const t=gr(e);return!t.error&&e.weak_password&&"object"===typeof e.weak_password&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&"string"===typeof e.weak_password.message&&e.weak_password.reasons.reduce(((e,t)=>e&&"string"===typeof t),!0)&&(t.data.weak_password=e.weak_password),t}function yr(e){var t;return{data:{user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function br(e){return{data:e,error:null}}function xr(e){const{action_link:t,email_otp:n,hashed_token:r,redirect_to:i,verification_type:s}=e,a=dr(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]);return{data:{properties:{action_link:t,email_otp:n,hashed_token:r,redirect_to:i,verification_type:s},user:Object.assign({},a)},error:null}}function wr(e){return e}var _r=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};class kr{constructor(e){let{url:t="",headers:n={},fetch:r}=e;this.url=t,this.headers=n,this.fetch=Un(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"global";try{return await mr(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(n){if(Zn(n))return{data:null,error:n};throw n}}async inviteUserByEmail(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{return await mr(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:yr})}catch(n){if(Zn(n))return{data:{user:null},error:n};throw n}}async generateLink(e){try{const{options:t}=e,n=_r(e,["options"]),r=Object.assign(Object.assign({},n),t);return"newEmail"in n&&(r.new_email=null===n||void 0===n?void 0:n.newEmail,delete r.newEmail),await mr(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:r,headers:this.headers,xform:xr,redirectTo:null===t||void 0===t?void 0:t.redirectTo})}catch(t){if(Zn(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await mr(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:yr})}catch(t){if(Zn(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,n,r,i,s,a,o;try{const l={nextPage:null,lastPage:0,total:0},u=await mr(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:null!==(n=null===(t=null===e||void 0===e?void 0:e.page)||void 0===t?void 0:t.toString())&&void 0!==n?n:"",per_page:null!==(i=null===(r=null===e||void 0===e?void 0:e.perPage)||void 0===r?void 0:r.toString())&&void 0!==i?i:""},xform:wr});if(u.error)throw u.error;const c=await u.json(),d=null!==(s=u.headers.get("x-total-count"))&&void 0!==s?s:0,h=null!==(o=null===(a=u.headers.get("link"))||void 0===a?void 0:a.split(","))&&void 0!==o?o:[];return h.length>0&&(h.forEach((e=>{const t=parseInt(e.split(";")[0].split("=")[1].substring(0,1)),n=JSON.parse(e.split(";")[1].split("=")[1]);l[`${n}Page`]=t})),l.total=parseInt(d)),{data:Object.assign(Object.assign({},c),l),error:null}}catch(l){if(Zn(l))return{data:{users:[]},error:l};throw l}}async getUserById(e){try{return await mr(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:yr})}catch(t){if(Zn(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){try{return await mr(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:yr})}catch(n){if(Zn(n))return{data:{user:null},error:n};throw n}}async deleteUser(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];try{return await mr(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:yr})}catch(n){if(Zn(n))return{data:{user:null},error:n};throw n}}async _listFactors(e){try{const{data:t,error:n}=await mr(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:e=>({data:{factors:e},error:null})});return{data:t,error:n}}catch(t){if(Zn(t))return{data:null,error:t};throw t}}async _deleteFactor(e){try{return{data:await mr(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(Zn(t))return{data:null,error:t};throw t}}}const Sr={getItem:e=>Bn()?globalThis.localStorage.getItem(e):null,setItem:(e,t)=>{Bn()&&globalThis.localStorage.setItem(e,t)},removeItem:e=>{Bn()&&globalThis.localStorage.removeItem(e)}};function jr(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{getItem:t=>e[t]||null,setItem:(t,n)=>{e[t]=n},removeItem:t=>{delete e[t]}}}const Cr=!!(globalThis&&Bn()&&globalThis.localStorage&&"true"===globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug"));class Er extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class Tr extends Er{}async function Rr(e,t,n){Cr&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const r=new globalThis.AbortController;return t>0&&setTimeout((()=>{r.abort(),Cr&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)}),t),await Promise.resolve().then((()=>globalThis.navigator.locks.request(e,0===t?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},(async r=>{if(!r){if(0===t)throw Cr&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new Tr(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(Cr)try{const e=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(e,null,"  "))}catch(us){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",us)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}Cr&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,r.name);try{return await n()}finally{Cr&&console.log("@supabase/gotrue-js: navigatorLock: released",e,r.name)}}))))}!function(){if("object"!==typeof globalThis)try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch(us){"undefined"!==typeof self&&(self.globalThis=self)}}();const Pr={url:"http://localhost:9999",storageKey:"supabase.auth.token",autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Ln,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function Or(e,t,n){return await n()}class Nr{constructor(e){var t,n;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Nr.nextInstanceID,Nr.nextInstanceID+=1,this.instanceID>0&&zn()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const r=Object.assign(Object.assign({},Pr),e);if(this.logDebugMessages=!!r.debug,"function"===typeof r.debug&&(this.logger=r.debug),this.persistSession=r.persistSession,this.storageKey=r.storageKey,this.autoRefreshToken=r.autoRefreshToken,this.admin=new kr({url:r.url,headers:r.headers,fetch:r.fetch}),this.url=r.url,this.headers=r.headers,this.fetch=Un(r.fetch),this.lock=r.lock||Or,this.detectSessionInUrl=r.detectSessionInUrl,this.flowType=r.flowType,this.hasCustomAuthorizationHeader=r.hasCustomAuthorizationHeader,r.lock?this.lock=r.lock:zn()&&(null===(t=null===globalThis||void 0===globalThis?void 0:globalThis.navigator)||void 0===t?void 0:t.locks)?this.lock=Rr:this.lock=Or,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?r.storage?this.storage=r.storage:Bn()?this.storage=Sr:(this.memoryStorage={},this.storage=jr(this.memoryStorage)):(this.memoryStorage={},this.storage=jr(this.memoryStorage)),zn()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(us){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",us)}null===(n=this.broadcastChannel)||void 0===n||n.addEventListener("message",(async e=>{this._debug("received broadcast notification from other tab or client",e),await this._notifyAllSubscribers(e.data.event,e.data.session,!1)}))}this.initialize()}_debug(){if(this.logDebugMessages){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.logger(`GoTrueClient@${this.instanceID} (${$n}) ${(new Date).toISOString()}`,...t)}return this}async initialize(){return this.initializePromise||(this.initializePromise=(async()=>await this._acquireLock(-1,(async()=>await this._initialize())))()),await this.initializePromise}async _initialize(){var e;try{const t=function(e){const t={},n=new URL(e);if(n.hash&&"#"===n.hash[0])try{new URLSearchParams(n.hash.substring(1)).forEach(((e,n)=>{t[n]=e}))}catch(us){}return n.searchParams.forEach(((e,n)=>{t[n]=e})),t}(window.location.href);let n="none";if(this._isImplicitGrantCallback(t)?n="implicit":await this._isPKCECallback(t)&&(n="pkce"),zn()&&this.detectSessionInUrl&&"none"!==n){const{data:r,error:i}=await this._getSessionFromURL(t,n);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),function(e){return Zn(e)&&"AuthImplicitGrantRedirectError"===e.name}(i)){const t=null===(e=i.details)||void 0===e?void 0:e.code;if("identity_already_exists"===t||"identity_not_found"===t||"single_identity_not_deletable"===t)return{error:i}}return await this._removeSession(),{error:i}}const{session:s,redirectType:a}=r;return this._debug("#_initialize()","detected session in URL",s,"redirect type",a),await this._saveSession(s),setTimeout((async()=>{"recovery"===a?await this._notifyAllSubscribers("PASSWORD_RECOVERY",s):await this._notifyAllSubscribers("SIGNED_IN",s)}),0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return Zn(t)?{error:t}:{error:new tr("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,n,r;try{const i=await mr(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:null!==(n=null===(t=null===e||void 0===e?void 0:e.options)||void 0===t?void 0:t.data)&&void 0!==n?n:{},gotrue_meta_security:{captcha_token:null===(r=null===e||void 0===e?void 0:e.options)||void 0===r?void 0:r.captchaToken}},xform:gr}),{data:s,error:a}=i;if(a||!s)return{data:{user:null,session:null},error:a};const o=s.session,l=s.user;return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",o)),{data:{user:l,session:o},error:null}}catch(i){if(Zn(i))return{data:{user:null,session:null},error:i};throw i}}async signUp(e){var t,n,r;try{let i;if("email"in e){const{email:n,password:r,options:s}=e;let a=null,o=null;"pkce"===this.flowType&&([a,o]=await Qn(this.storage,this.storageKey)),i=await mr(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:null===s||void 0===s?void 0:s.emailRedirectTo,body:{email:n,password:r,data:null!==(t=null===s||void 0===s?void 0:s.data)&&void 0!==t?t:{},gotrue_meta_security:{captcha_token:null===s||void 0===s?void 0:s.captchaToken},code_challenge:a,code_challenge_method:o},xform:gr})}else{if(!("phone"in e))throw new sr("You must provide either an email or phone number and a password");{const{phone:t,password:s,options:a}=e;i=await mr(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:t,password:s,data:null!==(n=null===a||void 0===a?void 0:a.data)&&void 0!==n?n:{},channel:null!==(r=null===a||void 0===a?void 0:a.channel)&&void 0!==r?r:"sms",gotrue_meta_security:{captcha_token:null===a||void 0===a?void 0:a.captchaToken}},xform:gr})}}const{data:s,error:a}=i;if(a||!s)return{data:{user:null,session:null},error:a};const o=s.session,l=s.user;return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",o)),{data:{user:l,session:o},error:null}}catch(i){if(Zn(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(e){try{let t;if("email"in e){const{email:n,password:r,options:i}=e;t=await mr(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:n,password:r,gotrue_meta_security:{captcha_token:null===i||void 0===i?void 0:i.captchaToken}},xform:vr})}else{if(!("phone"in e))throw new sr("You must provide either an email or phone number and a password");{const{phone:n,password:r,options:i}=e;t=await mr(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:n,password:r,gotrue_meta_security:{captcha_token:null===i||void 0===i?void 0:i.captchaToken}},xform:vr})}}const{data:n,error:r}=t;return r?{data:{user:null,session:null},error:r}:n&&n.session&&n.user?(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:r}):{data:{user:null,session:null},error:new ir}}catch(t){if(Zn(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,n,r,i;return await this._handleProviderSignIn(e.provider,{redirectTo:null===(t=e.options)||void 0===t?void 0:t.redirectTo,scopes:null===(n=e.options)||void 0===n?void 0:n.scopes,queryParams:null===(r=e.options)||void 0===r?void 0:r.queryParams,skipBrowserRedirect:null===(i=e.options)||void 0===i?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,(async()=>this._exchangeCodeForSession(e)))}async _exchangeCodeForSession(e){const t=await Wn(this.storage,`${this.storageKey}-code-verifier`),[n,r]=(null!==t&&void 0!==t?t:"").split("/");try{const{data:t,error:i}=await mr(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:n},xform:gr});if(await Hn(this.storage,`${this.storageKey}-code-verifier`),i)throw i;return t&&t.session&&t.user?(t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),{data:Object.assign(Object.assign({},t),{redirectType:null!==r&&void 0!==r?r:null}),error:i}):{data:{user:null,session:null,redirectType:null},error:new ir}}catch(i){if(Zn(i))return{data:{user:null,session:null,redirectType:null},error:i};throw i}}async signInWithIdToken(e){try{const{options:t,provider:n,token:r,access_token:i,nonce:s}=e,a=await mr(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:r,access_token:i,nonce:s,gotrue_meta_security:{captcha_token:null===t||void 0===t?void 0:t.captchaToken}},xform:gr}),{data:o,error:l}=a;return l?{data:{user:null,session:null},error:l}:o&&o.session&&o.user?(o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",o.session)),{data:o,error:l}):{data:{user:null,session:null},error:new ir}}catch(t){if(Zn(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,n,r,i,s;try{if("email"in e){const{email:r,options:i}=e;let s=null,a=null;"pkce"===this.flowType&&([s,a]=await Qn(this.storage,this.storageKey));const{error:o}=await mr(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:r,data:null!==(t=null===i||void 0===i?void 0:i.data)&&void 0!==t?t:{},create_user:null===(n=null===i||void 0===i?void 0:i.shouldCreateUser)||void 0===n||n,gotrue_meta_security:{captcha_token:null===i||void 0===i?void 0:i.captchaToken},code_challenge:s,code_challenge_method:a},redirectTo:null===i||void 0===i?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:o}}if("phone"in e){const{phone:t,options:n}=e,{data:a,error:o}=await mr(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:t,data:null!==(r=null===n||void 0===n?void 0:n.data)&&void 0!==r?r:{},create_user:null===(i=null===n||void 0===n?void 0:n.shouldCreateUser)||void 0===i||i,gotrue_meta_security:{captcha_token:null===n||void 0===n?void 0:n.captchaToken},channel:null!==(s=null===n||void 0===n?void 0:n.channel)&&void 0!==s?s:"sms"}});return{data:{user:null,session:null,messageId:null===a||void 0===a?void 0:a.message_id},error:o}}throw new sr("You must provide either an email or phone number.")}catch(a){if(Zn(a))return{data:{user:null,session:null},error:a};throw a}}async verifyOtp(e){var t,n;try{let r,i;"options"in e&&(r=null===(t=e.options)||void 0===t?void 0:t.redirectTo,i=null===(n=e.options)||void 0===n?void 0:n.captchaToken);const{data:s,error:a}=await mr(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:r,xform:gr});if(a)throw a;if(!s)throw new Error("An error occurred on token verification.");const o=s.session,l=s.user;return(null===o||void 0===o?void 0:o.access_token)&&(await this._saveSession(o),await this._notifyAllSubscribers("recovery"==e.type?"PASSWORD_RECOVERY":"SIGNED_IN",o)),{data:{user:l,session:o},error:null}}catch(r){if(Zn(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithSSO(e){var t,n,r;try{let i=null,s=null;return"pkce"===this.flowType&&([i,s]=await Qn(this.storage,this.storageKey)),await mr(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:null!==(n=null===(t=e.options)||void 0===t?void 0:t.redirectTo)&&void 0!==n?n:void 0}),(null===(r=null===e||void 0===e?void 0:e.options)||void 0===r?void 0:r.captchaToken)?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:s}),headers:this.headers,xform:br})}catch(i){if(Zn(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,(async()=>await this._reauthenticate()))}async _reauthenticate(){try{return await this._useSession((async e=>{const{data:{session:t},error:n}=e;if(n)throw n;if(!t)throw new rr;const{error:r}=await mr(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:r}}))}catch(e){if(Zn(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:n,type:r,options:i}=e,{error:s}=await mr(this.fetch,"POST",t,{headers:this.headers,body:{email:n,type:r,gotrue_meta_security:{captcha_token:null===i||void 0===i?void 0:i.captchaToken}},redirectTo:null===i||void 0===i?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:s}}if("phone"in e){const{phone:n,type:r,options:i}=e,{data:s,error:a}=await mr(this.fetch,"POST",t,{headers:this.headers,body:{phone:n,type:r,gotrue_meta_security:{captcha_token:null===i||void 0===i?void 0:i.captchaToken}}});return{data:{user:null,session:null,messageId:null===s||void 0===s?void 0:s.message_id},error:a}}throw new sr("You must provide either an email or phone number and a type")}catch(t){if(Zn(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){await this.initializePromise;return await this._acquireLock(-1,(async()=>this._useSession((async e=>e))))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const e=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),n=(async()=>(await e,await t()))();return this.pendingInLock.push((async()=>{try{await n}catch(us){}})()),n}return await this.lock(`lock:${this.storageKey}`,e,(async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const e=t();for(this.pendingInLock.push((async()=>{try{await e}catch(us){}})()),await e;this.pendingInLock.length;){const e=[...this.pendingInLock];await Promise.all(e),this.pendingInLock.splice(0,e.length)}return await e}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}}))}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",(new Error).stack);try{let e=null;const t=await Wn(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),null!==t&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const n=!!e.expires_at&&1e3*e.expires_at-Date.now()<An;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",e.expires_at),!n){if(this.storage.isServer){let t=this.suppressGetSessionWarning;e=new Proxy(e,{get:(e,n,r)=>(t||"user"!==n||(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t=!0,this.suppressGetSessionWarning=!0),Reflect.get(e,n,r))})}return{data:{session:e},error:null}}const{session:r,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{session:null},error:i}:{data:{session:r},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){if(e)return await this._getUser(e);await this.initializePromise;return await this._acquireLock(-1,(async()=>await this._getUser()))}async _getUser(e){try{return e?await mr(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:yr}):await this._useSession((async e=>{var t,n,r;const{data:i,error:s}=e;if(s)throw s;return(null===(t=i.session)||void 0===t?void 0:t.access_token)||this.hasCustomAuthorizationHeader?await mr(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:null!==(r=null===(n=i.session)||void 0===n?void 0:n.access_token)&&void 0!==r?r:void 0,xform:yr}):{data:{user:null},error:new rr}}))}catch(t){if(Zn(t))return function(e){return Zn(e)&&"AuthSessionMissingError"===e.name}(t)&&(await this._removeSession(),await Hn(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:t};throw t}}async updateUser(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return await this.initializePromise,await this._acquireLock(-1,(async()=>await this._updateUser(e,t)))}async _updateUser(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{return await this._useSession((async n=>{const{data:r,error:i}=n;if(i)throw i;if(!r.session)throw new rr;const s=r.session;let a=null,o=null;"pkce"===this.flowType&&null!=e.email&&([a,o]=await Qn(this.storage,this.storageKey));const{data:l,error:u}=await mr(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:null===t||void 0===t?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:a,code_challenge_method:o}),jwt:s.access_token,xform:yr});if(u)throw u;return s.user=l.user,await this._saveSession(s),await this._notifyAllSubscribers("USER_UPDATED",s),{data:{user:s.user},error:null}}))}catch(n){if(Zn(n))return{data:{user:null},error:n};throw n}}_decodeJWT(e){return Jn(e)}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,(async()=>await this._setSession(e)))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new rr;const t=Date.now()/1e3;let n=t,r=!0,i=null;const s=Jn(e.access_token);if(s.exp&&(n=s.exp,r=n<=t),r){const{session:t,error:n}=await this._callRefreshToken(e.refresh_token);if(n)return{data:{user:null,session:null},error:n};if(!t)return{data:{user:null,session:null},error:null};i=t}else{const{data:r,error:s}=await this._getUser(e.access_token);if(s)throw s;i={access_token:e.access_token,refresh_token:e.refresh_token,user:r.user,token_type:"bearer",expires_in:n-t,expires_at:n},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(t){if(Zn(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,(async()=>await this._refreshSession(e)))}async _refreshSession(e){try{return await this._useSession((async t=>{var n;if(!e){const{data:r,error:i}=t;if(i)throw i;e=null!==(n=r.session)&&void 0!==n?n:void 0}if(!(null===e||void 0===e?void 0:e.refresh_token))throw new rr;const{session:r,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{user:null,session:null},error:i}:r?{data:{user:r.user,session:r},error:null}:{data:{user:null,session:null},error:null}}))}catch(t){if(Zn(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e,t){try{if(!zn())throw new ar("No browser detected.");if(e.error||e.error_description||e.error_code)throw new ar(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if("pkce"===this.flowType)throw new or("Not a valid PKCE flow url.");break;case"pkce":if("implicit"===this.flowType)throw new ar("Not a valid implicit grant flow url.")}if("pkce"===t){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new or("No code detected.");const{data:t,error:n}=await this._exchangeCodeForSession(e.code);if(n)throw n;const r=new URL(window.location.href);return r.searchParams.delete("code"),window.history.replaceState(window.history.state,"",r.toString()),{data:{session:t.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:r,access_token:i,refresh_token:s,expires_in:a,expires_at:o,token_type:l}=e;if(!i||!a||!s||!l)throw new ar("No session defined in URL");const u=Math.round(Date.now()/1e3),c=parseInt(a);let d=u+c;o&&(d=parseInt(o));const h=d-u;1e3*h<=In&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${h}s, should have been closer to ${c}s`);const p=d-c;u-p>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",p,d,u):u-p<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",p,d,u);const{data:f,error:m}=await this._getUser(i);if(m)throw m;const g={provider_token:n,provider_refresh_token:r,access_token:i,expires_in:c,expires_at:d,refresh_token:s,token_type:l,user:f.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:g,redirectType:e.type},error:null}}catch(n){if(Zn(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(e){return Boolean(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await Wn(this.storage,`${this.storageKey}-code-verifier`);return!(!e.code||!t)}async signOut(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{scope:"global"};return await this.initializePromise,await this._acquireLock(-1,(async()=>await this._signOut(e)))}async _signOut(){let{scope:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{scope:"global"};return await this._useSession((async t=>{var n;const{data:r,error:i}=t;if(i)return{error:i};const s=null===(n=r.session)||void 0===n?void 0:n.access_token;if(s){const{error:t}=await this.admin.signOut(s,e);if(t&&(!function(e){return Zn(e)&&"AuthApiError"===e.name}(t)||404!==t.status&&401!==t.status&&403!==t.status))return{error:t}}return"others"!==e&&(await this._removeSession(),await Hn(this.storage,`${this.storageKey}-code-verifier`)),{error:null}}))}onAuthStateChange(e){const t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){const t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})),n={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,n),(async()=>{await this.initializePromise,await this._acquireLock(-1,(async()=>{this._emitInitialSession(t)}))})(),{data:{subscription:n}}}async _emitInitialSession(e){return await this._useSession((async t=>{var n,r;try{const{data:{session:r},error:i}=t;if(i)throw i;await(null===(n=this.stateChangeEmitters.get(e))||void 0===n?void 0:n.callback("INITIAL_SESSION",r)),this._debug("INITIAL_SESSION","callback id",e,"session",r)}catch(i){await(null===(r=this.stateChangeEmitters.get(e))||void 0===r?void 0:r.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",i),console.error(i)}}))}async resetPasswordForEmail(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=null,r=null;"pkce"===this.flowType&&([n,r]=await Qn(this.storage,this.storageKey,!0));try{return await mr(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:n,code_challenge_method:r,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(i){if(Zn(i))return{data:null,error:i};throw i}}async getUserIdentities(){var e;try{const{data:t,error:n}=await this.getUser();if(n)throw n;return{data:{identities:null!==(e=t.user.identities)&&void 0!==e?e:[]},error:null}}catch(t){if(Zn(t))return{data:null,error:t};throw t}}async linkIdentity(e){var t;try{const{data:n,error:r}=await this._useSession((async t=>{var n,r,i,s,a;const{data:o,error:l}=t;if(l)throw l;const u=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:null===(n=e.options)||void 0===n?void 0:n.redirectTo,scopes:null===(r=e.options)||void 0===r?void 0:r.scopes,queryParams:null===(i=e.options)||void 0===i?void 0:i.queryParams,skipBrowserRedirect:!0});return await mr(this.fetch,"GET",u,{headers:this.headers,jwt:null!==(a=null===(s=o.session)||void 0===s?void 0:s.access_token)&&void 0!==a?a:void 0})}));if(r)throw r;return zn()&&!(null===(t=e.options)||void 0===t?void 0:t.skipBrowserRedirect)&&window.location.assign(null===n||void 0===n?void 0:n.url),{data:{provider:e.provider,url:null===n||void 0===n?void 0:n.url},error:null}}catch(n){if(Zn(n))return{data:{provider:e.provider,url:null},error:n};throw n}}async unlinkIdentity(e){try{return await this._useSession((async t=>{var n,r;const{data:i,error:s}=t;if(s)throw s;return await mr(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:null!==(r=null===(n=i.session)||void 0===n?void 0:n.access_token)&&void 0!==r?r:void 0})}))}catch(t){if(Zn(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const i=Date.now();return await(n=async n=>(n>0&&await async function(e){return await new Promise((t=>{setTimeout((()=>t(null)),e)}))}(200*Math.pow(2,n-1)),this._debug(t,"refreshing attempt",n),await mr(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:gr})),r=(e,t)=>{const n=200*Math.pow(2,e);return t&&ur(t)&&Date.now()+n-i<In},new Promise(((e,t)=>{(async()=>{for(let i=0;i<1/0;i++)try{const t=await n(i);if(!r(i,null,t))return void e(t)}catch(us){if(!r(i,us))return void t(us)}})()})))}catch(i){if(this._debug(t,"error",i),Zn(i))return{data:{session:null,user:null},error:i};throw i}finally{this._debug(t,"end")}var n,r}_isValidSession(e){return"object"===typeof e&&null!==e&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const n=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",n),zn()&&!t.skipBrowserRedirect&&window.location.assign(n),{data:{provider:e,url:n},error:null}}async _recoverAndRefresh(){var e;const t="#_recoverAndRefresh()";this._debug(t,"begin");try{const n=await Wn(this.storage,this.storageKey);if(this._debug(t,"session from storage",n),!this._isValidSession(n))return this._debug(t,"session is not valid"),void(null!==n&&await this._removeSession());const r=1e3*(null!==(e=n.expires_at)&&void 0!==e?e:1/0)-Date.now()<An;if(this._debug(t,`session has${r?"":" not"} expired with margin of 90000s`),r){if(this.autoRefreshToken&&n.refresh_token){const{error:e}=await this._callRefreshToken(n.refresh_token);e&&(console.error(e),ur(e)||(this._debug(t,"refresh failed with a non-retryable error, removing the session",e),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){return this._debug(t,"error",n),void console.error(n)}finally{this._debug(t,"end")}}async _callRefreshToken(e){var t,n;if(!e)throw new rr;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const r=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{this.refreshingDeferred=new Vn;const{data:t,error:n}=await this._refreshAccessToken(e);if(n)throw n;if(!t.session)throw new rr;await this._saveSession(t.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",t.session);const r={session:t.session,error:null};return this.refreshingDeferred.resolve(r),r}catch(i){if(this._debug(r,"error",i),Zn(i)){const e={session:null,error:i};return ur(i)||await this._removeSession(),null===(t=this.refreshingDeferred)||void 0===t||t.resolve(e),e}throw null===(n=this.refreshingDeferred)||void 0===n||n.reject(i),i}finally{this.refreshingDeferred=null,this._debug(r,"end")}}async _notifyAllSubscribers(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=`#_notifyAllSubscribers(${e})`;this._debug(r,"begin",t,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:e,session:t});const r=[],i=Array.from(this.stateChangeEmitters.values()).map((async n=>{try{await n.callback(e,t)}catch(us){r.push(us)}}));if(await Promise.all(i),r.length>0){for(let e=0;e<r.length;e+=1)console.error(r[e]);throw r[0]}}finally{this._debug(r,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await qn(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await Hn(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&zn()&&(null===window||void 0===window?void 0:window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(us){console.error("removing visibilitychange callback failed",us)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval((()=>this._autoRefreshTokenTick()),In);this.autoRefreshTicker=e,e&&"object"===typeof e&&"function"===typeof e.unref?e.unref():"undefined"!==typeof Deno&&"function"===typeof Deno.unrefTimer&&Deno.unrefTimer(e),setTimeout((async()=>{await this.initializePromise,await this._autoRefreshTokenTick()}),0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,(async()=>{try{const e=Date.now();try{return await this._useSession((async t=>{const{data:{session:n}}=t;if(!n||!n.refresh_token||!n.expires_at)return void this._debug("#_autoRefreshTokenTick()","no session");const r=Math.floor((1e3*n.expires_at-e)/In);this._debug("#_autoRefreshTokenTick()",`access token expires in ${r} ticks, a tick lasts 30000ms, refresh threshold is 3 ticks`),r<=3&&await this._callRefreshToken(n.refresh_token)}))}catch(us){console.error("Auto refresh tick failed with error. This is likely a transient error.",us)}}finally{this._debug("#_autoRefreshTokenTick()","end")}}))}catch(us){if(!(us.isAcquireTimeout||us instanceof Er))throw us;this._debug("auto refresh token tick lock not available")}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!zn()||!(null===window||void 0===window?void 0:window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),null===window||void 0===window||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),"visible"===document.visibilityState?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,(async()=>{"visible"===document.visibilityState?await this._recoverAndRefresh():this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting")})))):"hidden"===document.visibilityState&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,n){const r=[`provider=${encodeURIComponent(t)}`];if((null===n||void 0===n?void 0:n.redirectTo)&&r.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),(null===n||void 0===n?void 0:n.scopes)&&r.push(`scopes=${encodeURIComponent(n.scopes)}`),"pkce"===this.flowType){const[e,t]=await Qn(this.storage,this.storageKey),n=new URLSearchParams({code_challenge:`${encodeURIComponent(e)}`,code_challenge_method:`${encodeURIComponent(t)}`});r.push(n.toString())}if(null===n||void 0===n?void 0:n.queryParams){const e=new URLSearchParams(n.queryParams);r.push(e.toString())}return(null===n||void 0===n?void 0:n.skipBrowserRedirect)&&r.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${e}?${r.join("&")}`}async _unenroll(e){try{return await this._useSession((async t=>{var n;const{data:r,error:i}=t;return i?{data:null,error:i}:await mr(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:null===(n=null===r||void 0===r?void 0:r.session)||void 0===n?void 0:n.access_token})}))}catch(t){if(Zn(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession((async t=>{var n,r;const{data:i,error:s}=t;if(s)return{data:null,error:s};const a=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},"phone"===e.factorType?{phone:e.phone}:{issuer:e.issuer}),{data:o,error:l}=await mr(this.fetch,"POST",`${this.url}/factors`,{body:a,headers:this.headers,jwt:null===(n=null===i||void 0===i?void 0:i.session)||void 0===n?void 0:n.access_token});return l?{data:null,error:l}:("totp"===e.factorType&&(null===(r=null===o||void 0===o?void 0:o.totp)||void 0===r?void 0:r.qr_code)&&(o.totp.qr_code=`data:image/svg+xml;utf-8,${o.totp.qr_code}`),{data:o,error:null})}))}catch(t){if(Zn(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,(async()=>{try{return await this._useSession((async t=>{var n;const{data:r,error:i}=t;if(i)return{data:null,error:i};const{data:s,error:a}=await mr(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:null===(n=null===r||void 0===r?void 0:r.session)||void 0===n?void 0:n.access_token});return a?{data:null,error:a}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+s.expires_in},s)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",s),{data:s,error:a})}))}catch(t){if(Zn(t))return{data:null,error:t};throw t}}))}async _challenge(e){return this._acquireLock(-1,(async()=>{try{return await this._useSession((async t=>{var n;const{data:r,error:i}=t;return i?{data:null,error:i}:await mr(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:null===(n=null===r||void 0===r?void 0:r.session)||void 0===n?void 0:n.access_token})}))}catch(t){if(Zn(t))return{data:null,error:t};throw t}}))}async _challengeAndVerify(e){const{data:t,error:n}=await this._challenge({factorId:e.factorId});return n?{data:null,error:n}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const n=(null===e||void 0===e?void 0:e.factors)||[],r=n.filter((e=>"totp"===e.factor_type&&"verified"===e.status)),i=n.filter((e=>"phone"===e.factor_type&&"verified"===e.status));return{data:{all:n,totp:r,phone:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,(async()=>await this._useSession((async e=>{var t,n;const{data:{session:r},error:i}=e;if(i)return{data:null,error:i};if(!r)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const s=this._decodeJWT(r.access_token);let a=null;s.aal&&(a=s.aal);let o=a;(null!==(n=null===(t=r.user.factors)||void 0===t?void 0:t.filter((e=>"verified"===e.status)))&&void 0!==n?n:[]).length>0&&(o="aal2");return{data:{currentLevel:a,nextLevel:o,currentAuthenticationMethods:s.amr||[]},error:null}}))))}}Nr.nextInstanceID=0;const $r=Nr;class Ir extends $r{constructor(e){super(e)}}var Ar=function(e,t,n,r){return new(n||(n=Promise))((function(i,s){function a(e){try{l(r.next(e))}catch(us){s(us)}}function o(e){try{l(r.throw(e))}catch(us){s(us)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,o)}l((r=r.apply(e,t||[])).next())}))};class Lr{constructor(e,t,n){var r,i,s;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const a=e.replace(/\/$/,"");this.realtimeUrl=`${a}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${a}/auth/v1`,this.storageUrl=`${a}/storage/v1`,this.functionsUrl=`${a}/functions/v1`;const o=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,l=function(e,t){const{db:n,auth:r,realtime:i,global:s}=e,{db:a,auth:o,realtime:l,global:u}=t,c={db:Object.assign(Object.assign({},a),n),auth:Object.assign(Object.assign({},o),r),realtime:Object.assign(Object.assign({},l),i),global:Object.assign(Object.assign({},u),s),accessToken:()=>Nn(this,void 0,void 0,(function*(){return""}))};return e.accessToken?c.accessToken=e.accessToken:delete c.accessToken,c}(null!==n&&void 0!==n?n:{},{db:jn,realtime:En,auth:Object.assign(Object.assign({},Cn),{storageKey:o}),global:Sn});this.storageKey=null!==(r=l.auth.storageKey)&&void 0!==r?r:"",this.headers=null!==(i=l.global.headers)&&void 0!==i?i:{},l.accessToken?(this.accessToken=l.accessToken,this.auth=new Proxy({},{get:(e,t)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(t)} is not possible`)}})):this.auth=this._initSupabaseAuthClient(null!==(s=l.auth)&&void 0!==s?s:{},this.headers,l.global.fetch),this.fetch=On(t,this._getAccessToken.bind(this),l.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},l.realtime)),this.rest=new yt(`${a}/rest/v1`,{headers:this.headers,schema:l.db.schema,fetch:this.fetch}),l.accessToken||this._listenForAuthEvents()}get functions(){return new gt(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new _n(this.storageUrl,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.rest.rpc(e,t,n)}channel(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{config:{}};return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return Ar(this,void 0,void 0,(function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return null!==(t=null===(e=n.session)||void 0===e?void 0:e.access_token)&&void 0!==t?t:null}))}_initSupabaseAuthClient(e,t,n){let{autoRefreshToken:r,persistSession:i,detectSessionInUrl:s,storage:a,storageKey:o,flowType:l,lock:u,debug:c}=e;const d={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Ir({url:this.authUrl,headers:Object.assign(Object.assign({},d),t),storageKey:o,autoRefreshToken:r,persistSession:i,detectSessionInUrl:s,storage:a,flowType:l,lock:u,debug:c,fetch:n,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new Xt(this.realtimeUrl,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},null===e||void 0===e?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange(((e,t)=>{this._handleTokenChanged(e,"CLIENT",null===t||void 0===t?void 0:t.access_token)}))}_handleTokenChanged(e,t,n){"TOKEN_REFRESHED"!==e&&"SIGNED_IN"!==e||this.changedAccessToken===n?"SIGNED_OUT"===e&&(this.realtime.setAuth(),"STORAGE"==t&&this.auth.signOut(),this.changedAccessToken=void 0):this.changedAccessToken=n}}const Dr=(e,t,n)=>new Lr(e,t,n),Fr=Dr("https://ningownvozatrbldumdt.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im5pbmdvd252b3phdHJibGR1bWR0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDA2NzQxMTUsImV4cCI6MjA1NjI1MDExNX0.UoiEyI0T2v_DCt6kTL3HHttef2t8NDiHQoNXV4U1iF8"),zr=Dr("https://vuzntlbldmfsiatxgnqp.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZ1em50bGJsZG1mc2lhdHhnbnFwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzU3MTc0NDUsImV4cCI6MjA1MTI5MzQ0NX0.YOSJfQoM1Qlq6xGM960y-4KiVsjhuXq7b_kjQAbvx58");var Mr=n(579);const Br=()=>{const e=ee(),[t,n]=(0,r.useState)(""),[i,s]=(0,r.useState)(""),[a,o]=(0,r.useState)(""),[l,u]=(0,r.useState)(!1),[c,d]=(0,r.useState)("google"),[h,p]=(0,r.useState)(!1),[f,m]=(0,r.useState)(""),[g,v]=(0,r.useState)(null),[y,b]=(0,r.useState)([]),[x,w]=(0,r.useState)(!1),[_,k]=(0,r.useState)([]);(0,r.useEffect)((()=>{h&&f.trim()&&(w(!0),(async()=>{try{const e=f.trim().split("/").pop(),{data:t,error:n}=await zr.from("form_schemas").select("schema").eq("id",e).single();if(n||!t)throw n||new Error("Schema not found");const r=t.schema.properties||{};b(Object.entries(r).map((e=>{let[t,n]=e;return{key:t,title:n.title||t}})))}catch(us){console.error("Crafty schema load failed",us)}finally{w(!1)}})())}),[h,f]);const[S,j]=(0,r.useState)(!1);return(0,Mr.jsxs)("div",{className:"process-form-container",children:[(0,Mr.jsx)("h2",{className:"process-form-title",children:"google"===c?"Add New Process + Google Form":"Add New Process + Crafty Form"}),(0,Mr.jsxs)("div",{className:"form-type-options",children:[(0,Mr.jsx)("button",{onClick:()=>{d("google"),p(!1)},disabled:l,className:"google"===c?"active":"",children:"Continue with Google Form"}),(0,Mr.jsx)("button",{onClick:()=>{d("crafty"),p(!1)},disabled:l,className:"crafty"===c?"active":"",children:"Continue with Crafty Form"})]}),(0,Mr.jsxs)("form",{onSubmit:"google"===c?async n=>{if(n.preventDefault(),t.trim()){u(!0);try{const{data:{session:n}}=await Fr.auth.getSession();if(null===n||void 0===n||!n.user)throw new Error("User not authenticated. Please sign in first.");const r=n.user.id,{data:s,error:o}=await Fr.from("processes").insert([{name:t,user_id:r,responsibility:a.trim()||null,ghost_mode:S}]).select("*").single();if(o||!s)throw o||new Error("Failed to create process");const l=s.id,u=localStorage.getItem("googleToken");if(!u)throw new Error("Not authenticated with Google. Go to /auth first.");const c=i.split(",").map((e=>e.trim())).filter((e=>e.length>0)),d=await fetch("https://step-by-step-server-production.up.railway.app/createForm",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:t,ownerEmails:c,token:u})});if(!d.ok){const e=await d.text();throw new Error(e)}const h=await d.json(),{error:p}=await Fr.from("forms").insert([{process_id:l,google_form_id:h.formId,google_form_url:h.editUrl}]).single();if(p)throw p;window.open(h.editUrl,"_blank"),setTimeout((()=>{e(`/process/${l}/steps`)}),2e3)}catch(r){console.error("Error in Google Form flow:",r),alert(r.message)}finally{u(!1)}}}:async e=>{if(e.preventDefault(),t.trim()){u(!0);try{const{data:{session:e}}=await Fr.auth.getSession();if(null===e||void 0===e||!e.user)throw new Error("User not authenticated. Please sign in first.");const n=e.user.id,{data:r,error:i}=await Fr.from("processes").insert([{name:t,user_id:n,responsibility:a.trim()||null,ghost_mode:S}]).select("*").single();if(i||!r)throw i||new Error("Failed to create process");const s=r.id;v(s),window.open("https://nimble-phoenix-504247.netlify.app/","_blank"),p(!0)}catch(n){console.error("Error in Crafty Form flow:",n),alert(n.message),u(!1)}}},className:"process-form",children:[(0,Mr.jsxs)("div",{className:"form-group",children:[(0,Mr.jsx)("label",{className:"form-label",children:"Process Name:"}),(0,Mr.jsx)("input",{type:"text",value:t,onChange:e=>n(e.target.value),required:!0,className:"form-input"})]}),(0,Mr.jsxs)("div",{className:"form-group",children:[(0,Mr.jsx)("label",{className:"form-label",children:"Process Responsibility (optional):"}),(0,Mr.jsx)("input",{type:"text",value:a,onChange:e=>o(e.target.value),placeholder:"E.g. johndoe@example.com or Team-X",className:"form-input"}),(0,Mr.jsx)("small",{style:{color:"#555",fontSize:"0.9rem"},children:"If you fill this in now, all steps under this process will inherit it unless overridden."})]}),(0,Mr.jsxs)("div",{className:"form-group",children:[(0,Mr.jsx)("label",{className:"form-label",children:"Share with (Editor Emails):"}),(0,Mr.jsx)("input",{type:"email",multiple:!0,value:i,onChange:e=>s(e.target.value),placeholder:"Enter comma-separated emails for editor access (optional)",className:"form-input"})]}),(0,Mr.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:16,position:"relative"},children:[(0,Mr.jsx)("input",{id:"ghostToggle",type:"checkbox",checked:S,onChange:e=>{console.log("ghostMode now \u2192",e.target.checked),j(e.target.checked)},style:{position:"absolute",opacity:0,width:0,height:0}}),(0,Mr.jsx)("label",{htmlFor:"ghostToggle",style:{width:50,height:28,borderRadius:14,background:S?"#4ade80":"#ccc",cursor:"pointer",display:"flex",alignItems:"center",padding:2,transition:"background 0.2s"},children:(0,Mr.jsx)("div",{style:{width:24,height:24,borderRadius:"50%",background:"#fff",transition:"transform 0.2s",transform:S?"translateX(24px)":"translateX(0)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:16,fontWeight:"bold"},children:S?"+":"\u2013"})}),(0,Mr.jsx)("span",{style:{marginLeft:8,fontSize:"1rem"},children:"Ghost Mode"})]}),(0,Mr.jsx)("button",{type:"submit",disabled:l,className:"process-form-button",children:l?"Creating...":"google"===c?"Create Google Form":"Create Crafty Form"})]}),h&&(0,Mr.jsxs)("div",{className:"shared-link-container",children:[(0,Mr.jsx)("h3",{children:"Paste Your Crafted Form Link"}),(0,Mr.jsx)("input",{type:"text",value:f,onChange:e=>m(e.target.value),placeholder:"Enter the shareable form link here...",className:"shared-link-input"}),(0,Mr.jsx)("p",{style:{fontStyle:"italic",color:"#555",marginBottom:"0.5rem"},children:"These fields will be shown on the Doer card"}),x?(0,Mr.jsx)("p",{children:"Loading fields\u2026"}):(0,Mr.jsx)("div",{className:"field-checklist",children:y.map((e=>(0,Mr.jsxs)("label",{children:[(0,Mr.jsx)("input",{type:"checkbox",value:e.key,disabled:!_.includes(e.key)&&_.length>=3,checked:_.includes(e.key),onChange:e=>{const{value:t,checked:n}=e.target;k((e=>n?[...e,t]:e.filter((e=>e!==t))))}}),e.title]},e.key)))}),(0,Mr.jsx)("button",{onClick:async()=>{if(f.trim()&&g)if(0!==_.length)try{const{error:t}=await Fr.from("forms").insert([{process_id:g,google_form_id:null,google_form_url:f.trim(),selected_fields:_}]).single();if(t)throw t;alert("Crafty form link saved successfully!"),p(!1),setTimeout((()=>{e(`/process/${g}/steps`)}),2e3)}catch(t){console.error("Error saving shared link:",t),alert(t.message)}else alert("Select at least one field (max 3) before saving.");else alert("Please enter a valid shared form link.")},className:"shared-link-button",children:"Save Shared Link"})]}),(0,Mr.jsx)("style",{children:"\n        .process-form-container {\n          padding: 1rem;\n          background: #f9f9f9;\n          border-radius: 8px;\n          max-width: 500px;\n          margin: 2rem auto;\n          box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n          font-family: Arial, sans-serif;\n        }\n        .process-form-title {\n          font-size: 1.5rem;\n          margin-bottom: 1rem;\n          text-align: center;\n          color: #333;\n        }\n        .form-type-options {\n          display: flex;\n          justify-content: center;\n          gap: 1rem;\n          margin-bottom: 1rem;\n        }\n        .form-type-options button {\n          padding: 0.5rem 1rem;\n          background-color: #ddd;\n          border: none;\n          border-radius: 4px;\n          cursor: pointer;\n          transition: background-color 0.2s ease;\n        }\n        .form-type-options button.active,\n        .form-type-options button:hover:not(:disabled) {\n          background-color: #ccc;\n        }\n        .process-form {\n          display: flex;\n          flex-direction: column;\n        }\n        .form-group {\n          margin-bottom: 1rem;\n        }\n        .form-label {\n          display: block;\n          margin-bottom: 0.5rem;\n          font-weight: bold;\n          color: #555;\n        }\n        .form-input {\n          width: 100%;\n          padding: 0.5rem;\n          border: 1px solid #ccc;\n          border-radius: 4px;\n          font-size: 1rem;\n        }\n        .process-form-button {\n          margin-top: 1rem;\n          padding: 0.75rem;\n          border: none;\n          background-color: #000a;\n          color: white;\n          border-radius: 4px;\n          cursor: pointer;\n          transition: background-color 0.2s ease;\n          font-size: 1rem;\n        }\n        .process-form-button:disabled {\n          background-color: #aaa;\n          cursor: not-allowed;\n        }\n        .process-form-button:hover:not(:disabled) {\n          background-color: #000;\n        }\n        .shared-link-container {\n          margin-top: 2rem;\n          padding: 1rem;\n          border: 1px solid #ccc;\n          border-radius: 8px;\n          background-color: #fff;\n        }\n        .shared-link-input {\n          width: 100%;\n          padding: 0.5rem;\n          margin-bottom: 1rem;\n          border: 1px solid #ccc;\n          border-radius: 4px;\n          font-size: 1rem;\n        }\n        .shared-link-button {\n          padding: 0.5rem 1rem;\n          background-color: #28a745;\n          border: none;\n          color: #fff;\n          border-radius: 4px;\n          cursor: pointer;\n          transition: background-color 0.2s ease;\n        }\n        .shared-link-button:hover {\n          background-color: #218838;\n        }\n      "})]})},Ur=()=>{const{processId:e}=te(),t=ee(),[n,i]=(0,r.useState)([]),[s,a]=(0,r.useState)(!0),[o,l]=(0,r.useState)(""),[u,c]=(0,r.useState)({}),[d,h]=(0,r.useState)(null),[p,f]=(0,r.useState)(null);(0,r.useEffect)((()=>{e&&(m(e),g(e))}),[e]);const m=async e=>{a(!0);const{data:t,error:n}=await Fr.from("steps").select("*").eq("process_id",e).order("sequence_id",{ascending:!0}).order("created_at",{ascending:!0});if(n)return console.error("Error fetching steps:",n),void a(!1);t&&i(t),a(!1)},g=async e=>{const{data:t,error:n}=await Fr.from("forms").select("google_form_url").eq("process_id",e).single();n?console.error("Error fetching form link:",n):null!==t&&void 0!==t&&t.google_form_url&&l(t.google_form_url)},v=n.reduce(((e,t)=>{var n;return e+((e,t)=>{switch(t){case"mins":return e/60;case"hrs":default:return e;case"days":return 24*e;case"weeks":return 168*e}})(null!==(n=t.tat_value)&&void 0!==n?n:0,t.tat_unit||"hrs")}),0),y=(e,t)=>{c((n=>{const r=n[e]||{};return{...n,[e]:{...r,[t]:!r[t]}}}))},b=e=>{f(null)},x=()=>{h(null),f(null)};if(s)return(0,Mr.jsx)("div",{style:{padding:"1rem"},children:"Loading steps..."});const w={backgroundColor:"#eee",border:"none",padding:"8px 12px",borderRadius:"4px",cursor:"pointer",marginLeft:"0.5rem"},_={display:"flex",flexDirection:"column",backgroundColor:"#E0E0E0",borderRadius:"8px",padding:"1rem",marginBottom:"0.5rem",transition:"background-color 0.2s ease, border 0.2s ease"},k={display:"flex",alignItems:"center"},S={flex:1},j={display:"flex",alignItems:"center",marginBottom:"0.25rem"},C={marginRight:"1rem",fontWeight:"bold",fontSize:"1rem"},E={fontWeight:"bold",fontSize:"1rem"},T={fontSize:"0.9rem",color:"#555",marginBottom:"0.25rem"},R={fontSize:"0.8rem",color:"#777",cursor:"pointer"},P={backgroundColor:"#fff",padding:"0.5rem",border:"1px solid #ddd",borderRadius:"4px",marginTop:"0.5rem"},O=o?(0,Mr.jsxs)("div",{style:{marginBottom:"1rem",display:"flex",alignItems:"center"},children:[(0,Mr.jsx)("span",{style:{marginRight:"0.5rem"},children:"Form Link:"}),(0,Mr.jsx)("a",{href:o,target:"_blank",rel:"noreferrer",style:{color:"blue",textDecoration:"underline",marginRight:"0.5rem"},children:o}),(0,Mr.jsx)("button",{style:w,onClick:async()=>{if(o)try{await navigator.clipboard.writeText(o),alert("Form link copied to clipboard!")}catch(e){console.error("Failed to copy:",e),alert("Could not copy link.")}},children:"Copy"})]}):null;return(0,Mr.jsxs)("div",{style:{maxWidth:"700px",margin:"auto",padding:"1rem",fontFamily:"sans-serif"},children:[O,(0,Mr.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:"1rem"},children:[(0,Mr.jsx)("button",{onClick:()=>t(-1),style:{background:"none",border:"none",fontSize:"1rem",cursor:"pointer",marginRight:"0.5rem"},children:"\u2190"}),(0,Mr.jsx)("span",{style:{fontSize:"1.2rem",marginRight:"0.5rem",cursor:"pointer"},children:"\u26b2"}),(0,Mr.jsxs)("span",{style:{fontSize:"1.2rem",fontWeight:"bold"},children:["Steps for Process ",e]}),(0,Mr.jsx)("div",{style:{flex:1}}),(0,Mr.jsxs)("div",{style:{marginRight:"1rem",color:"#555"},children:[v.toFixed(2)," hrs in total"]}),(0,Mr.jsx)("button",{style:w,onClick:()=>{e&&t(`/process/${e}/add-step`)},children:"+ Add a Step"}),(0,Mr.jsx)("button",{style:w,onClick:()=>{e&&t(`/process/${e}/bulk-edit`)},children:"Bulk Add / Edit"})]}),n.map(((e,t)=>{var r,s,a,o,l,c,m,g,v,w,O,N,$,I,A;const L=null!==(r=e.step_id)&&void 0!==r?r:t+1,D=null!==(s=e.sequence_id)&&void 0!==s?s:0,F={..._,backgroundColor:d===t?"#c8e6c9":"#E0E0E0",borderTop:p===t?"3px dashed #388e3c":"none",flex:1};return(0,Mr.jsxs)("div",{style:{display:"flex",alignItems:"stretch",marginBottom:"0.5rem"},children:[(0,Mr.jsxs)("div",{style:{width:"40px",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",fontSize:"0.8rem",color:"#666",marginRight:"-8px",zIndex:1,background:"transparent"},children:[(0,Mr.jsxs)("div",{children:["#",L]}),(0,Mr.jsxs)("div",{children:["#",D]})]}),(0,Mr.jsxs)("div",{style:F,draggable:!0,onDragStart:e=>((e,t)=>{h(t),e.dataTransfer.setData("dragIndex",t.toString())})(e,t),onDragOver:e=>((e,t)=>{e.preventDefault(),f(t)})(e,t),onDragLeave:b,onDrop:e=>(async(e,t)=>{e.preventDefault();const r=e.dataTransfer.getData("dragIndex");if(!r)return;const s=parseInt(r,10);if(s===t)return;const a=[...n],[o]=a.splice(s,1);a.splice(t,0,o);const l=a.map(((e,t)=>({...e,sequence_id:t+1,step_id:t+1})));i(l),h(null),f(null);for(let n of l){const{error:e}=await Fr.from("steps").update({sequence_id:n.sequence_id,step_id:n.step_id}).eq("id",n.id);e&&console.error("Failed to update step sequence:",e)}})(e,t),onDragEnd:x,children:[(0,Mr.jsxs)("div",{style:k,children:[(0,Mr.jsx)("div",{style:{cursor:"grab",marginRight:"1rem"},children:"\u2630"}),(0,Mr.jsxs)("div",{style:S,children:[(0,Mr.jsxs)("div",{style:j,children:[(0,Mr.jsxs)("span",{style:C,children:[null!==(a=e.tat_value)&&void 0!==a?a:0," ",e.tat_unit||"hrs"]}),(0,Mr.jsx)("span",{style:E,children:e.name||"Name of Step"})]}),(0,Mr.jsx)("div",{style:T,children:e.responsibilities?e.responsibilities.join(", "):e.responsibility||"Responsibility or a role"}),(0,Mr.jsxs)("div",{style:R,children:[(0,Mr.jsxs)("span",{onClick:()=>y(e.id,"statuses"),children:[null!==(o=null===(l=e.statuses)||void 0===l?void 0:l.length)&&void 0!==o?o:0," statuses"]})," ","|"," ",(0,Mr.jsxs)("span",{onClick:()=>y(e.id,"alerts"),children:[null!==(c=null===(m=e.alerts)||void 0===m?void 0:m.length)&&void 0!==c?c:0," alerts"]})," ","|"," ",(0,Mr.jsxs)("span",{onClick:()=>y(e.id,"reminders"),children:[null!==(g=null===(v=e.reminders)||void 0===v?void 0:v.length)&&void 0!==g?g:0," reminders"]})]})]})]}),(null===(w=u[e.id])||void 0===w?void 0:w.statuses)&&(0,Mr.jsxs)("div",{style:P,children:[(0,Mr.jsx)("strong",{children:"Statuses:"}),null!==(O=e.statuses)&&void 0!==O&&O.length?e.statuses.map(((e,t)=>(0,Mr.jsxs)("div",{style:{marginBottom:"0.5rem"},children:[(0,Mr.jsx)("strong",{children:e.statusName})," - ",e.statusType,e.linkNext&&(0,Mr.jsxs)("em",{children:[" (Next: ",e.linkNext,")"]})]},t))):(0,Mr.jsx)("div",{children:"No statuses available."})]}),(null===(N=u[e.id])||void 0===N?void 0:N.alerts)&&(0,Mr.jsxs)("div",{style:P,children:[(0,Mr.jsx)("strong",{children:"Alerts:"}),null!==($=e.alerts)&&void 0!==$&&$.length?e.alerts.map(((e,t)=>(0,Mr.jsxs)("div",{style:{marginBottom:"0.5rem"},children:[(0,Mr.jsx)("strong",{children:e.alert_type})," via ",e.alert_via," for"," ",e.person_or_team]},t))):(0,Mr.jsx)("div",{children:"No alerts available."})]}),(null===(I=u[e.id])||void 0===I?void 0:I.reminders)&&(0,Mr.jsxs)("div",{style:P,children:[(0,Mr.jsx)("strong",{children:"Reminders:"}),null!==(A=e.reminders)&&void 0!==A&&A.length?e.reminders.map(((e,t)=>(0,Mr.jsxs)("div",{style:{marginBottom:"0.5rem"},children:[(0,Mr.jsx)("strong",{children:e.frequency})," - ",e.till_when]},t))):(0,Mr.jsx)("div",{children:"No reminders available."})]})]})]},e.id)}))]})},qr=()=>{const e=ee(),[t,n]=(0,r.useState)([]),[i,s]=(0,r.useState)(null),[a,o]=(0,r.useState)(""),[l,u]=(0,r.useState)(0);(0,r.useEffect)((()=>{d(),c()}),[]);const c=async()=>{const{data:{session:e}}=await Fr.auth.getSession();if(null===e||void 0===e||!e.user)return;const t=e.user.id,{count:n,error:r}=await Fr.from("steps").select("id",{head:!0,count:"exact"}).is("process_id",null).eq("user_id",t);r||null===n||u(n)},d=async()=>{const{data:{session:e}}=await Fr.auth.getSession();if(!e||!e.user)return void console.error("No user session found.");const t=e.user.id,{data:r,error:i}=await Fr.from("processes").select("\n        id,\n        name,\n        steps (id, tat_value, tat_unit),\n        form_submissions (id)\n      ").eq("user_id",t).order("created_at",{ascending:!1});i?console.error("Error fetching processes:",i):r&&n(r)},h={padding:"0.5rem 1rem",backgroundColor:"#333",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer"},p={position:"relative",backgroundColor:"#eee",borderRadius:"8px",padding:"1rem",marginBottom:"0.5rem",cursor:"pointer"},f={display:"flex",justifyContent:"space-between",alignItems:"center"},m={margin:"0",color:"#666",fontWeight:"bold"},g={position:"absolute",top:"8px",right:"8px",cursor:"pointer",fontSize:"1.2rem"},v={position:"absolute",top:"32px",right:"8px",background:"#fff",border:"1px solid #ccc",borderRadius:"4px",padding:"0.25rem",zIndex:2},y={padding:"0.5rem",cursor:"pointer"},b=t.filter((e=>e.name.toLowerCase().includes(a.toLowerCase())));return(0,Mr.jsxs)("div",{style:{maxWidth:"600px",margin:"auto",padding:"1rem",fontFamily:"Arial, sans-serif"},children:[(0,Mr.jsx)("h1",{style:{fontSize:"1.5rem",marginBottom:"1rem"},children:"Define Processes"}),(0,Mr.jsxs)("div",{style:{display:"flex",gap:"0.5rem",marginBottom:"1rem"},children:[(0,Mr.jsx)("input",{type:"text",placeholder:"Search...",style:{flex:1,padding:"0.5rem"},value:a,onChange:e=>o(e.target.value)}),(0,Mr.jsx)("button",{style:h,onClick:()=>{e("/add-process")},children:"+ Add a Process"}),(0,Mr.jsxs)("button",{style:h,onClick:()=>e("/random-task-list"),children:["Random Task List (",l,")   "]})]}),b.map((t=>{var n,r,a,o,l,u;const c=null!==(n=null===(r=t.steps)||void 0===r?void 0:r.length)&&void 0!==n?n:0,h=null!==(a=null===(o=t.form_submissions)||void 0===o?void 0:o.length)&&void 0!==a?a:0,b=null!==(l=null===(u=t.steps)||void 0===u?void 0:u.reduce(((e,t)=>{const n=t.tat_value||0;switch(t.tat_unit){case"mins":return e+n;case"hrs":return e+60*n;case"days":return e+1440*n;case"weeks":return e+10080*n;default:return e}}),0))&&void 0!==l?l:0;let x;return x=b>=1440?(b/1440).toFixed(1)+" days":b>=60?(b/60).toFixed(1)+" hrs":b+" mins",(0,Mr.jsxs)("div",{style:p,onClick:()=>{return n=t.id,void e(`/process/${n}/steps`);var n},children:[(0,Mr.jsx)("h3",{style:{margin:"0 0 0.5rem 0"},children:t.name}),(0,Mr.jsxs)("div",{style:f,children:[(0,Mr.jsxs)("p",{style:{margin:0},children:[c," Steps \u2022 ",h," data points"]}),(0,Mr.jsx)("p",{style:m,children:x})]}),(0,Mr.jsx)("span",{style:g,onClick:e=>((e,t)=>{e.stopPropagation(),s((e=>e===t?null:t))})(e,t.id),children:"\u22ee"}),i===t.id&&(0,Mr.jsxs)("div",{style:v,onClick:e=>e.stopPropagation(),children:[(0,Mr.jsx)("div",{style:y,onClick:()=>(async(e,t)=>{const n=prompt("Enter new process name:",t);if(!n||!n.trim())return;const{error:r}=await Fr.from("processes").update({name:n}).eq("id",e);r?(console.error("Error updating process:",r),alert("Failed to update process")):(d(),s(null))})(t.id,t.name),children:"Edit"}),(0,Mr.jsx)("div",{style:y,onClick:()=>(async e=>{if(!window.confirm("Are you sure you want to delete this process?"))return;const{error:t}=await Fr.from("processes").delete().eq("id",e);t?(console.error("Error deleting process:",t),alert("Failed to delete process")):(d(),s(null))})(t.id),children:"Delete"})]})]},t.id)}))]})},Wr=()=>{const[e,t]=(0,r.useState)(""),[n,i]=(0,r.useState)(""),[s,a]=(0,r.useState)("");return(0,Mr.jsxs)("div",{style:{padding:"1rem"},children:[(0,Mr.jsx)("h2",{children:"Sync Google Form Responses"}),(0,Mr.jsxs)("div",{children:[(0,Mr.jsx)("label",{children:"Form ID:"}),(0,Mr.jsx)("input",{type:"text",value:e,onChange:e=>t(e.target.value)})]}),(0,Mr.jsxs)("div",{children:[(0,Mr.jsx)("label",{children:"Process ID:"}),(0,Mr.jsx)("input",{type:"text",value:n,onChange:e=>i(e.target.value)})]}),(0,Mr.jsx)("button",{onClick:async()=>{if(e&&n)try{const t=await fetch("http://localhost:5000/api/syncFormResponses",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({formId:e,processId:n})});if(!t.ok)throw new Error(`Server responded with ${t.status}`);const r=await t.json();a(`Synced. Inserted ${r.inserted} out of ${r.totalResponses}`)}catch(t){console.error(t),a(`Error: ${t.message}`)}else alert("Need formId and processId")},children:"Sync"}),(0,Mr.jsx)("p",{children:s})]})},Hr=e=>{let{reminders:t,setReminders:n}=e;const r={display:"block",marginBottom:"0.25rem",fontWeight:"bold"},i={width:"100%",padding:"0.4rem",boxSizing:"border-box",marginBottom:"0.5rem"},s=(e,t,r)=>{n((n=>{const i=[...n];return i[e]={...i[e],[t]:r},i}))};return(0,Mr.jsxs)("div",{style:{border:"1px solid #ccc",padding:"1rem",marginTop:"1rem",borderRadius:"5px",position:"relative"},children:[(0,Mr.jsx)("h3",{style:{margin:0,marginBottom:"1rem"},children:"Reminders"}),t.map(((e,t)=>(0,Mr.jsxs)("div",{style:{marginBottom:"1rem",borderBottom:"1px solid #eee",paddingBottom:"0.5rem"},children:[(0,Mr.jsx)("label",{style:r,children:"Frequency"}),(0,Mr.jsx)("input",{type:"text",style:i,value:e.frequency,onChange:e=>s(t,"frequency",e.target.value)}),(0,Mr.jsx)("label",{style:r,children:"Till When"}),(0,Mr.jsx)("input",{type:"text",style:i,value:e.till_when,onChange:e=>s(t,"till_when",e.target.value)}),(0,Mr.jsx)("label",{style:r,children:"Input Type"}),(0,Mr.jsxs)("select",{style:i,value:e.inputType,onChange:e=>s(t,"inputType",e.target.value),children:[(0,Mr.jsx)("option",{value:"text",children:"Text"}),(0,Mr.jsx)("option",{value:"checkbox",children:"Checkbox"}),(0,Mr.jsx)("option",{value:"radio",children:"Radio"}),(0,Mr.jsx)("option",{value:"dropdown",children:"Dropdown"}),(0,Mr.jsx)("option",{value:"button",children:"Button"})]}),["checkbox","radio","dropdown"].includes(e.inputType)&&(0,Mr.jsxs)(Mr.Fragment,{children:[(0,Mr.jsx)("label",{style:r,children:"Options (comma-separated)"}),(0,Mr.jsx)("input",{type:"text",style:i,placeholder:"e.g. Daily,Weekly",value:e.options,onChange:e=>s(t,"options",e.target.value)})]})]},t))),(0,Mr.jsx)("button",{style:{cursor:"pointer",fontWeight:"bold",fontSize:"1.2rem",background:"none",border:"none"},onClick:()=>{n((e=>[...e,{frequency:"",till_when:"",inputType:"text",options:""}]))},children:"\uff0b"})]})};function Vr(e,t){const n=document.createElement("div"),r=getComputedStyle(e);for(const u of["boxSizing","width","height","overflowX","overflowY","borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth","paddingTop","paddingRight","paddingBottom","paddingLeft","fontStyle","fontVariant","fontWeight","fontStretch","fontSize","lineHeight","fontFamily","textAlign","textTransform","textIndent","whiteSpace","wordWrap"])n.style[u]=r[u];n.style.position="absolute",n.style.visibility="hidden",n.style.whiteSpace="pre-wrap",n.style.wordWrap="break-word";const i=e.value.substring(0,t),s=e.value.substring(t)||".";n.textContent=i;const a=document.createElement("span");a.textContent=s,n.appendChild(a),document.body.appendChild(n);const{offsetTop:o,offsetLeft:l}=a;return document.body.removeChild(n),{top:o-e.scrollTop+parseInt(r.borderTopWidth),left:l-e.scrollLeft+parseInt(r.borderLeftWidth)}}function Jr(){let e=localStorage.getItem("WASENDER_TOKEN");if(!e){if(e=window.prompt("Please enter your WhatsApp API key for Wasender:"),!e)return alert("WhatsApp API key is required to send alerts."),null;localStorage.setItem("WASENDER_TOKEN",e)}return e}function Kr(){const{flowchartId:e}=te(),[t]=at(),n=ee(),i=t.get("mode")||"add",s=t.get("stepId"),a=t.get("sequenceId"),o=s?Number(s):0,l=a?Number(a):0,u={display:"flex",gap:16,marginBottom:8},c={display:"block",fontWeight:"bold",marginBottom:4},d={width:"100%",padding:6,boxSizing:"border-box"},h={border:"1px solid #ccc",padding:16,borderRadius:4,marginTop:16},[p,f]=(0,r.useState)("status"),[m,g]=(0,r.useState)(o),[v,y]=(0,r.useState)(l),[b,x]=(0,r.useState)(""),[w,_]=(0,r.useState)(""),[k,S]=(0,r.useState)("hrs"),[j,C]=(0,r.useState)(""),[E,T]=(0,r.useState)(""),[R,P]=(0,r.useState)(null),[O,N]=(0,r.useState)("immediate"),[$,I]=(0,r.useState)(""),[A,L]=(0,r.useState)("dropdown"),[D,F]=(0,r.useState)([{statusName:"",inputType:"dropdown",optionName:"",actionMapping:"",nextStep:!1,split:!1,alertEnabled:!1,alertType:"email",alertEmail:"",alertTemplate:""}]),[z,M]=(0,r.useState)([{text:"",isChecked:!1}]),[B,U]=(0,r.useState)(""),[q,W]=(0,r.useState)(""),[H,V]=(0,r.useState)(""),[J,K]=(0,r.useState)([{statusName:"",type:["email"],email:"",template:"",buttons:[{title:"",reply:""}]}]),[G,Q]=(0,r.useState)([{frequency:"",till_when:"",inputType:"text",options:""}]),[Y,X]=(0,r.useState)({}),[Z,ne]=(0,r.useState)({}),[re,ie]=(0,r.useState)(!1),[se,ae]=(0,r.useState)([]),[oe,le]=(0,r.useState)([]),ue=(0,r.useRef)(void 0),[ce,de]=(0,r.useState)([]),[he,pe]=(0,r.useState)(!1),[fe,me]=(0,r.useState)([]),ge=(0,r.useRef)(void 0),[ve,ye]=(0,r.useState)([]),[be,xe]=(0,r.useState)(!1),[we,_e]=(0,r.useState)({}),[ke,Se]=(0,r.useState)({}),[je,Ce]=(0,r.useState)({}),[Ee,Te]=(0,r.useState)({}),[Re,Pe]=(0,r.useState)({});const[Oe,Ne]=(0,r.useState)([]),[$e,Ie]=(0,r.useState)({}),[Ae,Le]=(0,r.useState)({}),[De,Fe]=(0,r.useState)({}),[ze,Me]=(0,r.useState)([]),[Be,Ue]=(0,r.useState)([]),[qe,We]=(0,r.useState)(!1),He=(0,r.useRef)([]),[Ve,Je]=(0,r.useState)({top:0,left:0});function Ke(e){const t=null!==e&&void 0!==e?e:new Date,n=t.getTime()+60*t.getTimezoneOffset()*1e3,r=new Date(n+198e5),i=e=>String(e).padStart(2,"0");return`${r.getFullYear()}-${i(r.getMonth()+1)}-${i(r.getDate())} ${i(r.getHours())}:${i(r.getMinutes())}:${i(r.getSeconds())}`}(0,r.useEffect)((()=>{"edit"===i&&e&&Fr.from("steps").select("*").eq("process_id",e).eq("step_id",o).eq("sequence_id",l).single().then((e=>{let{data:t}=e;if(t)if(x(t.name||""),_(null!=t.tat_value?String(t.tat_value):""),S(t.tat_unit||"hrs"),C(t.dependencies&&t.dependencies[0]||""),T(t.responsibility||""),f(t.step_type||"status"),t.statuses&&F(t.statuses),t.checklists&&M(t.checklists),t.checklistActionMapping&&U(t.checklistActionMapping),t.form_url&&W(t.form_url),t.crafty_action_mapping&&V(t.crafty_action_mapping),_e(t.field_action_mapping||{}),Ie(t.option_action_mapping||{}),t.scheduled_at){const e=new Date(t.scheduled_at).toISOString().slice(0,16);N("scheduled"),I(e)}else t.started_at&&N("immediate")}))}),[i,e,o,l]),(0,r.useEffect)((()=>{F((e=>e.map((e=>({...e,inputType:A})))))}),[A]),(0,r.useEffect)((()=>{Fr.auth.getSession().then((e=>{var t,n;let{data:r}=e;const i=null===(t=r.session)||void 0===t||null===(n=t.user)||void 0===n?void 0:n.id;i&&Fr.from("processes").select("id,name,steps:steps(*)").eq("user_id",i).then((e=>{let{data:t}=e;return t&&Ne(t)}))}))}),[]),(0,r.useEffect)((()=>{if("crafty"!==p||!q.trim())return void ye([]);const e=q.trim().split("/").pop();if(!e||!/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(e))return console.warn("Invalid form URL or missing ID"),void ye([]);xe(!0),(async()=>{const{data:t,error:n}=await zr.from("form_schemas").select("schema").eq("id",e).single();if(n||null===t||void 0===t||!t.schema)return console.error("Error loading schema:",n),ye([]),void xe(!1);try{const e=t.schema,n={...e.properties||{}};(e.allOf||[]).forEach((e=>{var t;null!==(t=e.then)&&void 0!==t&&t.properties&&Object.assign(n,e.then.properties)}));const r=Object.entries(n).map((e=>{let[t,n]=e;return{key:t,title:n.title||t,type:n.type,options:Array.isArray(n.enum)?n.enum:void 0}}));ye(r)}catch(r){console.error("Error parsing schema JSON:",r),ye([])}xe(!1)})()}),[q,p]),(0,r.useEffect)((()=>{"add"===i&&e&&Fr.from("steps").select("step_id,sequence_id").eq("process_id",e).then((e=>{let{data:t}=e;t&&t.length&&(g(Math.max(...t.map((e=>e.step_id||0)))+1),y(Math.max(...t.map((e=>e.sequence_id||0)))+1))}))}),[i,e]),(0,r.useEffect)((()=>{"edit"===i&&e&&Fr.from("steps").select("*").eq("process_id",e).eq("step_id",o).eq("sequence_id",l).single().then((e=>{let{data:t}=e;if(t)if(x(t.name||""),_(null!=t.tat_value?String(t.tat_value):""),S(t.tat_unit||"hrs"),C(t.dependencies&&t.dependencies[0]||""),T(t.responsibility||""),f(t.step_type||"status"),t.statuses&&F(t.statuses),t.checklists&&M(t.checklists),t.checklistActionMapping&&U(t.checklistActionMapping),t.form_url&&W(t.form_url),t.craftyActionMapping&&V(t.craftyActionMapping),t.scheduled_at){const e=new Date(t.scheduled_at).toISOString().slice(0,16);N("scheduled"),I(e)}else t.started_at&&N("immediate")}))}),[i,e,o,l]),(0,r.useEffect)((()=>{e&&Fr.from("processes").select("responsibility").eq("id",e).single().then((e=>{let{data:t}=e;t&&t.responsibility&&(P(t.responsibility),T(t.responsibility))}))}),[e]),(0,r.useEffect)((()=>{e&&Fr.from("steps").select("id, step_id, sequence_id, name, created_at, dependencies").eq("process_id",e).order("sequence_id",{ascending:!0}).then((e=>{let{data:t}=e;t&&Me(t)}))}),[e]),(0,r.useEffect)((()=>{e&&(We(!0),Fr.from("forms").select("selected_fields").eq("process_id",e).single().then((e=>{let{data:t,error:n}=e;null!==t&&void 0!==t&&t.selected_fields&&Ue(t.selected_fields)})).then((()=>{We(!1)})))}),[e]),(0,r.useEffect)((()=>{Fr.from("steps").select("alerts").then((e=>{let{data:t,error:n}=e;if(t&&!n){const e=t.flatMap((e=>(e.alerts||[]).filter((e=>e.email&&(Array.isArray(e.type)?e.type.includes("email")||e.type.includes("whatsapp"):"email"===e.type||"whatsapp"===e.type))).map((e=>e.email))));ae(Array.from(new Set(e)))}}))}),[]);const Ge=Oe.find((t=>t.id===e)),Qe=(Ge?Ge.steps.filter((e=>e.sequence_id<v)).sort(((e,t)=>t.sequence_id-e.sequence_id)):[])[0],Ye=()=>{M((e=>[...e,{text:"",isChecked:!1}]))},Xe=e=>{"Enter"===e.key&&(e.preventDefault(),Ye())},Ze=async function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!e)return void alert("Missing flowchartId");const{data:{session:r}}=await Fr.auth.getSession();if(null===r||void 0===r||!r.user)return void alert("Not authenticated");const i=r.user.id,s=D.map((e=>e.nextStep?{...e,nextStepId:m+1,nextSequenceId:v+1}:e)),a={process_id:e,step_id:m,sequence_id:v,name:b||null,tat_value:w?parseInt(w,10):null,tat_unit:k,dependencies:j?[j]:[],responsibility:E||null,is_draft:t,user_id:i,step_type:p,started_at:"immediate"===O?Ke():null,scheduled_at:"scheduled"===O?Ke(new Date($)):null,statuses:"status"===p?s:void 0,checklists:"checklist"===p?z:void 0,checklistActionMapping:"checklist"===p?B:void 0,form_url:"crafty"===p?q.trim():void 0,crafty_action_mapping:"crafty"===p?H:void 0,field_action_mapping:we,option_action_mapping:$e,alerts:J.map((e=>{var t;return{statusName:e.statusName,type:e.type,email:e.email,template:e.template,buttons:(null===(t=e.buttons)||void 0===t?void 0:t.map((e=>({title:e.title,reply:e.reply}))))||[],fieldKey:e.fieldKey||null}})),reminders:G,is_timer_enabled:re},o={id:"temp",step_id:m,sequence_id:v,name:b,created_at:Ke(),dependencies:j?[j]:[]},l=function(e,t){var n;const r=[...t].sort(((e,t)=>e.sequence_id-t.sequence_id)),i=r.findIndex((t=>t.sequence_id===e.sequence_id)),s=r.length,a=i>=0&&i<s-1?1:0,o=i>=0?s-i-1:0,l=[];for(let g=i;g>=0;g--)l.push(r[g].name);const u=l.join(" \u203a "),c=u,d=l.length>0?l.length-1:0,h=(null===(n=r[0])||void 0===n?void 0:n.name)||"",p=i>0?Math.floor((new Date(e.created_at).getTime()-new Date(r[i-1].created_at).getTime())/864e5):0,f=i>=0?Math.floor((new Date(e.created_at).getTime()-new Date(r[0].created_at).getTime())/864e5):0,m=`${e.name} has ${a} direct children and ${o} total descendants. It is ${d} step(s) from ${h}.`;return{step:e.name,dependentOn:i>0?r[i-1].name:null,date:e.created_at,directChildren:a,descendants:o,ancestors:d,root:h,chainOfReference:u,chainOfReferenceWithCycles:c,daysSinceReferrerJoined:p,daysFromRoot:f,inWords:m,getRoot:h,isRoot:0===i}}(o,[...ze,o].sort(((e,t)=>e.sequence_id-t.sequence_id)));console.log("\u23f3 STEP PAYLOAD:",a);const{data:u,error:c}=await Fr.from("steps").select("id").eq("process_id",e).eq("step_id",m).eq("sequence_id",v).single();if(c&&"PGRST116"!==c.code)return void alert(`Error checking existing step: ${c.message}`);let d;if(d=null!==u&&void 0!==u&&u.id?await Fr.from("steps").update(a).eq("id",u.id).select("*"):await Fr.from("steps").insert(a).select("*"),console.log("\u2705 DATABASE RESULT:",d),d.error)return void alert(`Error saving step: ${d.error.message}`);const h=Array.isArray(d.data)?d.data[0]:d.data;await Fr.from("logs").insert({event_type:null!==u&&void 0!==u&&u.id?"step_update":"step_create",details:JSON.stringify({processId:e,stepId:m,sequenceId:v,dbRowId:null===h||void 0===h?void 0:h.id,userId:r.user.id,responsibility:E||null,isDraft:t,tatValue:a.tat_value,tatUnit:a.tat_unit,stepType:a.step_type,timestamp:Ke()}),created_at:Ke()}),await Fr.from("step_flow_overviews").upsert({process_id:e,step_id:m,sequence_id:v,overview:l}),alert("Step saved successfully, and overview stored separately!"),n(-1)};return(0,Mr.jsxs)("div",{style:{maxWidth:600,margin:"auto",padding:16,fontFamily:"Arial, sans-serif"},children:[(0,Mr.jsxs)("div",{style:{marginBottom:16},children:[(0,Mr.jsx)("button",{onClick:()=>n(-1),style:{marginRight:8},children:"\u2190"}),(0,Mr.jsx)("strong",{style:{fontSize:18},children:"edit"===i?"Edit Step":"Add New Step"})]}),(0,Mr.jsxs)("div",{style:u,children:[(0,Mr.jsxs)("div",{style:{flex:1},children:[(0,Mr.jsx)("label",{style:c,children:"Step Name"}),(0,Mr.jsx)("input",{style:d,value:b,onChange:e=>x(e.target.value)})]}),(0,Mr.jsxs)("div",{style:{flex:1},children:[(0,Mr.jsx)("label",{style:c,children:"Responsibility"}),R?(0,Mr.jsx)("input",{style:{...d,background:"#f5f5f5"},value:R,readOnly:!0}):(0,Mr.jsxs)(Mr.Fragment,{children:[(0,Mr.jsx)("input",{style:d,value:E,onChange:e=>{return t=e.target.value,T(t),window.clearTimeout(ge.current),void(ge.current=window.setTimeout((async()=>{if(!t)return void me([]);const{data:e,error:n}=await Fr.from("steps").select("responsibility").ilike("responsibility",`${t}%`).limit(10);if(!n&&e){const t=Array.from(new Set(e.map((e=>e.responsibility)).filter((e=>"string"===typeof e))));me(t)}}),300));var t},placeholder:"E.g. team-member@example.com",list:"email-suggestions"}),(0,Mr.jsx)("datalist",{id:"email-suggestions",children:fe.map((e=>(0,Mr.jsx)("option",{value:e},e)))})]})]})]}),(0,Mr.jsxs)("div",{style:u,children:[(0,Mr.jsxs)("div",{style:{flex:2},children:[(0,Mr.jsx)("label",{style:c,children:"TAT"}),(0,Mr.jsx)("input",{style:d,type:"number",value:w,onChange:e=>_(e.target.value)})]}),(0,Mr.jsxs)("div",{style:{flex:1},children:[(0,Mr.jsx)("label",{style:c,children:"Units"}),(0,Mr.jsxs)("select",{style:d,value:k,onChange:e=>S(e.target.value),children:[(0,Mr.jsx)("option",{value:"mins",children:"mins"}),(0,Mr.jsx)("option",{value:"hrs",children:"hrs"}),(0,Mr.jsx)("option",{value:"days",children:"days"}),(0,Mr.jsx)("option",{value:"weeks",children:"weeks"})]})]})]}),(0,Mr.jsxs)("div",{style:u,children:[(0,Mr.jsxs)("div",{style:{flex:1},children:[(0,Mr.jsx)("label",{style:c,children:"Dependency"}),Qe?(0,Mr.jsx)("input",{style:{...d,background:"#f5f5f5"},readOnly:!0,value:`Step ${Qe.step_id}: ${Qe.name}`}):(0,Mr.jsx)("input",{style:{...d,background:"#f5f5f5"},readOnly:!0,placeholder:"(no previous step)"})]}),(0,Mr.jsxs)("div",{style:{flex:1},children:[(0,Mr.jsx)("label",{style:c,children:"Step ID"}),(0,Mr.jsx)("input",{style:d,value:m,readOnly:!0})]}),(0,Mr.jsxs)("div",{style:{flex:1},children:[(0,Mr.jsx)("label",{style:c,children:"Sequence ID"}),(0,Mr.jsx)("input",{style:d,value:v,readOnly:!0})]})]}),(0,Mr.jsxs)("div",{style:{marginTop:16},children:[(0,Mr.jsx)("label",{style:c,children:"Step Type"}),(0,Mr.jsxs)("select",{style:d,value:p,onChange:e=>f(e.target.value),children:[(0,Mr.jsx)("option",{value:"status",children:"Status"}),(0,Mr.jsx)("option",{value:"checklist",children:"Checklist"}),(0,Mr.jsx)("option",{value:"crafty",children:"Crafty Form"})]})]}),(0,Mr.jsx)("div",{style:{marginTop:16},children:(0,Mr.jsxs)("label",{style:c,children:[(0,Mr.jsx)("input",{type:"checkbox",checked:re,onChange:e=>ie(e.target.checked)})," Enable Timer for this step"]})}),(0,Mr.jsxs)("div",{style:h,children:[(0,Mr.jsx)("label",{style:c,children:"When step gets start"}),(0,Mr.jsxs)("label",{style:{marginRight:16},children:[(0,Mr.jsx)("input",{type:"radio",checked:"immediate"===O,onChange:()=>N("immediate")})," ","Immediate"]}),(0,Mr.jsxs)("label",{children:[(0,Mr.jsx)("input",{type:"radio",checked:"scheduled"===O,onChange:()=>N("scheduled")})," ","Schedule"]}),"scheduled"===O&&(0,Mr.jsxs)(Mr.Fragment,{children:[(0,Mr.jsx)("label",{style:c,children:"Select date & time"}),(0,Mr.jsx)("input",{style:d,type:"datetime-local",value:$,onChange:e=>I(e.target.value)})]})]}),"status"===p&&(0,Mr.jsxs)("div",{style:h,children:[(0,Mr.jsx)("h4",{children:"Statuses"}),(0,Mr.jsxs)("div",{style:{marginBottom:12},children:[(0,Mr.jsx)("label",{style:c,children:"Input Type"}),(0,Mr.jsxs)("select",{style:d,value:A,onChange:e=>L(e.target.value),children:[(0,Mr.jsx)("option",{value:"dropdown",children:"Dropdown"}),(0,Mr.jsx)("option",{value:"radio",children:"Radio"}),(0,Mr.jsx)("option",{value:"button",children:"Button"})]})]}),D.map(((e,t)=>{var n;return(0,Mr.jsxs)("div",{style:{marginBottom:16,position:"relative"},children:[(0,Mr.jsx)("button",{onClick:()=>{const e=[...D];e.splice(t,1),F(e)},style:{position:"absolute",top:40,right:0,background:"transparent",border:"none",fontSize:"1rem",cursor:"pointer",color:"#900"},"aria-label":"Remove this status",children:"\u2715"}),(0,Mr.jsxs)("div",{style:u,children:[(0,Mr.jsx)("input",{style:{...d,marginRight:8},placeholder:"Option name",value:e.optionName,onChange:e=>{const n=[...D];n[t].optionName=e.target.value,F(n)}}),(0,Mr.jsxs)("select",{style:d,value:e.actionMapping,onChange:e=>((e,t)=>{const n=[...D];n[e].actionMapping=t,n[e].nextStep="next"===t,n[e].split="split"===t,F(n)})(t,e.target.value),children:[(0,Mr.jsx)("option",{value:"",children:"--Action--"}),(0,Mr.jsx)("option",{value:"next",children:"Next Step"}),(0,Mr.jsx)("option",{value:"stop",children:"Stop Here"}),(0,Mr.jsx)("option",{value:"split",children:"Split/Progress"})]})]}),e.split&&(0,Mr.jsxs)("div",{style:{marginTop:8,padding:8,background:"#f9f9f9"},children:[(0,Mr.jsx)("label",{style:c,children:"Process"}),(0,Mr.jsxs)("select",{style:d,value:Y[t]||"",onChange:e=>((e,t)=>{X((n=>({...n,[e]:t}))),ne((t=>({...t,[e]:""})))})(t,e.target.value),children:[(0,Mr.jsx)("option",{value:"",children:"--Select--"}),Oe.map((e=>(0,Mr.jsx)("option",{value:e.id,children:e.name},e.id)))]}),Y[t]&&(0,Mr.jsxs)(Mr.Fragment,{children:[(0,Mr.jsx)("label",{style:c,children:"Step"}),(0,Mr.jsxs)("select",{style:d,value:Z[t]||"",onChange:e=>((e,t)=>{ne((n=>({...n,[e]:t})));const n=Oe.find((t=>t.id===Y[e])),r=null===n||void 0===n?void 0:n.steps.find((e=>e.id===t));if(r&&n){const t=`Step: ${r.name} in ${n.name}`,i=[...D];i[e].splitTarget=t,F(i)}})(t,e.target.value),children:[(0,Mr.jsx)("option",{value:"",children:"--Select--"}),null===(n=Oe.find((e=>e.id===Y[t])))||void 0===n?void 0:n.steps.map((e=>(0,Mr.jsx)("option",{value:e.id,children:e.name},e.id)))]})]})]})]},t)})),(0,Mr.jsx)("button",{onClick:()=>{F((e=>[...e,{statusName:"",inputType:A,optionName:"",actionMapping:"",nextStep:!1,split:!1,alertEmail:"",alertTemplate:"",buttons:[]}]))},children:"+ Add Status"})]}),"status"===p&&(0,Mr.jsxs)("div",{style:h,children:[(0,Mr.jsx)("h4",{children:"Alerts"}),J.map(((e,t)=>{var n;return(0,Mr.jsxs)("div",{style:{marginBottom:16,padding:12,border:"1px solid #ddd",borderRadius:4,position:"relative"},children:[(0,Mr.jsxs)("div",{style:{marginBottom:8,display:"flex",gap:12},children:[(0,Mr.jsxs)("label",{style:c,children:[(0,Mr.jsx)("input",{type:"checkbox",checked:e.type.includes("email"),onChange:e=>{const n=[...J];n[t].type=e.target.checked?[...n[t].type,"email"]:n[t].type.filter((e=>"email"!==e)),K(n)}})," Email"]}),(0,Mr.jsxs)("label",{style:c,children:[(0,Mr.jsx)("input",{type:"checkbox",checked:e.type.includes("whatsapp"),onChange:e=>{const n=[...J];if(e.target.checked){if(!Jr())return K((e=>e.map(((e,n)=>n===t?{...e,type:e.type.filter((e=>"whatsapp"!==e))}:e))))}n[t].type=e.target.checked?[...n[t].type,"whatsapp"]:n[t].type.filter((e=>"whatsapp"!==e)),K(n)}})," WhatsApp"]})]}),(0,Mr.jsx)("button",{onClick:()=>K((e=>{const n=[...e];return n.splice(t,1),n})),style:{position:"absolute",top:8,right:8,border:"none",background:"transparent",cursor:"pointer",color:"#900",fontSize:"1.2rem"},"aria-label":"Remove this alert",children:"\u274c"}),(0,Mr.jsxs)("div",{style:{marginBottom:8},children:[(0,Mr.jsx)("label",{style:c,children:"Status"}),(0,Mr.jsxs)("select",{style:d,value:e.statusName,onChange:e=>{const n=[...J];n[t].statusName=e.target.value,K(n)},children:[(0,Mr.jsx)("option",{value:"",children:"-- Select Status --"}),D.map((e=>(0,Mr.jsx)("option",{value:e.optionName,children:e.optionName},e.optionName)))]})]}),(0,Mr.jsxs)("div",{style:{marginBottom:8},children:[(0,Mr.jsx)("label",{style:c,children:1===e.type.length&&e.type.includes("email")?"Alert Email":1===e.type.length&&e.type.includes("whatsapp")?"WhatsApp Number":"Target (Email / Number)"}),(0,Mr.jsx)("input",{style:d,type:"text",list:"alert-email-suggestions",value:e.email,onChange:e=>{return n=e.target.value,r=t,K((e=>{const t=[...e];return t[r].email=n,t})),window.clearTimeout(ue.current),void(ue.current=window.setTimeout((()=>{const e=n.split(","),t=e[e.length-1].trim().toLowerCase();if(!t)return void le([]);const r=se.filter((e=>e.toLowerCase().startsWith(t)));le(r)}),200));var n,r},placeholder:1===e.type.length&&e.type.includes("email")?"user@gmail.com,bar@gmail.com":1===e.type.length&&e.type.includes("whatsapp")?"+919876543210,+14155552671":"user@gmail.com,+919876543210"}),(0,Mr.jsx)("datalist",{id:"alert-email-suggestions",children:oe.map((e=>(0,Mr.jsx)("option",{value:e},e)))})]}),(0,Mr.jsxs)("div",{children:[(0,Mr.jsx)("label",{style:c,children:"Message Template"}),(0,Mr.jsxs)("div",{style:{position:"relative"},children:[(0,Mr.jsx)("textarea",{ref:e=>{He.current[t]=e},style:{...d,height:60},value:e.template,onChange:e=>{const n=[...J];n[t].template=e.target.value,K(n)},placeholder:"Type your message\u2026",onKeyUp:e=>{if("{"===e.key&&He.current[t]){const e=He.current[t],n=e.selectionStart,{top:r,left:i}=Vr(e,n);Je({top:r+4,left:i+4});const s=[...J];s[t].showFieldDropdown=!0,K(s)}}}),e.showFieldDropdown&&He.current[t]&&(0,Mr.jsxs)("select",{size:3,style:{position:"absolute",top:Ve.top,left:Ve.left,...d,maxHeight:"6em",overflowY:"auto"},onChange:e=>{const n=e.target.value,r=[...J];r[t].template=r[t].template.replace(/\{$/,`{${n}}`),r[t].showFieldDropdown=!1,K(r)},children:[(0,Mr.jsx)("option",{value:"",children:"-- Select Field --"}),Be.map((e=>(0,Mr.jsx)("option",{value:e,children:e},e)))]}),(0,Mr.jsx)("label",{className:"block mt-2 font-medium",children:"Buttons & Replies:"}),null===(n=e.buttons)||void 0===n?void 0:n.map(((e,n)=>(0,Mr.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,Mr.jsx)("input",{type:"text",value:e.title,onChange:e=>{const r=[...J];r[t].buttons[n].title=e.target.value,K(r)},placeholder:"Button title",className:"flex-1 border rounded px-2 py-1"}),(0,Mr.jsx)("input",{type:"text",value:e.reply,onChange:e=>{const r=[...J];r[t].buttons[n].reply=e.target.value,K(r)},placeholder:"Reply message",className:"flex-1 border rounded px-2 py-1"}),(0,Mr.jsx)("button",{type:"button",onClick:()=>{const e=[...J];e[t].buttons.splice(n,1),K(e)},className:"text-red-500",children:"Remove"})]},n))),(0,Mr.jsx)("button",{type:"button",onClick:()=>{const e=[...J];e[t].buttons=[...e[t].buttons||[],{title:"",reply:""}],K(e)},className:"mt-2 text-blue-600",children:"+ Add Button"})]})]})]},t)})),(0,Mr.jsx)("button",{onClick:()=>K((e=>[...e,{statusName:"",type:["email"],email:"",template:""}])),children:"+ Add Alert"})]}),"crafty"===p&&(0,Mr.jsxs)("div",{style:h,children:[(0,Mr.jsx)("h4",{children:"Crafty Form"}),(0,Mr.jsx)("button",{onClick:()=>window.open("https://nimble-phoenix-504247.netlify.app/","_blank"),children:"Open Crafty Builder"}),(0,Mr.jsxs)("div",{style:{marginTop:16},children:[(0,Mr.jsx)("label",{style:c,children:"Form URL"}),(0,Mr.jsx)("input",{style:d,value:q,onChange:e=>W(e.target.value),placeholder:"Paste form URL here"})]}),(0,Mr.jsxs)("div",{style:{marginTop:16},children:[(0,Mr.jsx)("label",{style:c,children:"On Submit Action"}),(0,Mr.jsxs)("select",{style:d,value:H,onChange:e=>V(e.target.value),children:[(0,Mr.jsx)("option",{value:"",children:"--Select--"}),(0,Mr.jsx)("option",{value:"next",children:"Next Step"}),(0,Mr.jsx)("option",{value:"stop",children:"Stop Here"}),(0,Mr.jsx)("option",{value:"split",children:"Split/Progress"}),(0,Mr.jsx)("option",{value:"nextForm",children:"Next Form"})]})]})]}),"crafty"===p&&(0,Mr.jsxs)("div",{style:h,children:[(0,Mr.jsx)("h4",{children:"Field & Option Action Mappings"}),be?(0,Mr.jsx)("p",{children:"Loading form schema\u2026"}):0===ve.length?(0,Mr.jsx)("p",{children:"No schema loaded. Paste a valid Crafty URL above."}):ve.map((e=>{var t,n;return(0,Mr.jsxs)("div",{style:{marginBottom:16},children:[(0,Mr.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:8},children:[(0,Mr.jsx)("strong",{style:{flex:2},children:e.title}),(0,Mr.jsxs)("select",{style:{flex:1,...d},value:we[e.key]||"",onChange:t=>{return n=e.key,r=t.target.value,_e((e=>({...e,[n]:r}))),void Se((e=>({...e,[n]:"split"===r})));var n,r},children:[(0,Mr.jsx)("option",{value:"",children:"(use default)"}),(0,Mr.jsx)("option",{value:"next",children:"Next Step"}),(0,Mr.jsx)("option",{value:"stop",children:"Stop Here"}),(0,Mr.jsx)("option",{value:"split",children:"Split/Progress"})]})]}),"split"===we[e.key]&&(0,Mr.jsxs)("div",{style:{marginLeft:24,marginBottom:8,padding:8,background:"#f9f9f9"},children:[(0,Mr.jsx)("label",{style:c,children:"Process"}),(0,Mr.jsxs)("select",{style:d,value:je[e.key]||"",onChange:t=>{return n=e.key,r=t.target.value,Ce((e=>({...e,[n]:r}))),void Te((e=>({...e,[n]:""})));var n,r},children:[(0,Mr.jsx)("option",{value:"",children:"--Select--"}),Oe.map((e=>(0,Mr.jsx)("option",{value:e.id,children:e.name},e.id)))]}),je[e.key]&&(0,Mr.jsxs)(Mr.Fragment,{children:[(0,Mr.jsx)("label",{style:c,children:"Step"}),(0,Mr.jsxs)("select",{style:d,value:Ee[e.key]||"",onChange:t=>{return n=e.key,r=t.target.value,void Te((e=>({...e,[n]:r})));var n,r},children:[(0,Mr.jsx)("option",{value:"",children:"--Select--"}),null===(t=Oe.find((t=>t.id===je[e.key])))||void 0===t?void 0:t.steps.map((e=>(0,Mr.jsx)("option",{value:e.id,children:e.name},e.id)))]})]})]}),null===(n=e.options)||void 0===n?void 0:n.map((t=>{var n,r,i,s,a;const o=null===(n=$e[e.key])||void 0===n?void 0:n[t],l=(null===o||void 0===o?void 0:o.action)||"";return(0,Mr.jsxs)("div",{style:{marginLeft:24,marginBottom:16},children:[(0,Mr.jsx)("span",{style:{flex:2},children:t}),(0,Mr.jsxs)("select",{style:d,value:l,onChange:n=>((e,t,n)=>{Ie((r=>{var i,s;return{...r,[e]:{...r[e]||{},[t]:"split"===n?{action:"split",target:(null===(i=r[e])||void 0===i||null===(s=i[t])||void 0===s?void 0:s.target)||""}:{action:n}}}}))})(e.key,t,n.target.value),children:[(0,Mr.jsx)("option",{value:"",children:"(use default)"}),(0,Mr.jsx)("option",{value:"next",children:"Next Step"}),(0,Mr.jsx)("option",{value:"stop",children:"Stop Here"}),(0,Mr.jsx)("option",{value:"split",children:"Split/Progress"})]}),"split"===l&&(0,Mr.jsxs)("div",{style:{marginLeft:16,marginTop:8,padding:8,background:"#f1f1f1"},children:[(0,Mr.jsx)("label",{style:c,children:"Process"}),(0,Mr.jsxs)("select",{style:d,value:(null===(r=Ae[e.key])||void 0===r?void 0:r[t])||"",onChange:n=>((e,t,n)=>{Le((r=>({...r,[e]:{...r[e]||{},[t]:n}}))),Fe((n=>({...n,[e]:{...n[e]||{},[t]:""}})))})(e.key,t,n.target.value),children:[(0,Mr.jsx)("option",{value:"",children:"--Select--"}),Oe.map((e=>(0,Mr.jsx)("option",{value:e.id,children:e.name},e.id)))]}),(null===(i=Ae[e.key])||void 0===i?void 0:i[t])&&(0,Mr.jsxs)(Mr.Fragment,{children:[(0,Mr.jsx)("label",{style:c,children:"Step"}),(0,Mr.jsxs)("select",{style:d,value:(null===(s=De[e.key])||void 0===s?void 0:s[t])||"",onChange:n=>((e,t,n)=>{var r;const i=null===(r=Ae[e])||void 0===r?void 0:r[t];if(!i)return;const s=Oe.find((e=>e.id===i)),a=null===s||void 0===s?void 0:s.steps.find((e=>e.id===n));if(!s||!a)return;const o=`Step: ${a.name} in ${s.name}`;Ie((n=>({...n,[e]:{...n[e]||{},[t]:{action:"split",target:o}}}))),Fe((r=>({...r,[e]:{...r[e]||{},[t]:n}})))})(e.key,t,n.target.value),children:[(0,Mr.jsx)("option",{value:"",children:"--Select--"}),null===(a=Oe.find((n=>{var r;return n.id===(null===(r=Ae[e.key])||void 0===r?void 0:r[t])})))||void 0===a?void 0:a.steps.map((e=>(0,Mr.jsx)("option",{value:e.id,children:e.name},e.id)))]})]})]})]},t)}))]},e.key)}))]}),"checklist"===p&&(0,Mr.jsxs)("div",{style:h,children:[(0,Mr.jsx)("h4",{children:"Checklist"}),z.map(((e,t)=>(0,Mr.jsx)("div",{style:{marginBottom:12},children:(0,Mr.jsx)("input",{style:d,placeholder:"Item",value:e.text,onChange:e=>{const n=[...z];n[t].text=e.target.value,M(n)},onKeyDown:Xe})},t))),(0,Mr.jsx)("button",{onClick:Ye,children:"+ Add Item"}),(0,Mr.jsxs)("div",{style:{marginTop:16},children:[(0,Mr.jsx)("label",{style:c,children:"On Complete Action"}),(0,Mr.jsxs)("select",{style:d,value:B,onChange:e=>U(e.target.value),children:[(0,Mr.jsx)("option",{value:"",children:"--Select--"}),(0,Mr.jsx)("option",{value:"next",children:"Next Step"}),(0,Mr.jsx)("option",{value:"stop",children:"Stop Here"}),(0,Mr.jsx)("option",{value:"split",children:"Split/Progress"})]})]})]}),(0,Mr.jsx)("div",{style:{marginTop:16},children:(0,Mr.jsx)(Hr,{reminders:G,setReminders:Q})}),(0,Mr.jsxs)("div",{style:{marginTop:24,display:"flex",gap:8},children:[(0,Mr.jsx)("button",{onClick:()=>Ze(!1),children:"edit"===i?"Update Step":"Save Step"}),(0,Mr.jsx)("button",{onClick:()=>Ze(!0),children:"Save as Draft"})]})]})}function Gr(){const{processId:e}=te(),t=ee(),[n,i]=(0,r.useState)([]),[s,a]=(0,r.useState)(!0),[o,l]=(0,r.useState)(null);(0,r.useEffect)((()=>{e&&u(e)}),[e]);const u=async e=>{a(!0);const{data:t,error:n}=await Fr.from("steps").select("\n        step_id,\n        sequence_id,\n        name,\n        tat_value,\n        responsibility\n      ").eq("process_id",e).order("sequence_id",{ascending:!0});if(n)return console.error("Error fetching steps:",n),i([]),void a(!1);if(!t)return i([]),void a(!1);const r=t.map((e=>({isNew:!1,stepId:e.step_id||0,sequenceId:e.sequence_id||0,stepName:e.name||"",tat:null!=e.tat_value?String(e.tat_value):"",responsibility:e.responsibility||""})));i(r),a(!1)};return s?(0,Mr.jsx)("div",{style:{padding:"24px"},children:"Loading existing steps..."}):(0,Mr.jsxs)("div",{style:{padding:"24px",fontFamily:"sans-serif"},children:[(0,Mr.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:"16px"},children:[(0,Mr.jsxs)("h2",{style:{margin:0},children:["Bulk Edit for Process ",e]}),(0,Mr.jsxs)("div",{style:{marginLeft:"auto"},children:[(0,Mr.jsx)("button",{onClick:async()=>{if(!e)return void alert("No processId in URL, cannot save.");let r=[...n].sort(((e,t)=>e.sequenceId-t.sequenceId));for(let e=0;e<r.length;e++)r[e].sequenceId=e+1;i(r);const s=r.filter((e=>e.isNew));for(const t of s){if(!t.stepName.trim())continue;const{error:n}=await Fr.from("steps").insert([{process_id:e,step_id:t.stepId,sequence_id:t.sequenceId,name:t.stepName,tat_value:t.tat?parseInt(t.tat):null,responsibility:t.responsibility}]);if(n)return void alert("Error inserting step: "+n.message)}alert("All new steps added!"),t(`/process/${e}/steps`)},style:{marginRight:"8px",backgroundColor:"#3b82f6",color:"#fff",padding:"8px 16px",borderRadius:"4px",border:"none",cursor:"pointer"},children:"Save All"}),(0,Mr.jsx)("button",{onClick:()=>t(-1),style:{backgroundColor:"#eee",color:"#333",padding:"8px 16px",borderRadius:"4px",border:"none",cursor:"pointer"},children:"Cancel"})]})]}),n.map(((r,s)=>{const{isNew:a,stepId:u,sequenceId:c,tat:d,stepName:h,responsibility:p}=r;return(0,Mr.jsxs)("div",{style:{marginBottom:"16px"},children:[(0,Mr.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,Mr.jsxs)("div",{style:{marginRight:"16px",textAlign:"center",fontSize:"0.85rem",color:"#888",width:"50px"},children:[(0,Mr.jsxs)("div",{children:["#",u]}),(0,Mr.jsxs)("div",{children:["#",c]})]}),(0,Mr.jsxs)("div",{style:{position:"relative",flex:1,display:"flex",alignItems:"center",justifyContent:"space-between",border:"1px solid #ccc",borderRadius:"8px",padding:"16px",backgroundColor:"#f5f5f5"},children:[(0,Mr.jsxs)("div",{children:[(0,Mr.jsxs)("div",{style:{fontWeight:"bold",marginBottom:"4px"},children:[d," hrs"]}),(0,Mr.jsx)("div",{style:{marginBottom:"4px"},children:h}),(0,Mr.jsxs)("div",{style:{fontSize:"0.9rem",color:"#666"},children:["Responsibility: ",p]})]}),(0,Mr.jsxs)("div",{style:{textAlign:"right",fontSize:"0.85rem",color:"#666"},children:[3," statuses | ",4," alerts | ",12," reminders"]}),(0,Mr.jsx)("div",{style:{marginLeft:"16px"},children:(0,Mr.jsx)("button",{onClick:()=>(r=>{const i=n[r],s=i.stepId+1,a=i.sequenceId;t(`/process/${e}/add-step?stepId=${s}&sequenceId=${a}&mode=parallel`)})(s),style:{backgroundColor:"#eee",border:"none",borderRadius:"50%",width:"32px",height:"32px",cursor:"pointer",fontSize:"1.2rem",lineHeight:"32px"},children:"+"})}),(0,Mr.jsxs)("div",{style:{marginLeft:"16px",position:"relative"},children:[(0,Mr.jsx)("span",{style:{cursor:"pointer",fontSize:"1.2rem",padding:"0 6px"},onClick:()=>(e=>{l((t=>t===e?null:e))})(s),children:"\u22ee"}),o===s&&(0,Mr.jsxs)("div",{style:{position:"absolute",top:"40px",right:0,background:"#fff",border:"1px solid #ccc",borderRadius:"4px",zIndex:2},children:[(0,Mr.jsx)("div",{style:{padding:"8px",cursor:"pointer"},onClick:()=>{(r=>{const i=n[r];t(`/process/${e}/add-step?stepId=${i.stepId}&sequenceId=${i.sequenceId}&mode=edit`)})(s),l(null)},children:"Edit"}),(0,Mr.jsx)("div",{style:{padding:"8px",cursor:"pointer",color:"red"},onClick:()=>{(async t=>{const r=n[t];if(!e)return;if(r.isNew){const e=[...n];return e.splice(t,1),void i(e)}if(!window.confirm(`Are you sure you want to delete step "${r.stepName}"?`))return;const{error:s}=await Fr.from("steps").delete().eq("process_id",e).eq("step_id",r.stepId).eq("sequence_id",r.sequenceId);if(s)return void alert("Error deleting step: "+s.message);const a=[...n];a.splice(t,1),i(a)})(s),l(null)},children:"Delete"})]})]})]})]}),(0,Mr.jsx)("div",{style:{marginLeft:"66px",marginTop:"4px"},children:(0,Mr.jsx)("button",{onClick:()=>(r=>{const i=n[r],s=i.stepId+1,a=i.sequenceId+1;t(`/process/${e}/add-step?stepId=${s}&sequenceId=${a}&mode=below`)})(s),style:{backgroundColor:"#eee",border:"none",borderRadius:"50%",width:"32px",height:"32px",cursor:"pointer",fontSize:"1.2rem",lineHeight:"32px"},children:"+"})})]},`${u}-${c}-${s}`)}))]})}const Qr=e=>{let{enabled:t,createdAt:n,durationValue:i,durationUnit:s}=e;const[a,o]=(0,r.useState)(Date.now());if((0,r.useEffect)((()=>{if(!t)return;const e=setInterval((()=>o(Date.now())),1e3);return()=>clearInterval(e)}),[t]),!t||!n)return null;const l=(i||0)*{mins:60,hrs:3600,days:86400,weeks:604800}[s||"hrs"]*1e3,u=new Date(n).getTime()+l,c=Math.max(0,u-a),d=String(Math.floor(c/36e5)).padStart(2,"0"),h=String(Math.floor(c%36e5/6e4)).padStart(2,"0"),p=String(Math.floor(c%6e4/1e3)).padStart(2,"0");return(0,Mr.jsxs)("div",{style:{fontSize:"0.9rem",marginLeft:"0.5rem",color:"#c00"},children:["Time left: ",d,":",h,":",p]})},Yr=function(e){switch(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"hrs"){case"mins":return e/60;case"days":return 24*e;case"weeks":return 168*e;default:return e}};const Xr=()=>{const e=ee(),[t,n]=(0,r.useState)([]),[i,s]=(0,r.useState)(""),[a,o]=(0,r.useState)("none"),[l,u]=(0,r.useState)(!1),[c,d]=(0,r.useState)("none"),[h,p]=(0,r.useState)(!1),[f,m]=(0,r.useState)("all"),[g,v]=(0,r.useState)(!1),[y,b]=(0,r.useState)(null),[x,w]=(0,r.useState)(!1),[_,k]=(0,r.useState)(""),[S,j]=(0,r.useState)(""),[C,E]=(0,r.useState)(null),T=(0,r.useRef)(null),R=(0,r.useRef)(null),P=(0,r.useRef)(null),[O,N]=(0,r.useState)(new Set);(0,r.useEffect)((()=>{$()}),[]),(0,r.useEffect)((()=>{let e=null;Fr.auth.getSession().then((t=>{let{data:{session:n}}=t;if(null!==n&&void 0!==n&&n.user){e=n.user.id;const t=Fr.channel("realtime-steps").on("postgres_changes",{event:"INSERT",schema:"public",table:"steps",filter:`responsibility=eq.${n.user.email} AND is_completed=eq.false`},(e=>{console.log("New step inserted:",e),$()})).subscribe();return()=>{Fr.removeChannel(t)}}}))}),[]),(0,r.useEffect)((()=>{const e=e=>{g&&T.current&&!T.current.contains(e.target)&&v(!1)};return g&&document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)}),[g]),(0,r.useEffect)((()=>{const e=e=>{h&&R.current&&!R.current.contains(e.target)&&p(!1)};return h&&document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)}),[h]),(0,r.useEffect)((()=>{const e=e=>{l&&P.current&&!P.current.contains(e.target)&&u(!1)};return l&&document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)}),[l]);const $=async e=>{const{data:{session:t}}=await Fr.auth.getSession();if(null===t||void 0===t||!t.user)return void console.error("User not authenticated");const{data:r,error:i}=await Fr.from("steps").select("*, process:processes(name, ghost_mode)").eq("is_completed",!1).order("process_id",{ascending:!0}).order("sequence_id",{ascending:!0});if(i)return void console.error("Error fetching steps:",i);const s=r,{data:a,error:o}=await Fr.from("form_submissions").select("*");if(o)return void console.error("Error fetching submissions:",o);const{data:l,error:u}=await Fr.from("submission_statuses").select("*");u&&console.error("Error fetching submission statuses:",u);const c=new Map;null===l||void 0===l||l.forEach((e=>c.set(e.submission_id,e.statuses)));const d=new Map;null===a||void 0===a||a.forEach((e=>{var t,n;null===(t=s.find((t=>t.process_id===e.process_id)))||void 0===t||null===(n=t.process)||void 0===n||n.ghost_mode;d.has(e.process_id)?d.get(e.process_id).push(e):d.set(e.process_id,[e])}));const{data:h,error:p}=await Fr.from("forms").select("process_id, selected_fields");p&&console.error("Error fetching forms:",p);const f=new Map;null===h||void 0===h||h.forEach((e=>{e.process_id&&Array.isArray(e.selected_fields)&&f.set(e.process_id,e.selected_fields)}));const{data:m,error:g}=await Fr.from("submission_step_statuses").select("submission_id,step_id,completed_at");if(g)return void console.error("Error fetching completions:",g);const v=new Map;(m||[]).forEach((e=>{e.completed_at&&(v.has(e.submission_id)||v.set(e.submission_id,new Set),v.get(e.submission_id).add(e.step_id))}));const{data:y,error:b}=await Fr.from("submission_step_statuses").select("submission_id, step_id, started_at");b&&console.error("Error fetching start timestamps:",b);const x=new Map;null===y||void 0===y||y.forEach((e=>x.set(`${e.submission_id}_${e.step_id}`,e.started_at)));s.reduce(((e,t)=>(e.has(t.process_id)||e.set(t.process_id,t),e)),new Map);const w=[],_=t.user.email;let k=!1;null===a||void 0===a||a.forEach((e=>{var t,n;if(!e.process_id){if(k)return;k=!0}const r=v.get(e.id)||new Set,i=null===(t=s.find((t=>t.process_id===e.process_id)))||void 0===t||null===(n=t.process)||void 0===n?void 0:n.ghost_mode,a=s.filter((t=>t.process_id===e.process_id)).find((e=>{var t;if(r.has(e.id))return!1;const n=(null!==(t=e.sequence_id)&&void 0!==t?t:1)-1;if(n>0){const t=s.find((t=>t.process_id===e.process_id&&t.sequence_id===n));if(t&&!r.has(t.id))return!1}return!0}));if(i)s.filter((t=>t.process_id===e.process_id&&t.responsibility===_&&!r.has(t.id))).forEach((t=>{var n,r;const i=(null!==(n=t.sequence_id)&&void 0!==n?n:1)-1,o=s.find((e=>e.process_id===t.process_id&&e.sequence_id===i)),l=null!==(r=null===o||void 0===o?void 0:o.responsibility)&&void 0!==r?r:"someone",u=(t.statuses||[]).map((e=>({...e,selectedValue:e.selectedValue||"",selectedOptions:e.selectedOptions||[]})));e.data;w.push({startedAt:x.get(`${e.id}_${t.id}`),id:`${t.id}_${e.id}`,step:t,submission:e,statuses:c.get(e.id)||u,readOnly:t.id!==((null===a||void 0===a?void 0:a.id)||""),prevResponsible:l,formData:e.data||{}})}));else if(a&&a.responsibility===_){const t=(a.statuses||[]).map((e=>({...e,selectedValue:e.selectedValue||"",selectedOptions:e.selectedOptions||[]})));w.push({startedAt:x.get(`${e.id}_${a.id}`),id:`${a.id}_${e.id}`,step:a,submission:e,statuses:c.get(e.id)||t,formData:e.data||{},selectedFields:f.get(e.process_id)||[]})}})),n(w),await Fr.from("logs").insert({event_type:"fetch_steps",details:JSON.stringify({items:w.map((e=>({stepId:e.step.id,submissionId:e.submission.id,statuses:e.statuses})))}),created_at:(new Date).toISOString()})};let I=t.filter((e=>{var t;return null===(t=e.step.name)||void 0===t?void 0:t.toLowerCase().includes(i.toLowerCase())}));"lowTat"===f?I=I.filter((e=>{var t,n;return Yr(null!==(t=e.step.tat_value)&&void 0!==t?t:0,null!==(n=e.step.tat_unit)&&void 0!==n?n:"hrs")<10})):"highTat"===f&&(I=I.filter((e=>{var t,n;return Yr(null!==(t=e.step.tat_value)&&void 0!==t?t:0,null!==(n=e.step.tat_unit)&&void 0!==n?n:"hrs")>=10})));const A=[...I];"tatAsc"===c?A.sort(((e,t)=>{var n,r,i,s;return Yr(null!==(n=e.step.tat_value)&&void 0!==n?n:0,null!==(r=e.step.tat_unit)&&void 0!==r?r:"hrs")-Yr(null!==(i=t.step.tat_value)&&void 0!==i?i:0,null!==(s=t.step.tat_unit)&&void 0!==s?s:"hrs")})):"tatDesc"===c?A.sort(((e,t)=>{var n,r,i,s;return Yr(null!==(n=t.step.tat_value)&&void 0!==n?n:0,null!==(r=t.step.tat_unit)&&void 0!==r?r:"hrs")-Yr(null!==(i=e.step.tat_value)&&void 0!==i?i:0,null!==(s=e.step.tat_unit)&&void 0!==s?s:"hrs")})):"seqAsc"===c?A.sort(((e,t)=>{var n,r;return(null!==(n=e.step.sequence_id)&&void 0!==n?n:0)-(null!==(r=t.step.sequence_id)&&void 0!==r?r:0)})):"seqDesc"===c&&A.sort(((e,t)=>{var n,r;return(null!==(n=t.step.sequence_id)&&void 0!==n?n:0)-(null!==(r=e.step.sequence_id)&&void 0!==r?r:0)}));const L=function(e,t){switch(t){case"none":default:return[{groupKey:"All Items",items:e}];case"process":{const t=new Map;return e.forEach((e=>{var n;const r=(null===(n=e.step.process)||void 0===n?void 0:n.name)||"No Process Name";t.has(r)||t.set(r,[]),t.get(r).push(e)})),Array.from(t.entries()).map((e=>{let[t,n]=e;return{groupKey:t,items:n}})).sort(((e,t)=>e.groupKey.localeCompare(t.groupKey)))}case"dataPoints":{const t=new Map;return e.forEach((e=>{const n=null!=e.step.sequence_id?String(e.step.sequence_id):"No Sequence";t.has(n)||t.set(n,[]),t.get(n).push(e)})),Array.from(t.entries()).map((e=>{let[t,n]=e;return{groupKey:t,items:n}})).sort(((e,t)=>e.groupKey.localeCompare(t.groupKey)))}case"randomTasks":return[{groupKey:"Random Tasks",items:e.filter((e=>!e.step.process_id))}]}}(A,a),D=e=>{o(e),u(!1)},F=e=>{d(e),p(!1)},z=e=>{m(e),v(!1)},M=()=>{w(!1),k(""),j(""),E(null)};return(0,Mr.jsxs)("div",{style:{padding:"1rem"},children:[(0,Mr.jsx)("style",{children:"\n          .dropdown-item {\n            padding: 0.25rem 0.5rem;\n            cursor: pointer;\n            transition: background 0.2s;\n          }\n          .dropdown-item:hover {\n            background: #f0f0f0;\n          }\n        "}),(0,Mr.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:"1rem"},children:[(0,Mr.jsxs)("div",{style:{marginRight:"1rem",cursor:"pointer",position:"relative"},ref:T,children:[(0,Mr.jsx)("img",{src:"/Filter.png",alt:"Filter",style:{width:"24px",height:"24px"},onClick:()=>v((e=>!e))}),g&&(0,Mr.jsxs)("div",{style:{position:"absolute",top:"30px",left:0,background:"#fff",border:"1px solid #ccc",borderRadius:"4px",padding:"0.5rem",zIndex:2},children:[(0,Mr.jsx)("div",{className:"dropdown-item",onClick:()=>z("all"),children:"All Steps"}),(0,Mr.jsx)("div",{className:"dropdown-item",onClick:()=>z("lowTat"),children:"TAT < 10 hrs"}),(0,Mr.jsx)("div",{className:"dropdown-item",onClick:()=>z("highTat"),children:"TAT \u2265 10 hrs"})]})]}),(0,Mr.jsxs)("div",{style:{marginRight:"1rem",cursor:"pointer",position:"relative"},ref:R,children:[(0,Mr.jsx)("img",{src:"/Sort.png",alt:"Sort",style:{width:"24px",height:"24px"},onClick:()=>p((e=>!e))}),h&&(0,Mr.jsxs)("div",{style:{position:"absolute",top:"30px",left:0,background:"#fff",border:"1px solid #ccc",borderRadius:"4px",padding:"0.5rem",zIndex:2},children:[(0,Mr.jsx)("div",{className:"dropdown-item",onClick:()=>F("none"),children:"No Sort"}),(0,Mr.jsx)("div",{className:"dropdown-item",onClick:()=>F("tatAsc"),children:"TAT Asc"}),(0,Mr.jsx)("div",{className:"dropdown-item",onClick:()=>F("tatDesc"),children:"TAT Desc"}),(0,Mr.jsx)("div",{className:"dropdown-item",onClick:()=>F("seqAsc"),children:"Sequence Asc"}),(0,Mr.jsx)("div",{className:"dropdown-item",onClick:()=>F("seqDesc"),children:"Sequence Desc"})]})]}),(0,Mr.jsxs)("div",{style:{marginRight:"1rem",cursor:"pointer",position:"relative"},ref:P,children:[(0,Mr.jsx)("img",{src:"/Group.png",alt:"Group By",style:{width:"24px",height:"24px"},onClick:()=>u((e=>!e))}),l&&(0,Mr.jsxs)("div",{style:{position:"absolute",top:"30px",left:0,background:"#fff",border:"1px solid #ccc",borderRadius:"4px",padding:"0.5rem",zIndex:2},children:[(0,Mr.jsx)("div",{className:"dropdown-item",onClick:()=>D("none"),children:"None"}),(0,Mr.jsx)("div",{className:"dropdown-item",onClick:()=>D("process"),children:"Process"}),(0,Mr.jsx)("div",{className:"dropdown-item",onClick:()=>D("dataPoints"),children:"Data Points"}),(0,Mr.jsx)("div",{className:"dropdown-item",onClick:()=>D("randomTasks"),children:"Random Tasks"})]})]}),(0,Mr.jsx)("input",{type:"text",placeholder:"Search Steps...",style:{flex:1,padding:"0.5rem"},value:i,onChange:e=>s(e.target.value)})]}),L.map((t=>{const r="process"===a,i="dataPoints"===a,s=r||i,o=O.has(t.groupKey),l=r?`Process: ${t.groupKey}`:i?`Sequence: ${t.groupKey}`:"";return(0,Mr.jsxs)("div",{style:{marginBottom:"1rem"},children:[s&&(0,Mr.jsxs)("div",{onClick:()=>{return e=t.groupKey,void N((t=>{const n=new Set(t);return n.has(e)?n.delete(e):n.add(e),n}));var e},style:{cursor:"pointer",padding:"0.5rem 1rem",background:"#f5f5f5",borderRadius:"4px",display:"flex",alignItems:"center",userSelect:"none"},children:[(0,Mr.jsx)("span",{style:{marginRight:"0.5rem"},children:o?"\u25bc":"\u25b6"}),(0,Mr.jsx)("strong",{children:l})]}),(!s||o)&&t.items.map((t=>{var r;const{step:i,submission:s,statuses:a,formData:o}=t,l=i.tat_value?`${i.tat_value} ${null!==(r=i.tat_unit)&&void 0!==r?r:""}`:"N/A",u=i.is_escalated?" (Escalated)":"";return(0,Mr.jsxs)("div",{style:{background:t.readOnly?"#eee":"#ccc",margin:"0.5rem 0",padding:"1rem",borderRadius:"8px",cursor:t.readOnly?"default":"pointer",opacity:t.readOnly?.6:1},onClick:()=>{var n,r;t.readOnly?window.alert(`Waiting for ${t.prevResponsible} to complete this step :)`):(n=t.step.id,r=t.submission.id,t.readOnly||e(`/doer/step/${n}/submission/${r}`))},children:[(0,Mr.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.5rem"},children:[(0,Mr.jsxs)("div",{style:{display:"flex",alignItems:"center",position:"relative"},children:[(0,Mr.jsxs)("h3",{style:{margin:"0 0.5rem 0 0"},children:[i.name,u]}),(0,Mr.jsx)(Qr,{enabled:t.step.is_timer_enabled,createdAt:t.startedAt||t.step.created_at,durationValue:t.step.tat_value,durationUnit:t.step.tat_unit}),(0,Mr.jsx)("div",{style:{cursor:"pointer"},onClick:e=>((e,t)=>{t.stopPropagation(),b((t=>t===e?null:e))})(t.id,e),children:"\u22ee"}),y===t.id&&(0,Mr.jsx)("div",{style:{position:"absolute",top:"20px",right:0,background:"#fff",border:"1px solid #ccc",borderRadius:"4px",padding:"0.5rem",zIndex:2},onClick:e=>e.stopPropagation(),children:(0,Mr.jsx)("div",{style:{cursor:"pointer"},onClick:()=>(async(e,t)=>{let r=null;if("nosub"===t){const{error:t}=await Fr.from("steps").delete().eq("id",e);r=t}else{const{error:e}=await Fr.from("form_submissions").delete().eq("id",t);r=e}if(r)return console.error("Error deleting:",r),void alert("Failed to delete the step/submission");n((n=>n.filter((n=>n.id!==e+"_"+t)))),b(null)})(i.id,s.id),children:"Delete"})})]}),t.formData&&t.selectedFields&&t.selectedFields.length>0&&(0,Mr.jsx)("div",{style:{display:"flex",gap:"1rem"},children:t.selectedFields.map((e=>{const n=t.formData[e];return void 0!==n?(0,Mr.jsxs)("div",{children:[(0,Mr.jsxs)("strong",{children:[e,":"]})," ",String(n)]},e):null}))})]}),(0,Mr.jsxs)("p",{style:{margin:"0.5rem 0"},children:[(0,Mr.jsx)("strong",{children:"TAT:"})," ",l]}),a&&a.length>0&&(0,Mr.jsxs)("div",{style:{marginBottom:"0.5rem",fontSize:"0.9rem"},children:[(0,Mr.jsx)("strong",{children:"Status:"}),a.filter((e=>{var t,n,r,i;return(null!==(t=null===(n=e.selectedValue)||void 0===n?void 0:n.trim())&&void 0!==t?t:"")||(null!==(r=null===(i=e.selectedOptions)||void 0===i?void 0:i.length)&&void 0!==r?r:0)>0})).map(((e,t)=>{var n,r;const i=[];return null!==(n=e.selectedValue)&&void 0!==n&&n.trim()&&i.push(e.selectedValue),null!==(r=e.selectedOptions)&&void 0!==r&&r.length&&i.push(e.selectedOptions.join(", ")),(0,Mr.jsxs)("div",{children:["\u2022 ",i.join(" \u21d2 ")]},t)}))]})]},t.id)}))]},t.groupKey)})),x&&(0,Mr.jsx)("div",{style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",backgroundColor:"rgba(0,0,0,0.4)",display:"flex",justifyContent:"center",alignItems:"center"},onClick:M,children:(0,Mr.jsxs)("div",{style:{backgroundColor:"#fff",padding:"1rem",borderRadius:"8px",minWidth:"300px"},onClick:e=>e.stopPropagation(),children:[(0,Mr.jsx)("h3",{children:"Send Email / Msg"}),(0,Mr.jsxs)("p",{style:{fontSize:"0.9rem",color:"#555"},children:["Step ID: ",C]}),(0,Mr.jsxs)("div",{style:{marginBottom:"0.5rem"},children:[(0,Mr.jsx)("label",{children:"To:"}),(0,Mr.jsx)("input",{type:"email",value:_,onChange:e=>k(e.target.value),style:{width:"100%",marginTop:"0.25rem"}})]}),(0,Mr.jsxs)("div",{style:{marginBottom:"0.5rem"},children:[(0,Mr.jsx)("label",{children:"Message:"}),(0,Mr.jsx)("textarea",{value:S,onChange:e=>j(e.target.value),style:{width:"100%",height:"80px",marginTop:"0.25rem"}})]}),(0,Mr.jsxs)("div",{style:{textAlign:"right"},children:[(0,Mr.jsx)("button",{onClick:async()=>{if(_.trim()&&S.trim())try{const e=await fetch("https://step-by-step-server-production.up.railway.app/sendEmail",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({emailTo:_,emailMessage:S})}),t=await e.json();t.success?(alert("Email sent successfully!"),w(!1),k(""),j(""),E(null)):alert("Error sending email: "+t.error)}catch(e){console.error("Error sending email:",e),alert("Failed to send email")}else alert('Please fill both "To" and "Message" fields.')},style:{marginRight:"0.5rem",padding:"0.4rem 1rem"},children:"Send"}),(0,Mr.jsx)("button",{onClick:M,style:{padding:"0.4rem 1rem"},children:"Cancel"})]})]})}),(0,Mr.jsxs)("div",{style:{position:"fixed",bottom:"1rem",right:"1rem"},children:[(0,Mr.jsx)("button",{style:{marginRight:"0.5rem",width:"40px",height:"40px",borderRadius:"50%",fontSize:"1.2rem"},children:"\ud83d\udcac"}),(0,Mr.jsx)("button",{style:{width:"40px",height:"40px",borderRadius:"50%",fontSize:"1.2rem"},children:"?"})]})]})},Zr=e=>{let{formUrl:t,onSubmit:n}=e;const[i,s]=(0,r.useState)(null),[a,o]=(0,r.useState)(null),[l,u]=(0,r.useState)(null),[c,d]=(0,r.useState)(!1),[h,p]=(0,r.useState)({}),[f,m]=(0,r.useState)({});(0,r.useEffect)((()=>{const e=(e=>{try{const t=e.split(/[?#]/)[0].replace(/\/+$/,"").split("/").pop();return/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(t)?t:null}catch{return null}})(t);if(!e)return console.warn("Invalid form URL:",t);d(!0),(async()=>{const{data:t,error:n}=await zr.from("form_schemas").select("schema").eq("id",e).single();n?console.error(n):null!==t&&void 0!==t&&t.schema&&s(t.schema),d(!1)})()}),[t]),(0,r.useEffect)((()=>{if(!i)return;const e={...i.properties},t=Array.isArray(i.required)?[...i.required]:[];(i.allOf||[]).forEach((n=>{var r,i;const s=null===(r=n.if)||void 0===r?void 0:r.properties;if(!s)return;const[a]=Object.keys(s),o=null===(i=s[a])||void 0===i?void 0:i.const;void 0!==o&&h[a]===o&&(Object.assign(e,n.then.properties),Array.isArray(n.then.required)&&n.then.required.forEach((e=>{t.includes(e)||t.push(e)})))})),o({...i,properties:e,required:t,allOf:[]})}),[i,JSON.stringify(h)]),(0,r.useEffect)((()=>{a&&u((e=>{const t=Array.isArray(e.required)?e.required:[],n=e.properties,r={};for(const[s,a]of Object.entries(n)){var i;const e=t.includes(s),n=a.title||s,o=a.description?`Enter ${n}`:void 0;Array.isArray(a.enum)?r[s]={type:"dropdown",title:n,required:e,options:a.enum.map((e=>({value:String(e),label:String(e)})))}:"boolean"===a.type?r[s]={type:"checkbox",title:n,required:e,options:[{value:"true",label:n}]}:"array"===a.type&&null!==(i=a.items)&&void 0!==i&&i.enum?r[s]={type:"checkbox",title:n,required:e,options:a.items.enum.map((e=>({value:String(e),label:String(e)})))}:"integer"===a.type||"number"===a.type?r[s]={type:"number",title:n,placeholder:o,required:e}:"string"===a.type?"email"===a.format?r[s]={type:"email",title:n,placeholder:o,required:e}:a.maxLength&&a.maxLength>200?r[s]={type:"textarea",title:n,placeholder:o,required:e}:r[s]={type:"text",title:n,placeholder:o,required:e}:r[s]={type:"text",title:n,placeholder:o,required:e}}return{title:e.title||"",properties:r}})(a))}),[a]);const g=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"default";p((r=>{if("checkbox"===n){const n=r[e]||[],i=n.includes(t)?n.filter((e=>e!==t)):[...n,t];return{...r,[e]:i}}return{...r,[e]:t}}))};if(c)return(0,Mr.jsx)("p",{children:"Loading form\u2026"});if(!l)return(0,Mr.jsx)("p",{children:"No form schema found."});const v=(e,t)=>{var n,r,i,s;const a=e.title,o=e.placeholder||`Enter ${a}`,l=null!==(n=e.options)&&void 0!==n?n:(f[t]||[]).map((e=>({value:e,label:e})));switch(e.type){case"dropdown":return(0,Mr.jsxs)("div",{children:[(0,Mr.jsx)("label",{children:a}),(0,Mr.jsxs)("select",{value:null!==(r=h[t])&&void 0!==r?r:"",required:e.required,onChange:e=>g(t,e.target.value),children:[(0,Mr.jsx)("option",{value:"",disabled:!0,children:o}),l.map((e=>(0,Mr.jsx)("option",{value:e.value,children:e.label},e.value)))]})]},t);case"checkbox":return(0,Mr.jsxs)("div",{children:[(0,Mr.jsx)("label",{children:a}),l.map((e=>(0,Mr.jsxs)("div",{children:[(0,Mr.jsx)("input",{type:"checkbox",checked:(h[t]||[]).includes(e.value),onChange:()=>g(t,e.value,"checkbox")}),(0,Mr.jsx)("label",{children:e.label})]},e.value)))]},t);case"radio":return(0,Mr.jsxs)("div",{children:[(0,Mr.jsx)("label",{children:a}),l.map((n=>(0,Mr.jsxs)("div",{children:[(0,Mr.jsx)("input",{type:"radio",name:t,value:n.value,checked:h[t]===n.value,required:e.required,onChange:e=>g(t,e.target.value)}),(0,Mr.jsx)("label",{children:n.label})]},n.value)))]},t);case"number":case"text":case"email":return(0,Mr.jsxs)("div",{children:[(0,Mr.jsx)("label",{children:a}),(0,Mr.jsx)("input",{type:e.type,placeholder:o,value:null!==(i=h[t])&&void 0!==i?i:"",required:e.required,onChange:e=>g(t,e.target.value)})]},t);case"textarea":return(0,Mr.jsxs)("div",{children:[(0,Mr.jsx)("label",{children:a}),(0,Mr.jsx)("textarea",{placeholder:o,value:null!==(s=h[t])&&void 0!==s?s:"",required:e.required,onChange:e=>g(t,e.target.value)})]},t);case"file":return(0,Mr.jsxs)("div",{children:[(0,Mr.jsx)("label",{children:a}),(0,Mr.jsx)("input",{type:"file",required:e.required,onChange:e=>{var n;return(null===(n=e.target.files)||void 0===n?void 0:n[0])&&((e,t)=>{const n=URL.createObjectURL(t);p((t=>({...t,[e]:n})))})(t,e.target.files[0])}})]},t);case"video":case"audio":return(0,Mr.jsxs)("div",{children:[(0,Mr.jsx)("label",{children:a}),(0,Mr.jsxs)("button",{type:"button",onClick:()=>{e.type},children:["Record ",e.type]}),h[t]&&(0,Mr.jsx)("div",{style:{marginTop:8},children:"video"===e.type?(0,Mr.jsx)("video",{controls:!0,src:h[t],width:250}):(0,Mr.jsx)("audio",{controls:!0,src:h[t]})})]},t);default:return null}};return(0,Mr.jsxs)("form",{onSubmit:e=>{if(e.preventDefault(),!l)return;const t=Object.keys(l.properties);n(h,t)},children:[(0,Mr.jsx)("h3",{children:l.title}),Object.entries(l.properties).map((e=>{let[t,n]=e;return v(n,t)})),(0,Mr.jsx)("button",{type:"submit",children:"Submit"})]})},ei=()=>{var e;const{stepId:t,submissionId:n}=te(),i=ee(),s=Y(),[a,o]=(0,r.useState)(null),[l,u]=(0,r.useState)(null),[c,d]=(0,r.useState)(null),[h,p]=(0,r.useState)(""),[f,m]=(0,r.useState)(!0),[g,v]=(0,r.useState)([]),[y,b]=(0,r.useState)({fieldMapping:{},optionMapping:{}}),[x,w]=(0,r.useState)(!0),[_,k]=(0,r.useState)(!1),[S,j]=(0,r.useState)(""),[C,E]=(0,r.useState)(""),[T,R]=(0,r.useState)(!1),[P,O]=(0,r.useState)(""),[N,$]=(0,r.useState)(""),[I,A]=(0,r.useState)([]),[L,D]=(0,r.useState)(0),F=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i,[z,M]=(0,r.useState)({}),[B,U]=(0,r.useState)([]),q=Jr()||"";(0,r.useEffect)((()=>{a&&l&&async function(){if(!a||!l)return;try{const{data:e,error:t}=await Fr.from("submission_step_statuses").select("started_at").eq("submission_id",l.id).eq("step_id",a.id).single();if(t&&"PGRST116"!==t.code)return void console.error("Failed to check started_at:",t.message);if(null!==e&&void 0!==e&&e.started_at)return void console.log("\u23f3 Step already started at:",e.started_at);const n=K(),{error:r}=await Fr.from("submission_step_statuses").upsert({submission_id:l.id,step_id:a.id,started_at:n,statuses:a.statuses||[]},{onConflict:"submission_id,step_id"});if(r)return void console.error("\u274c Failed to record start:",r.message);console.log("\u2705 Step started at",n),o((e=>e?{...e,started_at:n}:e))}catch(e){console.error("Unexpected error in handleStartStep:",e)}}()}),[a,l]),(0,r.useEffect)((()=>{t&&Fr.from("steps").select("*").eq("id",t).single().then((e=>{let{data:t,error:n}=e;n?console.error(n):(o(t),p(t.crafty_action_mapping),b({fieldMapping:t.field_action_mapping||{},optionMapping:t.option_action_mapping||{}}))}))}),[t]),(0,r.useEffect)((()=>{a&&(async e=>{const{data:{user:t}}=await Fr.auth.getUser(),n=null!==(e=null===t||void 0===t?void 0:t.email)&&void 0!==e?e:"";a.responsibility&&a.responsibility!==n&&(alert(`Next step will be handled by ${a.responsibility}`),i("/doer"))})()}),[a,i]),(0,r.useEffect)((()=>{t&&(n?J(t,n):V(t))}),[t,n]),(0,r.useEffect)((()=>{if(!a||a.started_at||!a.scheduled_at)return;const e=new Date(a.scheduled_at);if(new Date>=e){(async()=>{const e=K(),{error:t}=await Fr.from("steps").update({started_at:e}).eq("id",a.id);t?console.error("Failed to auto-start step:",t.message):(console.log("\u2705 Step auto-started at scheduled time"),o((t=>t?{...t,started_at:e}:t)))})()}}),[a]),(0,r.useEffect)((()=>{if(!a)return;(async()=>{w(!0);try{const{data:e,error:t}=await Fr.from("forms").select("google_form_url, process_id");if(t)return console.error("Error fetching forms:",t),void w(!1);if(!e||0===e.length)return console.log("No forms records found."),void w(!1);const r=e.filter((e=>e.process_id===a.process_id)),i=r.some((e=>e.google_form_url.includes("docs.google.com/forms/d/e/")));k(i);const s=r.map((e=>{const t=e.google_form_url.split("/");return t[t.length-1]})).filter((e=>F.test(e)));console.log("Filtered valid IDs:",s);let o=[],l=0;if(n&&n.includes("_")){const e=n.split("_");l=parseInt(e[e.length-1],10);o=[e.slice(0,e.length-1).join("_")]}else o=n&&"nosub"!==n?[n]:s;const{data:u,error:c}=await zr.from("form_data").select("*").in("id",o);if(c)console.error("Error fetching forms_data for ids:",c);else if(u&&u.length>0){const e=[...u].sort(((e,t)=>new Date(e.created_at).getTime()-new Date(t.created_at).getTime()))[l];e?(M(e.form_data),console.log("\ud83d\udd0d formResponses loaded:",e.form_data),w(!1),console.log("\ud83d\udd0d formResponses loaded:",e.form_data)):M({})}else console.log("No forms_data records found for ids:",o)}catch(e){console.error("Exception in fetchIdsAndData:",e)}w(!1)})()}),[a,n]),(0,r.useEffect)((()=>{if(!a||!a.form_definition)return;let e=a.form_definition;if("string"===typeof e)try{e=JSON.parse(e)}catch(i){console.error("Could not parse form_definition JSON:",i,e)}if(null!==e&&"object"===typeof e&&!Array.isArray(e)&&Object.keys(e).every((e=>/^\d+$/.test(e)))&&(e=Object.keys(e).sort(((e,t)=>Number(e)-Number(t))).map((t=>e[t]))),!Array.isArray(e))return void console.error("form_definition is not an array even after normalize:",e);let t=a.form_action_mapping,n=[];if("string"===typeof t)try{n=JSON.parse(t)}catch{n=t.split(",")}else Array.isArray(t)&&(n=t);const r=e.map(((e,t)=>({id:`form-${t}`,fields:Array.isArray(e)?e:[],actionMapping:n[t]||""})));A(r),D(0)}),[a]);const W=async()=>{if(!a)return;const e=(()=>{const e=I[L],t={};return e.fields.forEach((e=>{var n;const r=e.label;t[r]=null!==(n=z[e.id])&&void 0!==n?n:null})),t})(),{data:{user:t}}=await Fr.auth.getUser(),{error:n}=await Fr.from("step_form_submissions").insert({process_id:a.process_id,step_id:a.step_id,sequence_id:a.sequence_id,user_id:null===t||void 0===t?void 0:t.id,submission:e});if(n)return console.error("\ud83d\udd34 failed saving form submission:",n),alert("Could not save your answers, please try again.");alert("Form submitted successfully!")},H=e=>{const t=[],n=[];return null!==e&&void 0!==e&&e.form_data&&"object"===typeof e.form_data&&Object.entries(e.form_data).forEach((e=>{let[r,i]=e;t.push(r),n.push((null===i||void 0===i?void 0:i.toString())||"")})),{fields:t,responses:n}},V=async e=>{m(!0);const{data:t,error:n}=await Fr.from("steps").select("*").eq("id",e).single();if(n)return console.error("Error fetching step:",n),void m(!1);t?(o(t),m(!1)):m(!1)},J=async(e,t)=>{m(!0);const{data:n,error:r}=await Fr.from("steps").select("*").eq("id",e).single();if(r)return console.error("Error fetching step:",r),void m(!1);if(!n)return void m(!1);o(n);const{data:i,error:s}=await Fr.from("form_submissions").select("*").eq("id",t).single();if(s)return console.error("Error fetching submission:",s),void m(!1);u(i);const{data:a,error:l}=await Fr.from("submission_statuses").select("statuses").eq("submission_id",t).single();l?(console.error("Error fetching submission statuses:",l),d(n.statuses||[])):a&&d(a.statuses),m(!1)};function K(e){const t=null!==e&&void 0!==e?e:new Date,n=t.getTime()+60*t.getTimezoneOffset()*1e3,r=new Date(n+198e5),i=e=>String(e).padStart(2,"0");return`${r.getFullYear()}-${i(r.getMonth()+1)}-${i(r.getDate())} ${i(r.getHours())}:${i(r.getMinutes())}:${i(r.getSeconds())}`}const G=null!==l&&null!==c?c:(null===a||void 0===a?void 0:a.statuses)||[];function Q(e,t){const n=[],r=Math.max(e.length,t.length);for(let a=0;a<r;a++){const r=e[a]||{},o=t[a]||{};for(const e of["selectedValue","statusName","optionName","actionMapping"]){var i,s;if(r[e]!==o[e])n.push({index:a,field:e,previous:null!==(i=r[e])&&void 0!==i?i:null,current:null!==(s=o[e])&&void 0!==s?s:null})}}return n}const X=async(e,t)=>{if(!a)return;const{data:{user:n},error:r}=await Fr.auth.getUser();if(r||!n)return void console.error("Unable to fetch user:",r);const i=Q(t,e),{error:s}=await Fr.from("status_change_history").insert([{step_id:a.id,submission_id:l?l.id:null,user_id:n.id,previous_status:t,new_status:e,changes:i}]);if(s&&console.error("Failed to write audit log:",s),await Fr.from("logs").insert({event_type:"status_update",details:JSON.stringify({stepId:a.id,submissionId:l?l.id:null,changes:i}),created_at:K()}),l){const{error:t}=await Fr.from("submission_step_statuses").upsert({submission_id:l.id,step_id:a.id,statuses:e},{onConflict:"submission_id,step_id"});t&&console.error("Failed to persist statuses:",t.message)}if(l){const{error:t}=await Fr.from("submission_statuses").upsert({submission_id:l.id,statuses:e});if(t)return void console.error("Error upserting submission_statuses:",t)}else{const{error:t}=await Fr.from("steps").update({statuses:e}).eq("id",a.id);if(t)return void console.error("Error updating steps.statuses:",t)}const o={};if(z&&Object.keys(z).length>0){const e=_?H({form_data:z}):(e=>{const t=[],n=[],r=null===e||void 0===e?void 0:e.form_data;return Array.isArray(r)?r.forEach(((e,r)=>{t.push(`Field ${r+1}`),n.push((null===e||void 0===e?void 0:e.toString())||"")})):r&&"object"===typeof r&&Object.entries(r).forEach((e=>{let[r,i]=e;t.push(r),n.push((null===i||void 0===i?void 0:i.toString())||"")})),{fields:t,responses:n}})({form_data:z});e.fields.forEach(((t,n)=>{o[t]=e.responses[n]||""}))}else if(l&&l.data&&Object.keys(l.data).length>0)Object.entries(l.data).forEach((e=>{let[t,n]=e;o[t]=Array.isArray(n)?n.join(", "):String(n)}));else if(l)try{const e=JSON.parse(l.fields||"[]"),t=JSON.parse(l.responses||"[]");e.forEach(((e,n)=>{o[e]=t[n]||""}))}catch(us){console.error("Error parsing stored submission fields/responses:",us)}console.log("\ud83d\udd0d unified placeholder lookup:",o);const u=Q(t,e),c=a.alerts||[];for(const l of u){if("selectedValue"!==l.field||!l.current)continue;const t=e[l.index];c.filter((e=>e.statusName===t.optionName)).forEach((e=>{var n;if(!e.email||!e.template||null===(n=e.type)||void 0===n||!n.length)return;let r=e.template.replace(/{{statusName}}/g,t.statusName).replace(/{{stepName}}/g,a.name);r=r.replace(/{([^}]+)}/g,((e,t)=>{var n;return null!==(n=o[t])&&void 0!==n?n:""})),e.type.forEach((t=>{if("email"===t){e.email.split(",").map((e=>e.trim())).filter((e=>e.includes("@"))).forEach((e=>{console.log(`\ud83d\udce7 Sending email to ${e}:`,r),fetch("https://step-by-step-server-production.up.railway.app/sendEmail",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({emailTo:e,emailMessage:r})})}))}if("whatsapp"===t){const t=Jr();if(!t)return;e.email.split(",").map((e=>e.trim())).filter((e=>/^\+?\d+$/.test(e))).forEach((n=>{console.log(`\ud83d\udcf1 Sending WhatsApp to ${n}:`,r),fetch("https://step-by-step-server-production.up.railway.app/sendWhatsApp",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify({to:n,message:r,buttons:e.buttons||[]})})}))}}))}))}},Z=()=>{l&&c?X(c,c):null!==a&&void 0!==a&&a.statuses&&X(a.statuses,a.statuses)},ne=e=>{const t=l?[...c||[]]:null!==a&&void 0!==a&&a.statuses?[...a.statuses]:[],n=G.map(((t,n)=>n===e?{...t,selectedValue:t.optionName}:t));l?d(n):a&&o({...a,statuses:n}),X(n,t)};var re;null===a||void 0===a||null===(re=a.alerts)||void 0===re||re.filter((e=>e.type.includes("whatsapp"))).map(((e,t)=>{var n;return(0,Mr.jsx)("div",{className:"mb-2",children:null===(n=e.buttons)||void 0===n?void 0:n.map(((t,n)=>(0,Mr.jsx)("button",{className:"px-3 py-1 m-1 bg-blue-600 text-white rounded",onClick:()=>{q&&fetch("https://step-by-step-server-production.up.railway.app/sendWhatsApp",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${q}`},body:JSON.stringify({to:e.email.split(",").map((e=>e.trim()))[0],message:t.reply,buttons:[]})}).then((e=>e.json())).then((e=>console.log("WhatsApp reply sent:",e))).catch((e=>console.error("Error sending WhatsApp reply:",e)))},children:t.title},n)))},t)}));const ie=e=>{E(e),"escalate"===e?(async()=>{if(null===a||void 0===a||!a.id)return;const{error:e}=await Fr.from("steps").update({is_escalated:!0}).eq("id",a.id);e?(console.error("Error escalating step:",e),alert("Failed to escalate")):(alert("Step escalated!"),o({...a,is_escalated:!0}))})():"email"===e&&R(!0)};const se=async()=>{if(!a||!l)return alert("Step or submission not loaded.");if("checklist"===a.step_type){var e;if(!(null===(e=a.checklists)||void 0===e?void 0:e.every((e=>e.isChecked))))return alert("Please finish all checklist items before completing.")}if("status"===a.step_type){if(!(null===c||void 0===c?void 0:c.find((e=>{var t;return null===(t=e.selectedValue)||void 0===t?void 0:t.trim()}))))return alert("Please select a status before completing.")}const t=K(),{error:n}=await Fr.from("submission_step_statuses").upsert({submission_id:l.id,step_id:a.id,completed_at:t,statuses:c||a.statuses||[]},{onConflict:"submission_id,step_id"});if(n)return console.error("Error recording completion:",n.message),alert("Failed to complete this step:\n"+n.message);await Fr.from("logs").insert({event_type:"step_complete",details:JSON.stringify({stepId:a.id,submissionId:l.id,completed_at:t,statuses:c}),created_at:t});const{data:r,error:s}=await Fr.from("steps").select("id").eq("process_id",a.process_id).eq("sequence_id",a.sequence_id+1).single();if(s||null===r||void 0===r||!r.id)return alert("All steps done for this submission!"),i("/doer/steplist");i(`/doer/step/${r.id}/submission/${l.id}`)};let ae={fields:[],responses:[]};if(z&&Object.keys(z).length>0)ae=H({form_data:z});else if(l)try{const e=JSON.parse(l.fields||"[]"),t=JSON.parse(l.responses||"[]");ae={fields:e,responses:t}}catch(us){console.error("Error parsing submission fields/responses",us)}const oe=a&&a.tat_value&&a.tat_unit?`${a.tat_value} ${a.tat_unit}`:"No TAT";return f?(0,Mr.jsx)("div",{style:{padding:"1rem"},children:"Loading detail..."}):a?(0,Mr.jsxs)("div",{style:{padding:"1rem"},children:[(null===(e=s.state)||void 0===e?void 0:e.undoInfo)&&(0,Mr.jsxs)("div",{style:{position:"fixed",top:"80px",right:"20px",background:"#fff",border:"1px solid #ccc",borderRadius:"4px",padding:"0.5rem",zIndex:1e3},children:[(0,Mr.jsx)("span",{children:"You can undo the last step change. "}),(0,Mr.jsx)("button",{onClick:async()=>{var e;const t=null===(e=s.state)||void 0===e?void 0:e.undoInfo;if(!t)return;const{previousStepId:n,previousStatuses:r}=t,{error:a}=await Fr.from("steps").update({completed_at:null,statuses:r}).eq("id",n);if(a)return console.error("Error reverting step completion and statuses:",a),alert("Failed to undo step completion.");o((e=>e&&e.id===n?{...e,completed_at:void 0,statuses:r}:e)),alert("Undo successful. Please click \u201cComplete Step\u201d again when ready."),i(`/doer/step/${n}/submission/nosub`)},children:"Undo"})]}),(0,Mr.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"baseline"},children:[(0,Mr.jsx)("h2",{style:{margin:0},children:a.name}),(0,Mr.jsx)("p",{style:{margin:0,color:"#666",fontSize:"1rem"},children:oe})]}),a.process_id&&(0,Mr.jsxs)("div",{style:{background:"#eee",borderRadius:"8px",padding:"1rem",margin:"1rem 0"},children:[(0,Mr.jsx)("h4",{style:{marginTop:0},children:"Transposed form data"}),((e,t)=>{let n=[];return null!==l&&void 0!==l&&l.data&&Object.keys(l.data).length>0?n=Object.entries(l.data).map((e=>{let[t,n]=e;return{label:t,value:Array.isArray(n)?n.join(", "):String(n)}})):(null===(e=ae)||void 0===e||null===(t=e.fields)||void 0===t?void 0:t.length)>0&&(n=ae.fields.map(((e,t)=>({label:e,value:ae.responses[t]||""})))),n.length>0?n.map(((e,t)=>{let{label:n,value:r}=e;return(0,Mr.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"0.5rem"},children:[(0,Mr.jsx)("strong",{children:n}),(0,Mr.jsx)("span",{children:r})]},t)})):(0,Mr.jsx)("p",{children:"No form data found."})})()]}),"checklist"===a.step_type?(0,Mr.jsxs)(Mr.Fragment,{children:[(()=>{if(!a)return null;const e=a.checklists?a.checklists.length:0,t=a.checklists?a.checklists.filter((e=>e.isChecked)).length:0;return(0,Mr.jsxs)("div",{style:{marginTop:"1rem",background:"#fafafa",borderRadius:"8px",padding:"1rem"},children:[(0,Mr.jsxs)("h4",{children:["Checklist (",t," of ",e," done)"]}),a.checklists&&a.checklists.length>0?a.checklists.map(((e,t)=>(0,Mr.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:"0.5rem"},children:[(0,Mr.jsx)("input",{type:"checkbox",checked:e.isChecked,onChange:()=>(async e=>{var t;if(!a)return;const n=null===(t=a.checklists)||void 0===t?void 0:t[e];if(!n)return;const r=!n.isChecked,i=(new Date).toISOString(),s=a.checklists.map(((t,n)=>n===e?{...t,isChecked:r,completedAt:r?i:void 0}:t));o((e=>e?{...e,checklists:s}:e));const{error:l}=await Fr.from("steps").update({checklists:s}).eq("id",a.id);l&&(console.error("Checklist save error:",l.message),alert("Could not save checklist. Please try again."))})(t),style:{marginRight:"0.5rem"}}),(0,Mr.jsxs)("span",{style:{textDecoration:e.isChecked?"line-through":"none"},children:[e.text,e.isChecked&&e.completedAt&&(0,Mr.jsxs)("small",{style:{marginLeft:"0.5rem",color:"#666"},children:["(",new Date(e.completedAt).toLocaleString(),")"]})]})]},t))):(0,Mr.jsx)("p",{children:"No checklist items found."})]})})(),(0,Mr.jsxs)("div",{style:{marginTop:"1rem",padding:"1rem",background:"#f0f0f0",borderRadius:"8px"},children:[(0,Mr.jsxs)("p",{children:["Checklist Action Mapping: ",(0,Mr.jsx)("strong",{children:a.checklistActionMapping||"Not defined"})]}),a.checklists&&a.checklists.filter((e=>e.isChecked)).length===a.checklists.length&&(0,Mr.jsx)("p",{style:{color:"green"},children:"All checklist items completed. Action will be automatically triggered."})]})]}):(0,Mr.jsx)(Mr.Fragment,{children:"status"===a.step_type&&1===G.length?(0,Mr.jsx)("div",{style:{margin:"1rem 0"},children:(0,Mr.jsx)("button",{onClick:()=>{ne(0),se()},style:{padding:"0.75rem 1.5rem",fontSize:"1rem"},disabled:!a.started_at,children:"Complete Step"})}):(0,Mr.jsxs)("div",{style:{marginBottom:"1rem"},children:[(0,Mr.jsx)("h4",{children:"Statuses"}),G.length>0&&"dropdown"===G[0].inputType?(0,Mr.jsxs)("div",{children:[(0,Mr.jsx)("label",{children:"Select Option:"}),(0,Mr.jsxs)("select",{value:S,onChange:e=>(e=>{j(e);const t=l?[...c||[]]:null!==a&&void 0!==a&&a.statuses?[...a.statuses]:[],n=G.map((t=>({...t,selectedValue:t.optionName===e?t.optionName:""})));l?d(n):a&&o({...a,statuses:n}),X(n,t)})(e.target.value),style:{marginLeft:"0.5rem",padding:"0.5rem"},children:[(0,Mr.jsx)("option",{value:"",children:"--Select--"}),G.map(((e,t)=>(0,Mr.jsx)("option",{value:e.optionName,children:e.optionName},t)))]})]}):G.map(((e,t)=>{return"radio"===e.inputType?(0,Mr.jsxs)("label",{style:{marginRight:"1rem"},children:[(0,Mr.jsx)("input",{type:"radio",name:"statusRadioGroup",value:e.optionName,checked:e.selectedValue===e.optionName,onChange:()=>(e=>{const t=l?[...c||[]]:null!==a&&void 0!==a&&a.statuses?[...a.statuses]:[],n=G.map((t=>"radio"===t.inputType?{...t,selectedValue:t.optionName===e?t.optionName:""}:t));l?d(n):a&&o({...a,statuses:n}),X(n,t)})(e.optionName)}),e.optionName]},t):"checkbox"===e.inputType?(0,Mr.jsxs)("label",{style:{marginRight:"1rem"},children:[(0,Mr.jsx)("input",{type:"checkbox",checked:(null===(n=e.selectedOptions)||void 0===n?void 0:n.includes(e.optionName))||!1,onChange:()=>(e=>{const t=l?[...c||[]]:null!==a&&void 0!==a&&a.statuses?[...a.statuses]:[],n=G.map(((t,n)=>{if(n===e){var r;const e=(null===(r=t.selectedOptions)||void 0===r?void 0:r.includes(t.optionName))||!1;let n=t.selectedOptions||[];return n=e?n.filter((e=>e!==t.optionName)):[...n,t.optionName],{...t,selectedOptions:n}}return t}));l?d(n):a&&o({...a,statuses:n}),X(n,t)})(t)}),e.optionName]},t):"text"===e.inputType?(0,Mr.jsxs)("div",{children:[(0,Mr.jsxs)("label",{children:["Enter ",e.statusName||e.optionName,":"]}),(0,Mr.jsx)("input",{type:"text",value:e.selectedValue||"",onChange:e=>((e,t)=>{if(l){const n=[...c||[]];n[e]={...n[e],selectedValue:t},d(n)}else if(null!==a&&void 0!==a&&a.statuses){const n=[...a.statuses];n[e]={...n[e],selectedValue:t},o({...a,statuses:n})}})(t,e.target.value),onBlur:Z,style:{marginLeft:"0.5rem"}})]},t):"button"===e.inputType?(0,Mr.jsx)("div",{children:(0,Mr.jsx)("button",{onClick:()=>ne(t),children:e.optionName})},t):null;var n}))]})}),"crafty"===a.step_type&&a.form_url&&(0,Mr.jsxs)("div",{style:{margin:"0.5rem 0"},children:[(0,Mr.jsx)("strong",{children:"Crafty Form:"})," ",(0,Mr.jsx)("a",{href:a.form_url,target:"_blank",rel:"noopener noreferrer",style:{color:"#007bff"},children:a.form_url})]}),a.form_url&&(0,Mr.jsxs)("div",{style:{margin:"0.5rem 0"},children:[(0,Mr.jsx)("strong",{children:"Crafty Form:"})," ",(0,Mr.jsx)("a",{href:a.form_url,target:"_blank",rel:"noopener noreferrer",children:"Open form"})]}),(0,Mr.jsx)("div",{style:{margin:"1rem 0"},children:(0,Mr.jsx)("h4",{children:"Shared Form Fields"})}),(0,Mr.jsxs)("div",{style:{marginBottom:"1rem"},children:[(0,Mr.jsx)("label",{style:{display:"block",marginBottom:"0.25rem"},children:"Quick Actions"}),(0,Mr.jsxs)("select",{value:C,onChange:e=>ie(e.target.value),style:{width:"100%",padding:"0.5rem"},children:[(0,Mr.jsx)("option",{value:"",children:"--Select--"}),(0,Mr.jsx)("option",{value:"escalate",children:"Escalate"}),(0,Mr.jsx)("option",{value:"email",children:"Email / Msg"})]})]}),a.started_at?(0,Mr.jsxs)("p",{style:{color:"#888",margin:"0.5rem"},children:["Started at: ",K(new Date(a.started_at))]}):a.scheduled_at&&new Date<new Date(a.scheduled_at)?(0,Mr.jsxs)("p",{style:{color:"#f90",margin:"0.5rem"},children:["Scheduled to start at: ",K(new Date(a.scheduled_at))]}):(0,Mr.jsx)("p",{style:{color:"#999",margin:"0.5rem"},children:"Step has not started yet."}),"crafty"!==a.step_type&&(a.completed_at?(0,Mr.jsxs)("p",{style:{color:"#888",margin:"0.5rem"},children:["Completed at: ",K(new Date(a.completed_at))]}):(0,Mr.jsx)("button",{onClick:se,style:{padding:"0.5rem 1rem",margin:"0.5rem"},disabled:!a.started_at,children:"Complete Step"})),(()=>{if(x)return(0,Mr.jsx)("p",{children:"Loading form\u2026"});if(0===I.length)return null;const e=I[L];return Array.isArray(e.fields)?(0,Mr.jsxs)("div",{children:[(0,Mr.jsxs)("h4",{children:["Form ",L+1," of ",I.length]}),(0,Mr.jsxs)("p",{children:[(0,Mr.jsx)("strong",{children:"Next Action:"})," ",e.actionMapping||"\u2013"]}),"// \u2190 ADDED: render based on merged fieldInfos & mappingConfig",g.map((e=>(0,Mr.jsxs)("div",{children:[(0,Mr.jsx)("label",{children:e.title}),e.options?(0,Mr.jsxs)("select",{value:z[e.key]||"",onChange:t=>M((n=>({...n,[e.key]:t.target.value}))),children:[(0,Mr.jsx)("option",{value:"",children:"--Select--"}),e.options.map((e=>(0,Mr.jsx)("option",{value:e,children:e},e)))]}):(0,Mr.jsx)("input",{type:"string"===e.type?"text":e.type,value:z[e.key]||"",onChange:t=>M((n=>({...n,[e.key]:t.target.value})))})]},e.key))),(0,Mr.jsx)("button",{onClick:W,children:"Submit this form"})]}):(0,Mr.jsx)("p",{style:{color:"red"},children:"Invalid fields shape"})})(),T&&(0,Mr.jsx)("div",{style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",backgroundColor:"rgba(0,0,0,0.4)",display:"flex",justifyContent:"center",alignItems:"center"},children:(0,Mr.jsxs)("div",{style:{backgroundColor:"#fff",padding:"1rem",borderRadius:"8px",minWidth:"300px"},children:[(0,Mr.jsx)("h3",{children:"Send Email / Msg"}),(0,Mr.jsxs)("div",{style:{marginBottom:"0.5rem"},children:[(0,Mr.jsx)("label",{children:"To:"}),(0,Mr.jsx)("input",{type:"email",value:P,onChange:e=>O(e.target.value),style:{width:"100%",marginTop:"0.25rem"}})]}),(0,Mr.jsxs)("div",{style:{marginBottom:"0.5rem"},children:[(0,Mr.jsx)("label",{children:"Message:"}),(0,Mr.jsx)("textarea",{value:N,onChange:e=>$(e.target.value),style:{width:"100%",height:"80px",marginTop:"0.25rem"}})]}),(0,Mr.jsxs)("div",{style:{textAlign:"right"},children:[(0,Mr.jsx)("button",{onClick:async()=>{try{const e=await fetch("https://step-by-step-server-production.up.railway.app/sendEmail",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({emailTo:P,emailMessage:N})}),t=await e.json();t.success?(alert("Email sent successfully!"),R(!1),O(""),$("")):alert("Error sending email: "+t.error)}catch(e){console.error("Error:",e),alert("Failed to send email")}},style:{marginRight:"0.5rem",padding:"0.4rem 1rem"},children:"Send"}),(0,Mr.jsx)("button",{onClick:()=>{R(!1),O(""),$(""),E("")},style:{padding:"0.4rem 1rem"},children:"Cancel"})]})]})}),"crafty"===a.step_type&&a.form_url&&(0,Mr.jsx)(Zr,{formUrl:a.form_url,onSubmit:(e,t)=>async function(e,t){if(!a)return void console.error("No step loaded");const{data:n,error:r}=await Fr.from("step_form_submissions").insert([{process_id:a.process_id,fields:t,step_id:a.step_id,sequence_id:a.sequence_id,responses:t.map((t=>e[t])),data:e}]).select();if(r)return console.error("Error saving submission:",r),alert(`Failed to save form: ${r.message}`);const s=K(),{error:l}=await Fr.from("steps").update({completed_at:s}).eq("id",a.id);l?console.error("Error completing step:",l):o((e=>e?{...e,completed_at:s}:e));let u,c=h||"next";for(const i of t){var d;const t=e[i],n=null===(d=y.optionMapping[i])||void 0===d?void 0:d[t],r=null==n?void 0:"object"===typeof n?n:{action:n};if(r){if("split"!==r.action){c=r.action;break}c="split",u=r.target;break}}if(c===h)for(const i of t){const e=y.fieldMapping[i],t=null==e?void 0:"object"===typeof e?e:{action:e};if(t){if("split"!==t.action){c=t.action;break}c="split",u=t.target;break}}switch(console.log("Chosen action:",c,"Split target:",u),c){case"next":case"nextForm":{const{data:e,error:t}=await Fr.from("steps").select("id").eq("process_id",a.process_id).eq("sequence_id",a.sequence_id+1).single();return t||null===e||void 0===e||!e.id?alert("Next step not available"):i(`/doer/step/${e.id}/submission/nosub`)}case"stop":return alert("Workflow complete");case"split":{if(!u)return alert("Split target missing");const e=/^Step:\s*(.+?)\s+in\s+(.+)$/.exec(u);if(!e)return alert("Malformed split target");const[,t,n]=e,{data:r}=await Fr.from("processes").select("id").eq("name",n).maybeSingle();if(null===r||void 0===r||!r.id)return alert(`Process "${n}" not found`);const{data:s,error:a}=await Fr.from("steps").select("id").eq("process_id",r.id).eq("name",t).single();return a||null===s||void 0===s||!s.id?alert(`Step "${t}" in "${n}" not found`):i(`/doer/step/${s.id}/submission/nosub`)}default:const{data:e,error:t}=await Fr.from("steps").select("id").eq("process_id",a.process_id).eq("sequence_id",a.sequence_id+1).single();return null!==e&&void 0!==e&&e.id&&!t?i(`/doer/step/${e.id}/submission/nosub`):alert("Could not determine next action")}}(e,t)}),(0,Mr.jsxs)("div",{style:{position:"fixed",bottom:"1rem",right:"1rem"},children:[(0,Mr.jsx)("button",{style:{marginRight:"0.5rem",width:"40px",height:"40px",borderRadius:"50%",fontSize:"1.2rem"},children:"\ud83d\udcac"}),(0,Mr.jsx)("button",{style:{width:"40px",height:"40px",borderRadius:"50%",fontSize:"1.2rem"},children:"?"})]})]}):(0,Mr.jsx)("div",{style:{padding:"1rem"},children:"No step data found."})},ti={background:"#333",color:"#fff",padding:"1rem",display:"flex",justifyContent:"space-between",alignItems:"center"},ni={color:"#fff",marginRight:"1rem",textDecoration:"none"},ri={background:"#fff",color:"#333",border:"none",padding:"0.5rem 1rem",cursor:"pointer",borderRadius:"4px"},ii=()=>{const[e,t]=(0,r.useState)(!1);(0,r.useEffect)((()=>{const e=localStorage.getItem("googleToken");t(!!e)}),[]);return(0,Mr.jsxs)("nav",{style:ti,children:[(0,Mr.jsxs)("div",{children:[(0,Mr.jsx)(nt,{to:"/",style:ni,children:"Giver"}),(0,Mr.jsx)(nt,{to:"/doer",style:ni,children:"Doer"}),(0,Mr.jsx)(nt,{to:"/report",style:ni,children:"Report"})]}),(0,Mr.jsx)("div",{children:(0,Mr.jsx)("button",{style:ri,onClick:()=>{e?(localStorage.removeItem("googleToken"),t(!1),window.location.href="/"):window.location.href="http://localhost:8888/auth/"},children:e?"Logout":"Sign in with Google"})})]})},si={display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100vh",background:"#f4f4f4"},ai={background:"#fff",color:"#333",border:"none",padding:"0.75rem 1.5rem",cursor:"pointer",borderRadius:"4px",fontSize:"1rem"},oi=()=>{const[e,t]=(0,r.useState)(null),[n,i]=(0,r.useState)([]),[s,a]=(0,r.useState)(!1);(0,r.useEffect)((()=>{Fr.auth.getSession().then((e=>{let{data:{session:n}}=e;t((null===n||void 0===n?void 0:n.user)||null)}));const{data:e}=Fr.auth.onAuthStateChange(((e,n)=>{t((null===n||void 0===n?void 0:n.user)||null)}));return()=>{null===e||void 0===e||e.subscription.unsubscribe()}}),[]);return(0,r.useEffect)((()=>{e&&((async e=>{const{error:t}=await Fr.from("users").upsert({id:e.id,email:e.email});t&&console.error("Error saving user data:",t.message)})(e),(async e=>{a(!0);const{data:t,error:n}=await Fr.from("processes").select("*").eq("user_id",e);n?console.error("Error fetching processes:",n.message):i(t),a(!1)})(e.id))}),[e]),(0,Mr.jsx)("div",{style:si,children:e?(0,Mr.jsxs)(Mr.Fragment,{children:[(0,Mr.jsxs)("h1",{children:["Welcome, ",e.email]}),(0,Mr.jsx)("h2",{children:"Your Process List"}),s?(0,Mr.jsx)("p",{children:"Loading processes..."}):n.length>0?(0,Mr.jsx)("ul",{children:n.map((e=>(0,Mr.jsx)("li",{children:e.name},e.id)))}):(0,Mr.jsx)("p",{children:"No processes found."})]}):(0,Mr.jsxs)(Mr.Fragment,{children:[(0,Mr.jsx)("h1",{children:"Login"}),(0,Mr.jsx)("button",{onClick:async()=>{const{error:e}=await Fr.auth.signInWithOAuth({provider:"google"});e&&console.error("Error signing in:",e.message)},style:ai,children:"Sign in with Google"})]})})};function li(){const e=ee();return(0,r.useEffect)((()=>{window.open("https://nimble-phoenix-504247.netlify.app/","_blank","noopener,noreferrer");const t=window.prompt("Please paste the URL of your published form here:");t&&""!==t.trim()?e(`/add-step?formUrl=${encodeURIComponent(t.trim())}`):e(-1)}),[e]),null}function ui(){const e=ee(),[t,n]=(0,r.useState)(""),[i,s]=(0,r.useState)([{label:"",inputType:"text",options:""}]),[a,o]=(0,r.useState)(""),l=()=>{s((e=>[...e,{label:"",inputType:"text",options:""}]))};return(0,Mr.jsxs)("div",{style:{maxWidth:600,margin:"auto",padding:"1rem",fontFamily:"Arial, sans-serif"},children:[(0,Mr.jsx)("h2",{children:"Create New Form"}),(0,Mr.jsx)("label",{style:{display:"block",margin:"0.5rem 0 0.25rem"},children:"Form Name"}),(0,Mr.jsx)("input",{type:"text",value:t,onChange:e=>n(e.target.value),placeholder:"Enter form name",style:{width:"100%",padding:"0.5rem",boxSizing:"border-box"}}),(0,Mr.jsx)("h3",{style:{marginTop:"1rem"},children:"Fields"}),i.map(((e,t)=>(0,Mr.jsxs)("div",{style:{marginBottom:"1rem",paddingBottom:"0.5rem",borderBottom:"1px solid #eee"},children:[(0,Mr.jsx)("label",{style:{display:"block",margin:"0.25rem 0"},children:"Label"}),(0,Mr.jsx)("input",{type:"text",value:e.label,onChange:e=>{const n=[...i];n[t].label=e.target.value,s(n)},onKeyDown:e=>((e,t)=>{"Enter"===e.key&&""!==i[t].label.trim()&&l()})(e,t),placeholder:"Enter field label",style:{width:"100%",padding:"0.4rem",boxSizing:"border-box"}}),(0,Mr.jsx)("label",{style:{display:"block",margin:"0.25rem 0"},children:"Input Type"}),(0,Mr.jsxs)("select",{value:e.inputType,onChange:e=>{const n=[...i];n[t].inputType=e.target.value,s(n)},style:{width:"100%",padding:"0.4rem",boxSizing:"border-box"},children:[(0,Mr.jsx)("option",{value:"text",children:"Text"}),(0,Mr.jsx)("option",{value:"dropdown",children:"Dropdown"}),(0,Mr.jsx)("option",{value:"checkbox",children:"Checkbox"})]}),("dropdown"===e.inputType||"checkbox"===e.inputType)&&(0,Mr.jsxs)(Mr.Fragment,{children:[(0,Mr.jsx)("label",{style:{display:"block",margin:"0.25rem 0"},children:"Options (comma\u2011separated)"}),(0,Mr.jsx)("input",{type:"text",value:e.options,onChange:e=>{const n=[...i];n[t].options=e.target.value,s(n)},placeholder:"e.g. Apple,Banana,Cherry",style:{width:"100%",padding:"0.4rem",boxSizing:"border-box"}})]})]},t))),(0,Mr.jsx)("button",{onClick:l,style:{padding:"0.4rem 0.8rem",marginBottom:"1rem",cursor:"pointer"},children:"+ Add Field"}),(0,Mr.jsxs)("div",{style:{borderTop:"1px solid #ccc",paddingTop:"1rem",marginTop:"1rem"},children:[(0,Mr.jsx)("label",{style:{display:"block",margin:"0.25rem 0"},children:"On Submit: Action Mapping"}),(0,Mr.jsxs)("select",{value:a,onChange:e=>o(e.target.value),style:{width:"100%",padding:"0.4rem",boxSizing:"border-box"},children:[(0,Mr.jsx)("option",{value:"",children:"-- Select an action --"}),(0,Mr.jsx)("option",{value:"next",children:"Next Step"}),(0,Mr.jsx)("option",{value:"stop",children:"Stop Here"}),(0,Mr.jsx)("option",{value:"split",children:"Split/Progress"})]})]}),(0,Mr.jsx)("button",{onClick:async()=>{const{data:{session:n}}=await Fr.auth.getSession();if(null===n||void 0===n||!n.user)return void alert("Please sign in to create a form.");const{data:r,error:s}=await Fr.from("step_forms").insert({name:t,user_id:n.user.id,submit_action_mapping:a||null}).select("id").single();if(s||!r)return void alert(`Error creating form: ${null===s||void 0===s?void 0:s.message}`);const o=i.map(((e,t)=>({form_id:r.id,label:e.label,input_type:e.inputType,options:e.options,position:t}))),{error:l}=await Fr.from("step_form_fields").insert(o);l?alert(`Error saving fields: ${l.message}`):(alert("Form saved successfully!"),e(-1,{state:{newFormId:r.id}}))},style:{marginTop:"1.5rem",padding:"0.6rem 1.2rem",background:"#333",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer"},children:"Save Form"})]})}var ci={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},di=r.createContext&&r.createContext(ci),hi=["attr","size","title"];function pi(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function fi(){return fi=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},fi.apply(this,arguments)}function mi(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function gi(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?mi(Object(n),!0).forEach((function(t){vi(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):mi(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function vi(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function yi(e){return e&&e.map(((e,t)=>r.createElement(e.tag,gi({key:t},e.attr),yi(e.child))))}function bi(e){return t=>r.createElement(xi,fi({attr:gi({},e.attr)},t),yi(e.child))}function xi(e){var t=t=>{var n,{attr:i,size:s,title:a}=e,o=pi(e,hi),l=s||t.size||"1em";return t.className&&(n=t.className),e.className&&(n=(n?n+" ":"")+e.className),r.createElement("svg",fi({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,i,o,{className:n,style:gi(gi({color:e.color||t.color},t.style),e.style),height:l,width:l,xmlns:"http://www.w3.org/2000/svg"}),a&&r.createElement("title",null,a),e.children)};return void 0!==di?r.createElement(di.Consumer,null,(e=>t(e))):t(ci)}function wi(e){return bi({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"6 9 12 15 18 9"},child:[]}]})(e)}function _i(e){return bi({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"9 18 15 12 9 6"},child:[]}]})(e)}function ki(e){return bi({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"18 15 12 9 6 15"},child:[]}]})(e)}function Si(e){return bi({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"10"},child:[]},{tag:"polyline",attr:{points:"12 6 12 12 16 14"},child:[]}]})(e)}const ji=Si,Ci=wi,Ei=ki,Ti=function(e){return bi({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"5",y1:"12",x2:"19",y2:"12"},child:[]},{tag:"polyline",attr:{points:"12 5 19 12 12 19"},child:[]}]})(e)},Ri=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"hrs";return"mins"===t?e/60:"days"===t?24*e:"weeks"===t?168*e:e};function Pi(e){const t=e,n=e=>String(e).padStart(2,"0");return`${t.getFullYear()}-${n(t.getMonth()+1)}-${n(t.getDate())} ${n(t.getHours())}:${n(t.getMinutes())}:${n(t.getSeconds())}`}function Oi(e){return new Date(e.replace(" ","T"))}function Ni(e){if(!e.started_at||null==e.tat_value)return 0;const t=Oi(e.started_at).getTime();return(e.completed_at?Oi(e.completed_at).getTime():Date.now())-t-36e5*Ri(e.tat_value,e.tat_unit||"hrs")}function $i(e){switch(e){case"Completed":return["#f6ffed","#389e0d"];case"In Progress":return["#fffbe6","#ad8b00"];default:return["#fff","#595959"]}}function Ii(e){const t=Ni(e);return t>0?` \u2022 Delay ${function(e){const t=Math.abs(e),n=t/6e4;if(n<60)return`${Math.round(n)} mins`;const r=t/36e5;return r<24?`${r.toFixed(1)} hrs`:`${(t/864e5).toFixed(1)} days`}(t)}`:""}function Ai(e){if(!e.started_at)return"N/A";const t=Oi(e.started_at).getTime();return Li((e.completed_at?Oi(e.completed_at).getTime():Date.now())-t)}function Li(e){const t=Math.abs(e),n=t/6e4;if(n<60)return`${Math.round(n)} mins`;const r=t/36e5;if(r<24)return`${r.toFixed(1)} hrs`;return`${(t/864e5).toFixed(1)} days`}function Di(e,t){if(!e.completed_at||!t.started_at)return null;const n=Oi(e.completed_at).getTime(),r=Oi(t.started_at).getTime();return r<=n?null:function(e){const t=Math.abs(e);return`${Math.floor(t/36e5)}h ${Math.floor(t%36e5/6e4)}m`}(r-n)}const Fi=()=>{const e=ee(),[t,n]=(0,r.useState)([]),[i,s]=(0,r.useState)({}),[a,o]=(0,r.useState)(!0),[l,u]=(0,r.useState)(new Set),[c,d]=(0,r.useState)(!1),[h,p]=(0,r.useState)("process"),[f,m]=(0,r.useState)(null),g=(0,r.useRef)({});function v(e,t){var n,r;const s=null===(n=e.form_submissions[0])||void 0===n?void 0:n.id,a=s?null===(r=i[s])||void 0===r?void 0:r[t.id]:void 0;return null!==a&&void 0!==a&&a.completed_at?{text:"Completed",start:a.started_at,end:a.completed_at}:null!==a&&void 0!==a&&a.started_at?{text:"In Progress",start:a.started_at,end:null}:{text:"Pending",start:null,end:null}}(0,r.useEffect)((()=>{!async function(){o(!0);const{data:{session:e}}=await Fr.auth.getSession();if(null===e||void 0===e||!e.user)return n([]),void o(!1);const{data:t,error:i}=await Fr.from("processes").select("\n        id,name,created_at,\n        steps (\n          id,name,created_at,started_at,completed_at,\n          tat_value,tat_unit,statuses\n        ),\n        form_submissions(id)\n      ").eq("user_id",e.user.id).order("created_at",{ascending:c}).order("created_at",{ascending:!0,foreignTable:"steps"}),a=i?[]:t,l={};a.forEach((e=>{l[e.id]=(0,r.createRef)()})),g.current=l,n(a);const u=a.flatMap((e=>e.form_submissions.map((e=>e.id))));if(u.length){const{data:e}=await Fr.from("submission_step_statuses").select("submission_id,step_id,started_at,completed_at").in("submission_id",u),t={};null===e||void 0===e||e.forEach((e=>{t[e.submission_id]||={},t[e.submission_id][e.step_id]={started_at:e.started_at,completed_at:e.completed_at}})),s(t)}o(!1)}()}),[c]),(0,r.useEffect)((()=>{var e;f&&g.current[f]&&(null===(e=g.current[f].current)||void 0===e||e.scrollIntoView({behavior:"smooth",block:"center"}))}),[h,f]);const y=(e,t)=>{const{text:n}=v(e,t),[r,i]=$i(n);return(0,Mr.jsx)("span",{style:{...zi.statusPill,background:r,color:i},children:n})};return(0,Mr.jsxs)("div",{style:zi.container,children:[(0,Mr.jsx)("h2",{style:zi.title,children:"Process Timelineee"}),(0,Mr.jsxs)("div",{style:{marginBottom:16},children:[(0,Mr.jsx)("button",{style:"process"===h?zi.filterActive:zi.filterBtn,onClick:()=>p("process"),children:"By Process"}),(0,Mr.jsx)("button",{style:"steps"===h?zi.filterActive:zi.filterBtn,onClick:()=>p("steps"),children:"By Step"}),(0,Mr.jsx)("button",{style:zi.filterBtn,onClick:()=>e("/report/processstepdatapoints"),children:"New Report Page"}),(0,Mr.jsx)("button",{style:zi.filterBtn,onClick:()=>e("/report/datapoints"),children:"By Data Points"}),(0,Mr.jsx)("button",{style:"doer"===h?zi.filterActive:zi.filterBtn,onClick:()=>e("/report/doer"),children:"By Doer"})]}),(0,Mr.jsxs)("div",{style:zi.sortToggle,children:[(0,Mr.jsx)("button",{style:{...zi.sortBtn,...c?{}:zi.sortBtnActive},onClick:()=>d(!0),children:"Oldest first"}),(0,Mr.jsx)("button",{style:{...zi.sortBtn,...c?zi.sortBtnActive:{}},onClick:()=>d(!1),children:"Newest first"})]}),a?(0,Mr.jsx)("p",{children:"Loading\u2026"}):"process"===h?(0,Mr.jsx)("div",{style:zi.timeline,children:t.map((e=>{const t=e.steps.length,n=e.steps.filter((e=>!!e.completed_at)).length,i=t>0?Math.round(n/t*100):0,s=t,a=e.form_submissions.length,o=e.steps.reduce(((e,t)=>e+Ri(t.tat_value||0,t.tat_unit||"hrs")),0).toFixed(1);return(0,Mr.jsxs)("div",{ref:g.current[e.id],style:zi.entry,children:[(0,Mr.jsxs)("div",{style:zi.dateCell,children:[(0,Mr.jsx)("div",{style:zi.dateText,children:(()=>{const t=e.steps.map((e=>e.started_at)).filter((e=>!!e));return t.length?Pi(Oi(t.sort()[0])):"\u2014"})()}),(0,Mr.jsx)(ji,{style:zi.clockIcon})]}),(0,Mr.jsx)("div",{style:zi.lineContainer,children:(0,Mr.jsx)("div",{style:zi.line})}),(0,Mr.jsxs)("div",{style:zi.card,children:[(0,Mr.jsxs)("div",{style:zi.cardHeader,children:[(0,Mr.jsx)("strong",{style:{fontSize:18},children:e.name}),(0,Mr.jsx)("button",{onClick:()=>{return t=e.id,void u((e=>{const n=new Set(e);return n.has(t)?n.delete(t):n.add(t),n}));var t},style:zi.collapseBtn,children:l.has(e.id)?(0,Mr.jsx)(Ei,{}):(0,Mr.jsx)(Ci,{})})]}),(0,Mr.jsxs)("div",{style:zi.tagsRow,children:[(0,Mr.jsxs)("span",{style:{...zi.tag,background:"#E6FFFB",color:"#006D75"},children:[s," Steps"]}),(0,Mr.jsxs)("span",{style:{...zi.tag,background:"#F6FFED",color:"#52C41A"},children:[a," Data pts"]}),(0,Mr.jsxs)("span",{style:{...zi.tag,background:"#FFF2E8",color:"#FA541C"},children:[o," hrs"]})]}),(0,Mr.jsx)("div",{style:zi.progressContainer,children:(0,Mr.jsx)("div",{style:{...zi.progressInner,width:`${i}%`}})}),(0,Mr.jsxs)("span",{style:zi.progressLabel,children:[n," / ",t," steps (",i,"%)"]}),l.has(e.id)&&(0,Mr.jsx)("div",{style:zi.stepsContainer,children:e.steps.map(((t,n)=>{const{text:i,start:s,end:a}=v(e,t),o=n>0?Di(e.steps[n-1],t):null,[l]=$i(i);return(0,Mr.jsxs)(r.Fragment,{children:[o&&(0,Mr.jsxs)("div",{style:zi.gapRow,children:[(0,Mr.jsx)(ji,{style:zi.gapIcon}),(0,Mr.jsx)("span",{style:zi.gapText,children:`Gap: ${o}`})]}),(0,Mr.jsxs)("div",{style:{...zi.stepCard,background:l},children:[(0,Mr.jsxs)("div",{style:zi.stepHeader,children:[(0,Mr.jsx)("strong",{children:t.name}),y(e,t)]}),(0,Mr.jsxs)("div",{style:zi.stepMeta,children:[s?Pi(Oi(s)):"\u2014"," ","\u2022 Duration: ",s?Li((a?Oi(a).getTime():Date.now())-Oi(s).getTime()):"N/A",!a&&s?" (ongoing)":""]})]})]},t.id)}))})]})]},e.id)}))}):(()=>{const e=t.flatMap((e=>e.steps.map((t=>({...t,processName:e.name,processId:e.id})))));return(0,Mr.jsx)("div",{style:zi.stepsContainer,children:e.map((e=>{const{text:n,start:r,end:i}=v({...t.find((t=>t.id===e.processId))},e),[s]=$i(n);return(0,Mr.jsxs)("div",{style:{...zi.stepCard,background:s},children:[(0,Mr.jsxs)("div",{style:zi.stepHeader,children:[(0,Mr.jsxs)("strong",{children:[e.processName,": ",e.name]}),y(t.find((t=>t.id===e.processId)),e),(0,Mr.jsx)("button",{onClick:()=>{return t=e.processId,p("process"),u((e=>new Set(e).add(t))),void m(t);var t},style:zi.arrowBtn,children:(0,Mr.jsx)(Ti,{})})]}),(0,Mr.jsx)("div",{style:zi.statusSequence,children:Array.isArray(e.statuses)&&e.statuses.length>0?e.statuses.map(((t,n)=>(0,Mr.jsxs)("span",{style:zi.sequenceItem,children:[t.statusName,n<e.statuses.length-1?" \u2192 ":""]},n))):(0,Mr.jsx)("span",{style:zi.sequenceItem,children:"No statuses"})}),(0,Mr.jsxs)("div",{style:zi.stepMeta,children:["Started:"," ",e.started_at?Pi(Oi(e.started_at)):"\u2014",(0,Mr.jsx)("br",{}),"Duration: ",Ai(e)," ",Ii(e)]})]},e.id)}))})})()]})},zi={container:{maxWidth:800,margin:"auto",padding:20,fontFamily:"Arial, sans-serif",color:"#333"},title:{marginBottom:12},filterBtn:{padding:"6px 12px",marginRight:8,border:"1px solid #ccc",background:"#fff",cursor:"pointer"},filterActive:{padding:"6px 12px",marginRight:8,border:"1px solid #1890FF",background:"#E6F4FF",cursor:"pointer"},sortToggle:{display:"inline-flex",border:"1px solid #1890FF",borderRadius:4,overflow:"hidden",marginBottom:24},sortBtn:{padding:"6px 12px",border:"none",background:"#fff",cursor:"pointer",color:"#1890FF",fontSize:14},sortBtnActive:{background:"#1890FF",color:"#fff"},timeline:{position:"relative"},entry:{display:"flex",marginBottom:32},dateCell:{flex:"0 0 180px",textAlign:"right",paddingRight:16,fontSize:14,color:"#555",display:"flex",flexDirection:"column",alignItems:"flex-end",gap:4},dateText:{lineHeight:1.2},clockIcon:{color:"#1890FF",fontSize:16},lineContainer:{width:20,position:"relative"},line:{position:"absolute",left:"50%",transform:"translateX(-50%)",top:0,bottom:0,width:2,background:"#ddd"},card:{flex:1,background:"#fff",borderRadius:8,padding:16,boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},cardHeader:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},collapseBtn:{background:"none",border:"none",cursor:"pointer",fontSize:18,color:"#666"},tagsRow:{display:"flex",gap:12,marginBottom:12},tag:{display:"inline-block",padding:"4px 8px",borderRadius:4,fontSize:12,fontWeight:500},progressContainer:{position:"relative",width:"100%",height:16,background:"#f0f0f0",borderRadius:8,overflow:"hidden",marginTop:8,marginBottom:12},progressInner:{position:"absolute",top:0,left:0,bottom:0,width:"0%",background:"#1890FF",transition:"width 0.3s ease"},progressLabel:{fontSize:12,color:"#555",marginBottom:8,display:"block"},stepsContainer:{display:"flex",flexDirection:"column",gap:12,marginTop:12},stepCard:{borderRadius:8,padding:12,boxShadow:"0 1px 4px rgba(0,0,0,0.08)"},stepHeader:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:8,marginBottom:4},statusPill:{padding:"2px 6px",borderRadius:4,fontSize:12},arrowBtn:{background:"none",border:"none",cursor:"pointer",color:"#1890FF",fontSize:16},statusSequence:{whiteSpace:"nowrap",overflowX:"auto",marginBottom:4,fontSize:12,color:"#333"},sequenceItem:{display:"inline"},stepMeta:{fontSize:12,color:"#777",marginTop:2},gapRow:{display:"flex",alignItems:"center",padding:"4px 12px",background:"#f5f5f5",borderRadius:4,fontSize:12,color:"#555",marginBottom:4},gapIcon:{marginRight:6,fontSize:14,color:"#1890FF"},gapText:{lineHeight:1}},Mi=Si,Bi=wi,Ui=_i;function qi(){const e=ee(),[t,n]=(0,r.useState)("datapoints"),[i,s]=(0,r.useState)([]),[a,o]=(0,r.useState)({}),[l,u]=(0,r.useState)({}),[c,d]=(0,r.useState)({}),[h,p]=(0,r.useState)({}),[f,m]=(0,r.useState)(!0),[g,v]=(0,r.useState)("desc"),y=(0,r.useRef)({});(0,r.useEffect)((()=>{!async function(){m(!0);const{data:{session:e}}=await Fr.auth.getSession();if(null===e||void 0===e||!e.user)return void m(!1);const{data:t,error:n}=await Fr.from("processes").select("\n        id,\n        name,\n        created_at,\n        steps ( id, name, created_at, tat_value, tat_unit, responsibility ),\n        form_submissions ( id, data )\n      ").eq("user_id",e.user.id).order("created_at",{ascending:!1});if(n||!t)return console.error(n),void m(!1);const i={};t.forEach((e=>{e.steps.sort(((e,t)=>new Date(e.created_at).getTime()-new Date(t.created_at).getTime())),i[e.id]=(0,r.createRef)()})),y.current=i,s(t);const a=t.flatMap((e=>e.form_submissions.map((e=>e.id))));if(!a.length)return void m(!1);const{data:l,error:u}=await Fr.from("submission_step_statuses").select("submission_id,step_id,started_at,completed_at,statuses").in("submission_id",a);if(u||!l)return console.error(u),void m(!1);const c={};l.forEach((e=>{c[e.submission_id]||={},c[e.submission_id][e.step_id]=e})),o(c),m(!1)}()}),[]);const b=[...i].sort(((e,t)=>{const n=new Date(e.created_at).getTime(),r=new Date(t.created_at).getTime();return"asc"===g?n-r:r-n}));return(0,Mr.jsxs)("div",{style:Hi.container,children:[(0,Mr.jsx)("h2",{style:Hi.title,children:"Report for Process / Data Points / Steps"}),(0,Mr.jsxs)("div",{style:{marginBottom:16},children:[(0,Mr.jsx)("button",{style:"process"===t?Hi.filterActive:Hi.filterBtn,onClick:()=>{n("process"),e("/report")},children:"By Process"}),(0,Mr.jsx)("button",{style:"steps"===t?Hi.filterActive:Hi.filterBtn,onClick:()=>{n("steps"),e("/report")},children:"By Step"}),(0,Mr.jsx)("button",{style:"new"===t?Hi.filterActive:Hi.filterBtn,onClick:()=>{n("new"),e("/report/processstepdatapoints")},children:"New Report Page"}),(0,Mr.jsx)("button",{style:"datapoints"===t?Hi.filterActive:Hi.filterBtn,onClick:()=>{n("datapoints"),e("/report/datapoints")},children:"By Data Points"})]}),f?(0,Mr.jsx)("p",{children:"Loading\u2026"}):(0,Mr.jsxs)(Mr.Fragment,{children:[(0,Mr.jsxs)("div",{style:Hi.sortContainer,children:[(0,Mr.jsx)("button",{style:"asc"===g?Hi.sortButtonActive:Hi.sortButton,onClick:()=>v("asc"),children:"Oldest first"}),(0,Mr.jsx)("button",{style:"desc"===g?Hi.sortButtonActive:Hi.sortButton,onClick:()=>v("desc"),children:"Newest first"})]}),(0,Mr.jsx)("div",{style:Hi.timelineContainer,children:b.map((e=>{var t;const n=e.steps.length,r=e.form_submissions.length,i=e.steps.reduce(((e,t)=>e+function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;switch((arguments.length>1&&void 0!==arguments[1]?arguments[1]:"hrs").toLowerCase()){case"min":case"mins":case"minutes":default:return e;case"hrs":case"hours":return 60*e;case"day":case"days":case"d":return 1440*e}}(t.tat_value||0,t.tat_unit||"hrs")),0),s=(o=i)>=1440?`${(o/1440).toFixed(1)} d`:o>=60?`${(o/60).toFixed(1)} h`:`${o} m`;var o;const f=Object.keys((null===(t=e.form_submissions[0])||void 0===t?void 0:t.data)||{}),m=!!l[e.id];return(0,Mr.jsxs)("div",{ref:y.current[e.id],style:Hi.timelineItem,children:[(0,Mr.jsx)("div",{style:Hi.timelineMarker}),(0,Mr.jsx)("div",{style:Hi.timeLabel,children:new Date(e.created_at).toLocaleString(void 0,{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}),(0,Mr.jsxs)("div",{style:Hi.card,children:[(0,Mr.jsxs)("div",{style:Hi.cardHeader,children:[(0,Mr.jsxs)("div",{onClick:()=>{return t=e.id,u((e=>({...e,[t]:!e[t]})));var t},style:{display:"flex",alignItems:"center",cursor:"pointer"},children:[m?(0,Mr.jsx)(Bi,{style:{marginRight:8}}):(0,Mr.jsx)(Ui,{style:{marginRight:8}}),(0,Mr.jsx)("h3",{style:Hi.processTitle,children:e.name})]}),(0,Mr.jsxs)("div",{style:Hi.statsContainer,children:[(0,Mr.jsxs)("span",{style:Hi.badgeSteps,children:[n," Steps"]}),(0,Mr.jsxs)("span",{style:Hi.badgeData,children:[r," Data pts"]}),(0,Mr.jsx)("span",{style:Hi.badgeDuration,children:s})]})]}),m&&(0,Mr.jsxs)(Mr.Fragment,{children:[f.length>0&&(0,Mr.jsx)("div",{style:{padding:"0 16px 12px"},children:(0,Mr.jsxs)("select",{value:h[e.id]||"",onChange:t=>{return n=e.id,r=t.target.value,p((e=>({...e,[n]:r})));var n,r},style:Hi.select,children:[(0,Mr.jsx)("option",{value:"",children:"Filter field\u2026"}),f.map((e=>(0,Mr.jsx)("option",{value:e,children:e},e)))]})}),e.form_submissions.map((t=>{var r;const i=!!c[t.id],s=a[t.id]||{},o=h[e.id],l=o?null===(r=t.data)||void 0===r?void 0:r[o]:null,u=e.steps.filter((e=>{var t;return!(null===(t=s[e.id])||void 0===t||!t.completed_at)})).length,p=Math.round(u/n*100);return(0,Mr.jsxs)("div",{style:Hi.subSection,children:[(0,Mr.jsxs)("div",{style:Hi.subHeader,onClick:()=>{return e=t.id,d((t=>({...t,[e]:!t[e]})));var e},children:[i?(0,Mr.jsx)(Bi,{}):(0,Mr.jsx)(Ui,{}),(0,Mr.jsxs)("span",{style:Hi.subTitle,children:["Data Point: ",t.id,o&&(0,Mr.jsxs)("span",{style:Hi.subBadge,children:[o,": ",String(null!==l&&void 0!==l?l:"\u2014")]})]})]}),i&&(0,Mr.jsxs)("div",{style:Hi.subContent,children:[(0,Mr.jsx)("div",{style:Hi.progressContainer,children:(0,Mr.jsx)("div",{style:{...Hi.progressBar,width:`${p}%`}})}),(0,Mr.jsxs)("div",{style:Hi.progressText,children:[u," / ",n," steps (",p,"%)"]}),(0,Mr.jsx)("div",{style:Hi.dataGrid,children:Object.entries(t.data||{}).map((e=>{let[t,n]=e;return(0,Mr.jsxs)("div",{style:Hi.dataCell,children:[(0,Mr.jsx)("strong",{children:t}),(0,Mr.jsx)("br",{}),String(n)]},t)}))}),e.steps.map((e=>{const t=s[e.id]||{},n=t.started_at,r=t.completed_at,i=n?r?Hi.badgeCompleted.background:Hi.badgeInProgress.background:Hi.badgePending.background,a=n?r?"Completed":"In progress":"Pending",o=((e,t)=>{if(!e)return"\u2013";const n=new Date(e),r=(t?new Date(t):new Date).getTime()-n.getTime();if(r<0)return"\u2013";const i=Math.floor(r/6e4);return`${Math.floor(i/60)}h ${i%60}m`})(n,r);return(0,Mr.jsxs)("div",{style:{...Hi.stepCard,background:i},children:[(0,Mr.jsxs)("div",{style:Hi.stepHeader,children:[(0,Mr.jsx)("strong",{children:e.name}),(0,Mr.jsx)("span",{style:n?r?Hi.badgeCompleted:Hi.badgeInProgress:Hi.badgePending,children:a})]}),(0,Mr.jsxs)("div",{style:Hi.stepInfo,children:[(0,Mr.jsx)(Mi,{style:{marginRight:4}}),(0,Mr.jsxs)("span",{children:[o,!r&&" (ongoing)"]}),(0,Mr.jsxs)("span",{style:Hi.byText,children:["Completed by:"," ",r?e.responsibility||"Unknown":"\u2014"]})]})]},e.id)}))]})]},t.id)}))]})]})]},e.id)}))})]})]})}const Wi="#007bff",Hi={filterBtn:{padding:"6px 12px",marginRight:8,border:"1px solid #ccc",background:"#fff",cursor:"pointer"},filterActive:{padding:"6px 12px",marginRight:8,border:`1px solid ${Wi}`,background:"#E6F4FF",cursor:"pointer"},sortContainer:{display:"inline-flex",border:`1px solid ${Wi}`,borderRadius:4,overflow:"hidden",marginBottom:16},sortButton:{padding:"6px 12px",border:"none",background:"#fff",color:Wi,cursor:"pointer",fontSize:14},sortButtonActive:{padding:"6px 12px",border:"none",background:Wi,color:"#fff",cursor:"pointer",fontSize:14},container:{maxWidth:920,margin:"auto",padding:24},title:{marginBottom:24,textAlign:"center"},timelineContainer:{position:"relative",paddingLeft:-20,borderLeft:`3px solid ${Wi}`},timelineItem:{position:"relative",marginBottom:32},timelineMarker:{position:"absolute",left:-11,top:8,width:14,height:14,borderRadius:"50%",background:Wi,border:"3px solid #fff",boxSizing:"content-box"},timeLabel:{position:"absolute",left:-120,width:90,textAlign:"right",fontSize:12,color:"#888",top:4},card:{background:"#fff",borderRadius:8,boxShadow:"0 2px 8px rgba(0,0,0,0.05)"},cardHeader:{display:"flex",alignItems:"center",padding:16,borderBottom:`1px solid ${Wi}33`},processTitle:{fontSize:18,margin:0,color:"#333"},statsContainer:{marginLeft:"auto",display:"flex",gap:8,alignItems:"center"},badgeSteps:{background:"#e6f7ff",color:Wi,padding:"4px 8px",borderRadius:4,fontSize:12},badgeData:{background:"#e6ffed",color:"#28a745",padding:"4px 8px",borderRadius:4,fontSize:12},badgeDuration:{background:"#fff5e6",color:"#fd7e14",padding:"4px 8px",borderRadius:4,fontSize:12},select:{padding:"6px 12px",borderRadius:4,border:`1px solid ${Wi}66`,fontSize:14,width:"100%"},subSection:{marginTop:12},subHeader:{display:"flex",alignItems:"center",cursor:"pointer",userSelect:"none",marginBottom:8,padding:"0 16px"},subTitle:{marginLeft:8,fontWeight:500,color:"#444"},subBadge:{marginLeft:12,background:`${Wi}22`,color:Wi,padding:"2px 6px",borderRadius:4,fontSize:12},subContent:{padding:"0 16px 16px",borderLeft:"2px solid #f0f0f0"},dataGrid:{display:"grid",gridTemplateColumns:"repeat(auto-fill,minmax(120px,1fr))",gap:12,marginBottom:16},dataCell:{background:"#f9f9f9",padding:8,borderRadius:4,fontSize:13,color:"#333"},progressContainer:{height:8,background:"#eee",borderRadius:4,margin:"8px 16px",overflow:"hidden"},progressBar:{height:"100%",background:Wi},progressText:{fontSize:12,padding:"0 16px 8px"},stepCard:{borderRadius:6,padding:12,marginBottom:8,boxShadow:"0 1px 4px rgba(0,0,0,0.04)"},stepHeader:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:6},badgePending:{background:"#f8d7da",color:"#721c24",padding:"2px 8px",borderRadius:12,fontSize:12},badgeInProgress:{background:"#fff3cd",color:"#856404",padding:"2px 8px",borderRadius:12,fontSize:12},badgeCompleted:{background:"#d4edda",color:"#155724",padding:"2px 8px",borderRadius:12,fontSize:12},stepInfo:{display:"flex",alignItems:"center",gap:12,fontSize:13,color:"#666"},byText:{marginLeft:"auto",fontStyle:"italic",fontSize:12}},Vi=wi,Ji=_i;function Ki(){const e=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:600;const[t,n]=(0,r.useState)(window.innerWidth<e);return(0,r.useEffect)((()=>{const t=()=>n(window.innerWidth<e);return window.addEventListener("resize",t),()=>window.removeEventListener("resize",t)}),[e]),t}(),[t,n]=(0,r.useState)([]),[i,s]=(0,r.useState)({}),[a,o]=(0,r.useState)({}),[l,u]=(0,r.useState)(!0);(0,r.useEffect)((()=>{!async function(){u(!0);const{data:{session:e}}=await Fr.auth.getSession();if(null===e||void 0===e||!e.user)return void u(!1);const{data:t,error:r}=await Fr.from("processes").select("\n     id,\n   name,\n   steps ( id, name, responsibility ),\n   form_submissions ( id, data, created_at )\n ").eq("user_id",e.user.id).order("created_at",{ascending:!1});if(r||!t)return console.error(r),void u(!1);n(t);const i=t.flatMap((e=>e.form_submissions.map((e=>e.id))));if(i.length){const{data:e}=await Fr.from("submission_step_statuses").select("submission_id,step_id,started_at,completed_at").in("submission_id",i),t={};null===e||void 0===e||e.forEach((e=>{t[e.submission_id]||={},t[e.submission_id][e.step_id]=e})),s(t)}u(!1)}()}),[]);if(l)return(0,Mr.jsx)("p",{style:Qi.loading,children:"Loading\u2026"});const c=t.flatMap((e=>e.form_submissions.map((t=>({proc:e,sub:t})))));return(0,Mr.jsxs)("div",{style:Qi.container,children:[(0,Mr.jsx)("h2",{style:Qi.title,children:"By Data Points"}),(0,Mr.jsx)("div",{style:Qi.timelineContainer,children:c.map((t=>{let{proc:n,sub:r}=t;const s=r.created_at?new Date(r.created_at).toLocaleString():"\u2014",l=!!a[r.id],u=i[r.id]||{},c=n.steps.map((e=>{var t;return null===(t=u[e.id])||void 0===t?void 0:t.started_at})).filter(Boolean).map((e=>new Date(e).getTime())),d=n.steps.map((e=>{var t;return null===(t=u[e.id])||void 0===t?void 0:t.completed_at})).filter(Boolean).map((e=>new Date(e).getTime()));let h="\u2013";c.length&&d.length&&(h=(e=>{const t=Math.round(e/6e4);if(t<60)return`${t}m`;const n=Math.floor(t/60);return n<24?`${n}h`:`${Math.floor(n/24)}d`})(Math.max(...d)-Math.min(...c)));const p=Object.keys(r.data||{}),f=p.slice(0,3);return(0,Mr.jsxs)("div",{style:{...Qi.itemRow,flexDirection:e?"column":"row",alignItems:e?"stretch":"flex-start"},children:[(0,Mr.jsx)("div",{style:{...Qi.timestamp,width:e?"100%":120,textAlign:e?"left":"right",marginBottom:e?8:0},children:s}),!e&&(0,Mr.jsxs)("div",{style:{...Qi.lineContainer,marginBottom:0},children:[(0,Mr.jsx)("div",{style:Qi.verticalLine}),(0,Mr.jsx)("div",{style:Qi.dot})]}),(0,Mr.jsxs)("div",{style:Qi.card,children:[(0,Mr.jsxs)("div",{style:{...Qi.cardHeader,padding:e?8:12},onClick:()=>{return e=r.id,o((t=>({...t,[e]:!t[e]})));var e},children:[l?(0,Mr.jsx)(Vi,{size:16}):(0,Mr.jsx)(Ji,{size:16}),f.map((t=>{var n,i;return(0,Mr.jsxs)("span",{style:{...Qi.headerField,marginLeft:e?8:12,fontSize:e?14:16},children:[(0,Mr.jsxs)("strong",{children:[t,":"]})," ",null!==(n=null===(i=r.data)||void 0===i?void 0:i[t])&&void 0!==n?n:"\u2014"]},t)})),(0,Mr.jsx)("span",{style:{...Qi.ttl,marginLeft:"auto",fontSize:e?14:16},children:h})]}),l&&(0,Mr.jsxs)("div",{style:Qi.expandedSection,children:[(0,Mr.jsx)("div",{style:Qi.tableWrapper,children:(0,Mr.jsxs)("table",{style:Qi.table,children:[(0,Mr.jsx)("thead",{children:(0,Mr.jsx)("tr",{children:p.map((e=>(0,Mr.jsx)("th",{style:Qi.th,children:e},e)))})}),(0,Mr.jsx)("tbody",{children:(0,Mr.jsx)("tr",{children:p.map((e=>{var t,n;return(0,Mr.jsx)("td",{style:Qi.td,children:String(null!==(t=null===(n=r.data)||void 0===n?void 0:n[e])&&void 0!==t?t:"")},e)}))})})]})}),(0,Mr.jsx)("div",{style:Qi.tableWrapper,children:(0,Mr.jsxs)("table",{style:Qi.table,children:[(0,Mr.jsx)("thead",{children:(0,Mr.jsxs)("tr",{children:[(0,Mr.jsx)("th",{style:Qi.th,children:"Process"}),(0,Mr.jsx)("th",{style:Qi.th,children:"Step"}),(0,Mr.jsx)("th",{style:Qi.th,children:"Goes To"}),(0,Mr.jsx)("th",{style:Qi.th,children:"Status"})]})}),(0,Mr.jsx)("tbody",{children:n.steps.map(((e,t)=>{const r=u[e.id]||{started_at:null,completed_at:null},i=!!r.completed_at,s=!!r.started_at,a=i?"Completed":s?"In progress":"Pending",o=n.steps[t+1];return(0,Mr.jsxs)("tr",{children:[(0,Mr.jsx)("td",{style:Qi.td,children:n.name}),(0,Mr.jsx)("td",{style:Qi.td,children:e.name}),(0,Mr.jsx)("td",{style:Qi.td,children:o?o.name:""}),(0,Mr.jsx)("td",{style:Qi.td,children:(0,Mr.jsxs)("div",{children:[(0,Mr.jsx)("strong",{children:a}),i&&(0,Mr.jsxs)("div",{style:{marginTop:4,fontStyle:"italic",fontSize:12},children:["Completed by: ",e.responsibility||"Unknown"]})]})})]},e.id)}))})]})})]})]})]},r.id)}))})]})}const Gi="#007bff",Qi={container:{padding:"20px",fontFamily:"Arial, sans-serif"},title:{textAlign:"center",fontSize:20,marginBottom:16},loading:{textAlign:"center",padding:20,fontSize:16},timelineContainer:{display:"flex",flexDirection:"column",gap:16},itemRow:{display:"flex"},timestamp:{fontSize:14,color:"#555"},lineContainer:{position:"relative",width:40,display:"flex",justifyContent:"center"},verticalLine:{position:"absolute",top:0,bottom:0,width:3,background:Gi},dot:{width:14,height:14,borderRadius:"50%",background:"#fff",border:`3px solid ${Gi}`,zIndex:1,marginTop:4},card:{flex:1,background:"#f0f0f0",borderRadius:4,overflow:"hidden"},cardHeader:{display:"flex",alignItems:"center",background:"#e8e8e8"},headerField:{fontWeight:500},ttl:{fontWeight:500},expandedSection:{marginTop:8,display:"flex",flexDirection:"column",gap:8},tableWrapper:{overflowX:"auto"},table:{width:"100%",borderCollapse:"collapse",minWidth:400},th:{border:"1px solid #ccc",padding:8,background:"#ddd",textAlign:"left",fontSize:12},td:{border:"1px solid #ccc",padding:8,fontSize:12}},Yi=wi,Xi=ki,Zi=function(e){return bi({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"11",cy:"11",r:"8"},child:[]},{tag:"line",attr:{x1:"21",y1:"21",x2:"16.65",y2:"16.65"},child:[]}]})(e)},es=function(e){return bi({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"19",y1:"12",x2:"5",y2:"12"},child:[]},{tag:"polyline",attr:{points:"12 19 5 12 12 5"},child:[]}]})(e)};function ts(){const e=ee(),[t,n]=(0,r.useState)(!0),[i,s]=(0,r.useState)({}),[a,o]=(0,r.useState)(new Set),[l,u]=(0,r.useState)(new Set),[c,d]=(0,r.useState)(new Set),[h,p]=(0,r.useState)("");(0,r.useEffect)((()=>{!async function(){n(!0);const{data:{session:e}}=await Fr.auth.getSession();if(null===e||void 0===e||!e.user)return void n(!1);const{data:t}=await Fr.from("processes").select("\n        id,\n        name,\n        steps(\n          id,name,responsibility\n        ),\n        form_submissions(\n          id,data,created_at\n        )\n      ").eq("user_id",e.user.id).order("created_at",{foreignTable:"steps",ascending:!0});if(!t)return void n(!1);const r=t.flatMap((e=>e.form_submissions.map((e=>e.id)))),i={};if(r.length){const{data:e}=await Fr.from("submission_step_statuses").select("submission_id,step_id,started_at,completed_at").in("submission_id",r);null===e||void 0===e||e.forEach((e=>{i[e.submission_id]=i[e.submission_id]||[],i[e.submission_id].push(e)}))}t.forEach((e=>{e.form_submissions.forEach((e=>{e.statuses=i[e.id]||[]}))}));const a={};t.forEach((e=>{e.steps.forEach((t=>{const n=t.responsibility||"Unassigned";a[n]||(a[n]=[]),a[n].some((t=>t.id===e.id))||a[n].push(e)}))})),s(a),n(!1)}()}),[]);const f=(e,t,n)=>{n((e=>{const n=new Set(e);return n.has(t)?n.delete(t):n.add(t),n}))};return t?(0,Mr.jsx)("p",{style:ns.loading,children:"Loading\u2026"}):(0,Mr.jsxs)("div",{style:ns.container,children:[(0,Mr.jsxs)("button",{onClick:()=>e(-1),style:ns.backBtn,children:[(0,Mr.jsx)(es,{})," Back"]}),(0,Mr.jsx)("h2",{style:ns.title,children:"By Doer"}),Object.entries(i).map((e=>{let[t,n]=e;const r=a.has(t);return(0,Mr.jsxs)("div",{style:ns.section,children:[(0,Mr.jsxs)("div",{onClick:()=>f(0,t,o),style:ns.header,children:[r?(0,Mr.jsx)(Xi,{}):(0,Mr.jsx)(Yi,{}),(0,Mr.jsxs)("span",{style:ns.headerText,children:[t," (",n.length," proc)"]})]}),r&&(0,Mr.jsx)("div",{style:ns.nested,children:n.map((e=>{const n=`${t}-${e.id}`,r=l.has(n);return(0,Mr.jsxs)("div",{style:ns.section,children:[(0,Mr.jsxs)("div",{onClick:()=>f(0,n,u),style:ns.header,children:[r?(0,Mr.jsx)(Xi,{}):(0,Mr.jsx)(Yi,{}),(0,Mr.jsxs)("span",{style:ns.headerText,children:[e.name," (",e.form_submissions.length," pts)"]})]}),r&&(0,Mr.jsxs)("div",{style:ns.nested,children:[(0,Mr.jsxs)("div",{style:ns.searchRow,children:[(0,Mr.jsx)(Zi,{}),(0,Mr.jsx)("input",{placeholder:"Search data points...",value:h,onChange:e=>p(e.target.value),style:ns.searchInput})]}),e.form_submissions.filter((e=>!h||e.id.includes(h)||JSON.stringify(e.data).includes(h))).map((t=>{const n=`${e.id}-${t.id}`,r=c.has(n);return(0,Mr.jsxs)("div",{style:ns.section,children:[(0,Mr.jsxs)("div",{onClick:()=>f(0,n,d),style:ns.header,children:[r?(0,Mr.jsx)(Xi,{}):(0,Mr.jsx)(Yi,{}),(0,Mr.jsxs)("span",{style:ns.headerText,children:["Data Point: ",t.id]}),(0,Mr.jsx)("span",{style:ns.meta,children:new Date(t.created_at).toLocaleString()})]}),r&&(0,Mr.jsxs)(Mr.Fragment,{children:[t.data&&(0,Mr.jsxs)("table",{style:ns.table,children:[(0,Mr.jsx)("thead",{children:(0,Mr.jsxs)("tr",{children:[(0,Mr.jsx)("th",{style:ns.th,children:"Field"}),(0,Mr.jsx)("th",{style:ns.th,children:"Value"})]})}),(0,Mr.jsx)("tbody",{children:Object.entries(t.data).map((e=>{let[t,n]=e;return(0,Mr.jsxs)("tr",{children:[(0,Mr.jsx)("td",{style:ns.td,children:t}),(0,Mr.jsx)("td",{style:ns.td,children:String(n)})]},t)}))})]}),(0,Mr.jsxs)("table",{style:ns.table,children:[(0,Mr.jsx)("thead",{children:(0,Mr.jsxs)("tr",{children:[(0,Mr.jsx)("th",{style:ns.th,children:"Step"}),(0,Mr.jsx)("th",{style:ns.th,children:"Status"}),(0,Mr.jsx)("th",{style:ns.th,children:"Started"}),(0,Mr.jsx)("th",{style:ns.th,children:"Completed"})]})}),(0,Mr.jsx)("tbody",{children:e.steps.map((e=>{var n,r;const i=(t.statuses||[]).find((t=>t.step_id===e.id))||{started_at:null,completed_at:null},s=i.completed_at?"Completed":i.started_at?"In Progress":"Pending";return(0,Mr.jsxs)("tr",{children:[(0,Mr.jsx)("td",{style:ns.td,children:e.name}),(0,Mr.jsx)("td",{style:ns.td,children:s}),(0,Mr.jsx)("td",{style:ns.td,children:null!==(n=i.started_at)&&void 0!==n?n:"\u2014"}),(0,Mr.jsx)("td",{style:ns.td,children:null!==(r=i.completed_at)&&void 0!==r?r:"\u2014"})]},e.id)}))})]})]})]},t.id)}))]})]},e.id)}))})]},t)}))]})}const ns={container:{maxWidth:900,margin:"auto",padding:20,fontFamily:"Arial, sans-serif"},backBtn:{background:"none",border:"none",color:"#1890FF",cursor:"pointer",marginBottom:12,display:"flex",alignItems:"center",gap:4},title:{fontSize:20,marginBottom:16},loading:{textAlign:"center",padding:20},section:{marginBottom:12,borderRadius:4,overflow:"hidden"},header:{display:"flex",alignItems:"center",padding:"8px 12px",background:"#f0f0f0",cursor:"pointer"},headerText:{marginLeft:8,fontWeight:500},meta:{marginLeft:"auto",fontSize:12,color:"#555"},nested:{marginLeft:16,marginTop:4},searchRow:{display:"flex",alignItems:"center",margin:"8px 0"},searchInput:{flex:1,padding:"4px 8px",marginLeft:6,borderRadius:4,border:"1px solid #ccc"},table:{width:"100%",borderCollapse:"collapse",marginTop:8},th:{border:"1px solid #ddd",padding:6,background:"#fafafa",textAlign:"left",fontSize:13},td:{border:"1px solid #ddd",padding:6,fontSize:12}};function rs(){const{flowchartId:e}=te(),[t]=at(),n=ee(),i=t.get("mode")||"add",s=t.get("stepId"),a=t.get("sequenceId"),o=s?Number(s):0,l=a?Number(a):0,u={display:"flex",gap:16,marginBottom:8},c={display:"block",fontWeight:"bold",marginBottom:4},d={width:"100%",padding:6,boxSizing:"border-box"},h={border:"1px solid #ccc",padding:16,borderRadius:4,marginTop:16},[p,f]=(0,r.useState)("status"),[m,g]=(0,r.useState)(o),[v,y]=(0,r.useState)(l),[b,x]=(0,r.useState)(""),[w,_]=(0,r.useState)(""),[k,S]=(0,r.useState)("hrs"),[j,C]=(0,r.useState)(""),[E,T]=(0,r.useState)(null),[R,P]=(0,r.useState)("immediate"),[O,N]=(0,r.useState)(""),[$,I]=(0,r.useState)("dropdown"),[A,L]=(0,r.useState)([{statusName:"",inputType:"dropdown",optionName:"",alertEnabled:!1,alertType:"email",alertEmail:"",alertTemplate:""}]),[D,F]=(0,r.useState)([{text:"",isChecked:!1}]),[z,M]=(0,r.useState)(""),[B,U]=(0,r.useState)(""),[q,W]=(0,r.useState)(""),[H,V]=(0,r.useState)([]),[J,K]=(0,r.useState)([{frequency:"",till_when:"",inputType:"text",options:""}]),[G,Q]=(0,r.useState)({}),[Y,X]=(0,r.useState)({}),[Z,ne]=(0,r.useState)(!1),[re,ie]=(0,r.useState)([]),[se,ae]=(0,r.useState)([]),oe=(0,r.useRef)(void 0),[le,ue]=(0,r.useState)([]),[ce,de]=(0,r.useState)(!1),[he,pe]=(0,r.useState)([]),fe=(0,r.useRef)(void 0),[me,ge]=(0,r.useState)([]),[ve,ye]=(0,r.useState)(!1),[be,xe]=(0,r.useState)({}),[we,_e]=(0,r.useState)({}),[ke,Se]=(0,r.useState)({}),[je,Ce]=(0,r.useState)({}),[Ee,Te]=(0,r.useState)({});const[Re,Pe]=(0,r.useState)([]),[Oe,Ne]=(0,r.useState)({}),[$e,Ie]=(0,r.useState)({}),[Ae,Le]=(0,r.useState)({}),[De,Fe]=(0,r.useState)([]),[ze,Me]=(0,r.useState)([]),[Be,Ue]=(0,r.useState)(!1),qe=(0,r.useRef)([]),[We,He]=(0,r.useState)({top:0,left:0});function Ve(e){const t=null!==e&&void 0!==e?e:new Date,n=t.getTime()+60*t.getTimezoneOffset()*1e3,r=new Date(n+198e5),i=e=>String(e).padStart(2,"0");return`${r.getFullYear()}-${i(r.getMonth()+1)}-${i(r.getDate())} ${i(r.getHours())}:${i(r.getMinutes())}:${i(r.getSeconds())}`}(0,r.useEffect)((()=>{"edit"===i&&s&&Fr.from("steps").select("*").eq("id",s).single().then((e=>{var t,n,r,i,s;let{data:a}=e;a&&(x(null!==(t=a.name)&&void 0!==t?t:""),_(null!=a.tat_value?String(a.tat_value):""),S(a.tat_unit||"hrs"),C(null!==(n=a.responsibility)&&void 0!==n?n:""),f(null!==(r=a.step_type)&&void 0!==r?r:"status"),a.statuses&&L(a.statuses),a.checklists&&F(a.checklists),a.checklistActionMapping&&M(a.checklistActionMapping),a.form_url&&U(a.form_url),a.crafty_action_mapping&&W(a.crafty_action_mapping),ne(!!a.is_timer_enabled),a.scheduled_at?(P("scheduled"),N(new Date(a.scheduled_at).toISOString().slice(0,16))):P("immediate"),xe(a.field_action_mapping||{}),Ne(a.option_action_mapping||{}),V(null!==(i=a.alerts)&&void 0!==i?i:[]),K(null!==(s=a.reminders)&&void 0!==s?s:[]))}))}),[i,s]),(0,r.useEffect)((()=>{"edit"===i&&e&&Fr.from("steps").select("*").eq("process_id",e).eq("step_id",o).eq("sequence_id",l).single().then((e=>{let{data:t}=e}))}),[i,e,o,l]),(0,r.useEffect)((()=>{"edit"===i&&e&&Fr.from("steps").select("*").eq("process_id",e).eq("step_id",o).eq("sequence_id",l).single().then((e=>{let{data:t}=e;if(t)if(x(t.name||""),_(null!=t.tat_value?String(t.tat_value):""),S(t.tat_unit||"hrs"),C(t.responsibility||""),f(t.step_type||"status"),t.statuses&&L(t.statuses),t.checklists&&F(t.checklists),t.checklistActionMapping&&M(t.checklistActionMapping),t.form_url&&U(t.form_url),t.crafty_action_mapping&&W(t.crafty_action_mapping),xe(t.field_action_mapping||{}),Ne(t.option_action_mapping||{}),t.scheduled_at){const e=new Date(t.scheduled_at).toISOString().slice(0,16);P("scheduled"),N(e)}else t.started_at&&P("immediate")}))}),[i,e,o,l]),(0,r.useEffect)((()=>{L((e=>e.map((e=>({...e,inputType:$})))))}),[$]),(0,r.useEffect)((()=>{Fr.auth.getSession().then((e=>{var t,n;let{data:r}=e;const i=null===(t=r.session)||void 0===t||null===(n=t.user)||void 0===n?void 0:n.id;i&&Fr.from("processes").select("id,name,steps:steps(*)").eq("user_id",i).then((e=>{let{data:t}=e;return t&&Pe(t)}))}))}),[]),(0,r.useEffect)((()=>{if("crafty"!==p||!B.trim())return void ge([]);const e=B.trim().split("/").pop();if(!e||!/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(e))return console.warn("Invalid form URL or missing ID"),void ge([]);ye(!0),(async()=>{const{data:t,error:n}=await zr.from("form_schemas").select("schema").eq("id",e).single();if(n||null===t||void 0===t||!t.schema)return console.error("Error loading schema:",n),ge([]),void ye(!1);try{const e=t.schema,n={...e.properties||{}};(e.allOf||[]).forEach((e=>{var t;null!==(t=e.then)&&void 0!==t&&t.properties&&Object.assign(n,e.then.properties)}));const r=Object.entries(n).map((e=>{let[t,n]=e;return{key:t,title:n.title||t,type:n.type,options:Array.isArray(n.enum)?n.enum:void 0}}));ge(r)}catch(r){console.error("Error parsing schema JSON:",r),ge([])}ye(!1)})()}),[B,p]),(0,r.useEffect)((()=>{"add"===i&&e&&Fr.from("steps").select("step_id,sequence_id").eq("process_id",e).then((e=>{let{data:t}=e;t&&t.length&&(g(Math.max(...t.map((e=>e.step_id||0)))+1),y(Math.max(...t.map((e=>e.sequence_id||0)))+1))}))}),[i,e]),(0,r.useEffect)((()=>{"edit"===i&&e&&Fr.from("steps").select("*").eq("process_id",e).eq("step_id",o).eq("sequence_id",l).single().then((e=>{let{data:t}=e;if(t)if(x(t.name||""),_(null!=t.tat_value?String(t.tat_value):""),S(t.tat_unit||"hrs"),C(t.responsibility||""),f(t.step_type||"status"),t.statuses&&L(t.statuses),t.checklists&&F(t.checklists),t.checklistActionMapping&&M(t.checklistActionMapping),t.form_url&&U(t.form_url),t.craftyActionMapping&&W(t.craftyActionMapping),t.scheduled_at){const e=new Date(t.scheduled_at).toISOString().slice(0,16);P("scheduled"),N(e)}else t.started_at&&P("immediate")}))}),[i,e,o,l]),(0,r.useEffect)((()=>{e&&Fr.from("processes").select("responsibility").eq("id",e).single().then((e=>{let{data:t}=e;t&&t.responsibility&&(T(t.responsibility),C(t.responsibility))}))}),[e]),(0,r.useEffect)((()=>{e&&Fr.from("steps").select("id, step_id, sequence_id, name, created_at, dependencies").eq("process_id",e).order("sequence_id",{ascending:!0}).then((e=>{let{data:t}=e;t&&Fe(t)}))}),[e]),(0,r.useEffect)((()=>{e&&(Ue(!0),Fr.from("forms").select("selected_fields").eq("process_id",e).single().then((e=>{let{data:t,error:n}=e;null!==t&&void 0!==t&&t.selected_fields&&Me(t.selected_fields)})).then((()=>{Ue(!1)})))}),[e]),(0,r.useEffect)((()=>{Fr.from("steps").select("alerts").then((e=>{let{data:t,error:n}=e;if(t&&!n){const e=t.flatMap((e=>(e.alerts||[]).filter((e=>"email"===e.type&&e.email)).map((e=>e.email))));ie(Array.from(new Set(e)))}}))}),[]);const Je=Re.find((t=>t.id===e)),Ke=((Je?Je.steps.filter((e=>e.sequence_id<v)).sort(((e,t)=>t.sequence_id-e.sequence_id)):[])[0],()=>{F((e=>[...e,{text:"",isChecked:!1}]))}),Ge=e=>{"Enter"===e.key&&(e.preventDefault(),Ke())},Qe=async function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const{data:{session:r}}=await Fr.auth.getSession();if(null===r||void 0===r||!r.user)return void alert("Not authenticated");const a=r.user.id,o={process_id:null!==e&&void 0!==e?e:null,step_id:m,sequence_id:v,name:b||null,tat_value:w?parseInt(w,10):null,tat_unit:k,responsibility:j||null,is_draft:t,user_id:a,step_type:p,started_at:"immediate"===R?Ve():null,scheduled_at:"scheduled"===R?Ve(new Date(O)):null,statuses:"status"===p?A:void 0,checklists:"checklist"===p?D:void 0,checklistActionMapping:"checklist"===p?z:void 0,form_url:"crafty"===p?B.trim():void 0,crafty_action_mapping:"crafty"===p?q:void 0,field_action_mapping:be,option_action_mapping:Oe,alerts:H.map((e=>({statusName:e.statusName,type:e.type,email:e.email,template:e.template,fieldKey:e.fieldKey||null}))),reminders:J,is_timer_enabled:Z},l={id:"temp",step_id:m,sequence_id:v,name:b,created_at:Ve()},u=function(e,t){var n;const r=[...t].sort(((e,t)=>e.sequence_id-t.sequence_id)),i=r.findIndex((t=>t.sequence_id===e.sequence_id)),s=r.length,a=i>=0&&i<s-1?1:0,o=i>=0?s-i-1:0,l=[];for(let g=i;g>=0;g--)l.push(r[g].name);const u=l.join(" \u203a "),c=u,d=l.length>0?l.length-1:0,h=(null===(n=r[0])||void 0===n?void 0:n.name)||"",p=i>0?Math.floor((new Date(e.created_at).getTime()-new Date(r[i-1].created_at).getTime())/864e5):0,f=i>=0?Math.floor((new Date(e.created_at).getTime()-new Date(r[0].created_at).getTime())/864e5):0,m=`${e.name} has ${a} direct children and ${o} total descendants. It is ${d} step(s) from ${h}.`;return{step:e.name,dependentOn:i>0?r[i-1].name:null,date:e.created_at,directChildren:a,descendants:o,ancestors:d,root:h,chainOfReference:u,chainOfReferenceWithCycles:c,daysSinceReferrerJoined:p,daysFromRoot:f,inWords:m,getRoot:h,isRoot:0===i}}(l,[...De,l].sort(((e,t)=>e.sequence_id-t.sequence_id)));let c;console.log("\u23f3 STEP PAYLOAD:",o);let d=!1;if("edit"===i&&s)d=!0,c=await Fr.from("steps").update(o).eq("id",s).select("*");else{let t=null,n=null;var h;if(e)({data:t,error:n}=await Fr.from("steps").select("id").eq("process_id",e).eq("step_id",m).eq("sequence_id",v).single()),null!==(h=t)&&void 0!==h&&h.id&&(d=!0);if(n&&"PGRST116"!==n.code)return void alert(`Error checking existing step: ${n.message}`);c=d?await Fr.from("steps").update(o).eq("id",t.id).select("*"):await Fr.from("steps").insert(o).select("*")}if(console.log("\u2705 DATABASE RESULT:",c),c.error)return void alert(`Error saving step: ${c.error.message}`);const f=Array.isArray(c.data)?c.data[0]:c.data;await Fr.from("logs").insert({event_type:d?"step_update":"step_create",details:JSON.stringify({processId:e,stepId:m,sequenceId:v,dbRowId:null===f||void 0===f?void 0:f.id,userId:r.user.id,responsibility:j||null,isDraft:t,tatValue:o.tat_value,tatUnit:o.tat_unit,stepType:o.step_type,timestamp:Ve()}),created_at:Ve()}),await Fr.from("step_flow_overviews").upsert({process_id:null!==e&&void 0!==e?e:null,step_id:m,sequence_id:v,overview:u}),alert("Step saved successfully, and overview stored separately!"),n(-1)};return(0,Mr.jsxs)("div",{style:{maxWidth:600,margin:"auto",padding:16,fontFamily:"Arial, sans-serif"},children:[(0,Mr.jsxs)("div",{style:{marginBottom:16},children:[(0,Mr.jsx)("button",{onClick:()=>n(-1),style:{marginRight:8},children:"\u2190"}),(0,Mr.jsx)("strong",{style:{fontSize:18},children:"edit"===i?"Edit Step":"Add New Step"})]}),(0,Mr.jsxs)("div",{style:u,children:[(0,Mr.jsxs)("div",{style:{flex:1},children:[(0,Mr.jsx)("label",{style:c,children:"Step Name"}),(0,Mr.jsx)("input",{style:d,value:b,onChange:e=>x(e.target.value)})]}),(0,Mr.jsxs)("div",{style:{flex:1},children:[(0,Mr.jsx)("label",{style:c,children:"Responsibility"}),E?(0,Mr.jsx)("input",{style:{...d,background:"#f5f5f5"},value:E,readOnly:!0}):(0,Mr.jsxs)(Mr.Fragment,{children:[(0,Mr.jsx)("input",{style:d,value:j,onChange:e=>{return t=e.target.value,C(t),window.clearTimeout(fe.current),void(fe.current=window.setTimeout((async()=>{if(!t)return void pe([]);const{data:e,error:n}=await Fr.from("steps").select("responsibility").ilike("responsibility",`${t}%`).limit(10);if(!n&&e){const t=Array.from(new Set(e.map((e=>e.responsibility)).filter((e=>"string"===typeof e))));pe(t)}}),300));var t},placeholder:"E.g. team-member@example.com",list:"email-suggestions"}),(0,Mr.jsx)("datalist",{id:"email-suggestions",children:he.map((e=>(0,Mr.jsx)("option",{value:e},e)))})]})]})]}),(0,Mr.jsxs)("div",{style:u,children:[(0,Mr.jsxs)("div",{style:{flex:2},children:[(0,Mr.jsx)("label",{style:c,children:"TAT"}),(0,Mr.jsx)("input",{style:d,type:"number",value:w,onChange:e=>_(e.target.value)})]}),(0,Mr.jsxs)("div",{style:{flex:1},children:[(0,Mr.jsx)("label",{style:c,children:"Units"}),(0,Mr.jsxs)("select",{style:d,value:k,onChange:e=>S(e.target.value),children:[(0,Mr.jsx)("option",{value:"mins",children:"mins"}),(0,Mr.jsx)("option",{value:"hrs",children:"hrs"}),(0,Mr.jsx)("option",{value:"days",children:"days"}),(0,Mr.jsx)("option",{value:"weeks",children:"weeks"})]})]})]}),(0,Mr.jsxs)("div",{style:{marginTop:16},children:[(0,Mr.jsx)("label",{style:c,children:"Step Type"}),(0,Mr.jsxs)("select",{style:d,value:p,onChange:e=>f(e.target.value),children:[(0,Mr.jsx)("option",{value:"status",children:"Status"}),(0,Mr.jsx)("option",{value:"checklist",children:"Checklist"}),(0,Mr.jsx)("option",{value:"crafty",children:"Crafty Form"})]})]}),(0,Mr.jsx)("div",{style:{marginTop:16},children:(0,Mr.jsxs)("label",{style:c,children:[(0,Mr.jsx)("input",{type:"checkbox",checked:Z,onChange:e=>ne(e.target.checked)})," Enable Timer for this step"]})}),(0,Mr.jsxs)("div",{style:h,children:[(0,Mr.jsx)("label",{style:c,children:"When step gets start"}),(0,Mr.jsxs)("label",{style:{marginRight:16},children:[(0,Mr.jsx)("input",{type:"radio",checked:"immediate"===R,onChange:()=>P("immediate")})," ","Immediate"]}),(0,Mr.jsxs)("label",{children:[(0,Mr.jsx)("input",{type:"radio",checked:"scheduled"===R,onChange:()=>P("scheduled")})," ","Schedule"]}),"scheduled"===R&&(0,Mr.jsxs)(Mr.Fragment,{children:[(0,Mr.jsx)("label",{style:c,children:"Select date & time"}),(0,Mr.jsx)("input",{style:d,type:"datetime-local",value:O,onChange:e=>N(e.target.value)})]})]}),"status"===p&&(0,Mr.jsxs)("div",{style:h,children:[(0,Mr.jsx)("h4",{children:"Statuses"}),(0,Mr.jsxs)("div",{style:{marginBottom:12},children:[(0,Mr.jsx)("label",{style:c,children:"Input Type"}),(0,Mr.jsxs)("select",{style:d,value:$,onChange:e=>I(e.target.value),children:[(0,Mr.jsx)("option",{value:"dropdown",children:"Dropdown"}),(0,Mr.jsx)("option",{value:"radio",children:"Radio"}),(0,Mr.jsx)("option",{value:"button",children:"Button"})]})]}),A.map(((e,t)=>(0,Mr.jsxs)("div",{style:{marginBottom:16},children:[(0,Mr.jsx)("button",{onClick:()=>{const e=[...A];e.splice(t,1),L(e)},style:{position:"absolute",top:40,right:0,background:"transparent",border:"none",fontSize:"1rem",cursor:"pointer",color:"#900"},"aria-label":"Remove this status",children:"\u2715"}),(0,Mr.jsx)("div",{style:u,children:(0,Mr.jsx)("input",{style:{...d,marginRight:8},placeholder:"Option name",value:e.optionName,onChange:e=>{const n=[...A];n[t].optionName=e.target.value,L(n)}})})]},t))),(0,Mr.jsx)("button",{onClick:()=>{L((e=>[...e,{statusName:"",inputType:$,optionName:"",actionMapping:"",nextStep:!1,split:!1,alertEmail:"",alertTemplate:""}]))},children:"+ Add Status"})]}),"status"===p&&(0,Mr.jsxs)("div",{style:h,children:[(0,Mr.jsx)("h4",{children:"Alerts"}),H.map(((e,t)=>(0,Mr.jsxs)("div",{style:{marginBottom:16,padding:12,border:"1px solid #ddd",borderRadius:4,position:"relative"},children:[(0,Mr.jsx)("button",{onClick:()=>V((e=>{const n=[...e];return n.splice(t,1),n})),style:{position:"absolute",top:8,right:8,border:"none",background:"transparent",cursor:"pointer",color:"#900",fontSize:"1.2rem"},"aria-label":"Remove this alert",children:"\u274c"}),(0,Mr.jsxs)("div",{style:{marginBottom:8},children:[(0,Mr.jsx)("label",{style:c,children:"Form Field"}),Be?(0,Mr.jsx)("p",{children:"Loading form fields\u2026"}):(0,Mr.jsxs)("select",{style:d,value:e.fieldKey||"",onChange:e=>{const n=[...H];n[t].fieldKey=e.target.value,V(n)},children:[(0,Mr.jsx)("option",{value:"",children:"-- Select Field --"}),ze.map((e=>(0,Mr.jsx)("option",{value:e,children:e},e)))]})]}),(0,Mr.jsxs)("div",{style:{marginBottom:8},children:[(0,Mr.jsx)("label",{style:c,children:"Status"}),(0,Mr.jsxs)("select",{style:d,value:e.statusName,onChange:e=>{const n=[...H];n[t].statusName=e.target.value,V(n)},children:[(0,Mr.jsx)("option",{value:"",children:"-- Select Status --"}),A.map((e=>(0,Mr.jsx)("option",{value:e.optionName,children:e.optionName},e.optionName)))]})]}),(0,Mr.jsxs)("div",{style:{marginBottom:8},children:[(0,Mr.jsx)("label",{style:c,children:"Alert Email"}),(0,Mr.jsx)("input",{style:d,type:"text",list:"alert-email-suggestions",value:e.email,onChange:e=>{return n=e.target.value,r=t,V((e=>{const t=[...e];return t[r].email=n,t})),window.clearTimeout(oe.current),void(oe.current=window.setTimeout((()=>{const e=n.split(","),t=e[e.length-1].trim().toLowerCase();if(!t)return void ae([]);const r=re.filter((e=>e.toLowerCase().startsWith(t)));ae(r)}),200));var n,r},placeholder:"user@gmail.com, bar@gmail.com"}),(0,Mr.jsx)("datalist",{id:"alert-email-suggestions",children:se.map((e=>(0,Mr.jsx)("option",{value:e},e)))})]}),(0,Mr.jsxs)("div",{children:[(0,Mr.jsx)("label",{style:c,children:"Message Template"}),(0,Mr.jsxs)("div",{style:{position:"relative"},children:[(0,Mr.jsx)("textarea",{ref:e=>{qe.current[t]=e},style:{...d,height:60},value:e.template,onChange:e=>{const n=[...H];n[t].template=e.target.value,V(n)},placeholder:"Type your message\u2026",onKeyUp:e=>{if("{"===e.key&&qe.current[t]){const e=qe.current[t],n=e.selectionStart,{top:r,left:i}=Vr(e,n);He({top:r+4,left:i+4});const s=[...H];s[t].showFieldDropdown=!0,V(s)}}}),e.showFieldDropdown&&qe.current[t]&&(0,Mr.jsxs)("select",{size:3,style:{position:"absolute",top:We.top,left:We.left,...d,maxHeight:"6em",overflowY:"auto"},onChange:e=>{const n=e.target.value,r=[...H];r[t].template=r[t].template.replace(/\{$/,`{${n}}`),r[t].showFieldDropdown=!1,V(r)},children:[(0,Mr.jsx)("option",{value:"",children:"-- Select Field --"}),ze.map((e=>(0,Mr.jsx)("option",{value:e,children:e},e)))]})]})]})]},t))),(0,Mr.jsx)("button",{onClick:()=>V((e=>[...e,{statusName:"",type:"email",email:"",template:""}])),children:"+ Add Alert"})]}),"crafty"===p&&(0,Mr.jsxs)("div",{style:h,children:[(0,Mr.jsx)("h4",{children:"Crafty Form"}),(0,Mr.jsx)("button",{onClick:()=>window.open("https://nimble-phoenix-504247.netlify.app/","_blank"),children:"Open Crafty Builder"}),(0,Mr.jsxs)("div",{style:{marginTop:16},children:[(0,Mr.jsx)("label",{style:c,children:"Form URL"}),(0,Mr.jsx)("input",{style:d,value:B,onChange:e=>U(e.target.value),placeholder:"Paste form URL here"})]}),(0,Mr.jsxs)("div",{style:{marginTop:16},children:[(0,Mr.jsx)("label",{style:c,children:"On Submit Action"}),(0,Mr.jsxs)("select",{style:d,value:q,onChange:e=>W(e.target.value),children:[(0,Mr.jsx)("option",{value:"",children:"--Select--"}),(0,Mr.jsx)("option",{value:"next",children:"Next Step"}),(0,Mr.jsx)("option",{value:"stop",children:"Stop Here"}),(0,Mr.jsx)("option",{value:"split",children:"Split/Progress"}),(0,Mr.jsx)("option",{value:"nextForm",children:"Next Form"})]})]})]}),"crafty"===p&&(0,Mr.jsxs)("div",{style:h,children:[(0,Mr.jsx)("h4",{children:"Field & Option Action Mappings"}),ve?(0,Mr.jsx)("p",{children:"Loading form schema\u2026"}):0===me.length?(0,Mr.jsx)("p",{children:"No schema loaded. Paste a valid Crafty URL above."}):me.map((e=>{var t,n;return(0,Mr.jsxs)("div",{style:{marginBottom:16},children:[(0,Mr.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:8},children:[(0,Mr.jsx)("strong",{style:{flex:2},children:e.title}),(0,Mr.jsxs)("select",{style:{flex:1,...d},value:be[e.key]||"",onChange:t=>{return n=e.key,r=t.target.value,xe((e=>({...e,[n]:r}))),void _e((e=>({...e,[n]:"split"===r})));var n,r},children:[(0,Mr.jsx)("option",{value:"",children:"(use default)"}),(0,Mr.jsx)("option",{value:"next",children:"Next Step"}),(0,Mr.jsx)("option",{value:"stop",children:"Stop Here"}),(0,Mr.jsx)("option",{value:"split",children:"Split/Progress"})]})]}),"split"===be[e.key]&&(0,Mr.jsxs)("div",{style:{marginLeft:24,marginBottom:8,padding:8,background:"#f9f9f9"},children:[(0,Mr.jsx)("label",{style:c,children:"Process"}),(0,Mr.jsxs)("select",{style:d,value:ke[e.key]||"",onChange:t=>{return n=e.key,r=t.target.value,Se((e=>({...e,[n]:r}))),void Ce((e=>({...e,[n]:""})));var n,r},children:[(0,Mr.jsx)("option",{value:"",children:"--Select--"}),Re.map((e=>(0,Mr.jsx)("option",{value:e.id,children:e.name},e.id)))]}),ke[e.key]&&(0,Mr.jsxs)(Mr.Fragment,{children:[(0,Mr.jsx)("label",{style:c,children:"Step"}),(0,Mr.jsxs)("select",{style:d,value:je[e.key]||"",onChange:t=>{return n=e.key,r=t.target.value,void Ce((e=>({...e,[n]:r})));var n,r},children:[(0,Mr.jsx)("option",{value:"",children:"--Select--"}),null===(t=Re.find((t=>t.id===ke[e.key])))||void 0===t?void 0:t.steps.map((e=>(0,Mr.jsx)("option",{value:e.id,children:e.name},e.id)))]})]})]}),null===(n=e.options)||void 0===n?void 0:n.map((t=>{var n,r,i,s,a;const o=null===(n=Oe[e.key])||void 0===n?void 0:n[t],l=(null===o||void 0===o?void 0:o.action)||"";return(0,Mr.jsxs)("div",{style:{marginLeft:24,marginBottom:16},children:[(0,Mr.jsx)("span",{style:{flex:2},children:t}),(0,Mr.jsxs)("select",{style:d,value:l,onChange:n=>((e,t,n)=>{Ne((r=>{var i,s;return{...r,[e]:{...r[e]||{},[t]:"split"===n?{action:"split",target:(null===(i=r[e])||void 0===i||null===(s=i[t])||void 0===s?void 0:s.target)||""}:{action:n}}}}))})(e.key,t,n.target.value),children:[(0,Mr.jsx)("option",{value:"",children:"(use default)"}),(0,Mr.jsx)("option",{value:"next",children:"Next Step"}),(0,Mr.jsx)("option",{value:"stop",children:"Stop Here"}),(0,Mr.jsx)("option",{value:"split",children:"Split/Progress"})]}),"split"===l&&(0,Mr.jsxs)("div",{style:{marginLeft:16,marginTop:8,padding:8,background:"#f1f1f1"},children:[(0,Mr.jsx)("label",{style:c,children:"Process"}),(0,Mr.jsxs)("select",{style:d,value:(null===(r=$e[e.key])||void 0===r?void 0:r[t])||"",onChange:n=>((e,t,n)=>{Ie((r=>({...r,[e]:{...r[e]||{},[t]:n}}))),Le((n=>({...n,[e]:{...n[e]||{},[t]:""}})))})(e.key,t,n.target.value),children:[(0,Mr.jsx)("option",{value:"",children:"--Select--"}),Re.map((e=>(0,Mr.jsx)("option",{value:e.id,children:e.name},e.id)))]}),(null===(i=$e[e.key])||void 0===i?void 0:i[t])&&(0,Mr.jsxs)(Mr.Fragment,{children:[(0,Mr.jsx)("label",{style:c,children:"Step"}),(0,Mr.jsxs)("select",{style:d,value:(null===(s=Ae[e.key])||void 0===s?void 0:s[t])||"",onChange:n=>((e,t,n)=>{var r;const i=null===(r=$e[e])||void 0===r?void 0:r[t];if(!i)return;const s=Re.find((e=>e.id===i)),a=null===s||void 0===s?void 0:s.steps.find((e=>e.id===n));if(!s||!a)return;const o=`Step: ${a.name} in ${s.name}`;Ne((n=>({...n,[e]:{...n[e]||{},[t]:{action:"split",target:o}}}))),Le((r=>({...r,[e]:{...r[e]||{},[t]:n}})))})(e.key,t,n.target.value),children:[(0,Mr.jsx)("option",{value:"",children:"--Select--"}),null===(a=Re.find((n=>{var r;return n.id===(null===(r=$e[e.key])||void 0===r?void 0:r[t])})))||void 0===a?void 0:a.steps.map((e=>(0,Mr.jsx)("option",{value:e.id,children:e.name},e.id)))]})]})]})]},t)}))]},e.key)}))]}),"checklist"===p&&(0,Mr.jsxs)("div",{style:h,children:[(0,Mr.jsx)("h4",{children:"Checklist"}),D.map(((e,t)=>(0,Mr.jsx)("div",{style:{marginBottom:12},children:(0,Mr.jsx)("input",{style:d,placeholder:"Item",value:e.text,onChange:e=>{const n=[...D];n[t].text=e.target.value,F(n)},onKeyDown:Ge})},t))),(0,Mr.jsx)("button",{onClick:Ke,children:"+ Add Item"}),(0,Mr.jsxs)("div",{style:{marginTop:16},children:[(0,Mr.jsx)("label",{style:c,children:"On Complete Action"}),(0,Mr.jsxs)("select",{style:d,value:z,onChange:e=>M(e.target.value),children:[(0,Mr.jsx)("option",{value:"",children:"--Select--"}),(0,Mr.jsx)("option",{value:"next",children:"Next Step"}),(0,Mr.jsx)("option",{value:"stop",children:"Stop Here"}),(0,Mr.jsx)("option",{value:"split",children:"Split/Progress"})]})]})]}),(0,Mr.jsx)("div",{style:{marginTop:16},children:(0,Mr.jsx)(Hr,{reminders:J,setReminders:K})}),(0,Mr.jsxs)("div",{style:{marginTop:24,display:"flex",gap:8},children:[(0,Mr.jsx)("button",{onClick:()=>Qe(!1),children:"edit"===i?"Update Step":"Save Step"}),(0,Mr.jsx)("button",{onClick:()=>Qe(!0),children:"Save as Draft"})]})]})}const is=()=>{const e=ee(),[t,n]=(0,r.useState)([]),[i,s]=(0,r.useState)(!0),[a,o]=(0,r.useState)(null);(0,r.useEffect)((()=>{l()}),[]);const l=async()=>{s(!0);const{data:{session:e}}=await Fr.auth.getSession();if(null===e||void 0===e||!e.user)return console.error("No active session"),void s(!1);const t=e.user.id,{data:r,error:i}=await Fr.from("steps").select("id, name, tat_value, tat_unit, responsibility").is("process_id",null).eq("user_id",t).order("created_at",{ascending:!1});i?console.error("Fetch error:",i):r&&n(r),s(!1)};return i?(0,Mr.jsx)("div",{style:{padding:"1rem"},children:"Loading tasks..."}):t.length?(0,Mr.jsxs)("div",{style:{maxWidth:700,margin:"auto",padding:"1rem",fontFamily:"Arial, sans-serif"},children:[(0,Mr.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:"1rem"},children:[(0,Mr.jsx)("button",{onClick:()=>e(-1),style:{marginRight:"0.5rem"},children:"\u2190 Back"}),(0,Mr.jsx)("h1",{style:{flex:1,fontSize:"1.5rem",margin:0},children:"Random Task List"}),(0,Mr.jsx)("button",{onClick:()=>e("/add-task"),style:{marginLeft:"0.5rem"},children:"+ Add a Step"})]}),t.map((t=>{var n,r;const i=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;switch(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"hrs"){case"mins":default:return e;case"hrs":return 60*e;case"days":return 1440*e;case"weeks":return 10080*e}}(null!==(n=t.tat_value)&&void 0!==n?n:0,null!==(r=t.tat_unit)&&void 0!==r?r:"hrs");let s=i>=1440?(i/1440).toFixed(1)+" days":i>=60?(i/60).toFixed(1)+" hrs":i+" mins";return(0,Mr.jsxs)("div",{style:{position:"relative",backgroundColor:"#f5f5f5",borderRadius:8,padding:"1rem",marginBottom:"0.75rem"},children:[(0,Mr.jsx)("span",{onClick:e=>{e.stopPropagation(),o(a===t.id?null:t.id)},style:{position:"absolute",top:8,right:8,cursor:"pointer",fontSize:"1.2rem"},children:"\u22ee"}),a===t.id&&(0,Mr.jsxs)("div",{onClick:e=>e.stopPropagation(),style:{position:"absolute",top:28,right:8,background:"#fff",border:"1px solid #ccc",borderRadius:4,zIndex:10},children:[(0,Mr.jsx)("div",{onClick:()=>{return n=t.id,void e(`/add-task/?mode=edit&stepId=${n}`);var n},style:{padding:"0.5rem 1rem",cursor:"pointer"},children:"Edit"}),(0,Mr.jsx)("div",{onClick:()=>(async e=>{if(!window.confirm("Delete this step?"))return;const{error:t}=await Fr.from("steps").delete().eq("id",e);t?console.error("Delete error:",t):l()})(t.id),style:{padding:"0.5rem 1rem",cursor:"pointer"},children:"Delete"})]}),(0,Mr.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",cursor:"pointer"},onClick:()=>e(`/task/${t.id}`),children:[(0,Mr.jsxs)("div",{children:[(0,Mr.jsx)("h3",{style:{margin:"0 0 0.5rem"},children:t.name||"Unnamed Step"}),(0,Mr.jsx)("p",{style:{margin:0,color:"#555"},children:t.responsibility||"No role specified"})]}),(0,Mr.jsx)("div",{style:{fontWeight:"bold",color:"#333"},children:s})]})]},t.id)}))]}):(0,Mr.jsx)("div",{style:{padding:"1rem"},children:"No unassigned steps."})},ss=e=>{let{children:t}=e;const[n,i]=(0,r.useState)(null),[s,a]=(0,r.useState)(!0);return(0,r.useEffect)((()=>{Fr.auth.getSession().then((e=>{let{data:{session:t}}=e;i(t),a(!1)}))}),[]),s?(0,Mr.jsx)("div",{children:"Loading..."}):n?(0,Mr.jsx)(Mr.Fragment,{children:t}):(0,Mr.jsx)(ge,{to:"/login",replace:!0})},as=()=>{const e=ee();return(0,r.useEffect)((()=>{Fr.auth.getSession().then((t=>{let{data:{session:n}}=t;n&&e("/",{replace:!0})}))}),[e]),(0,Mr.jsx)(oi,{})},os=()=>(0,Mr.jsx)(et,{children:(0,Mr.jsxs)(be,{children:[(0,Mr.jsx)(ve,{path:"/login",element:(0,Mr.jsx)(as,{})}),(0,Mr.jsx)(ve,{path:"/*",element:(0,Mr.jsx)(ss,{children:(0,Mr.jsxs)(Mr.Fragment,{children:[(0,Mr.jsx)(ii,{}),(0,Mr.jsxs)(be,{children:[(0,Mr.jsx)(ve,{path:"/",element:(0,Mr.jsx)(qr,{})}),(0,Mr.jsx)(ve,{path:"/add-process",element:(0,Mr.jsx)(Br,{})}),(0,Mr.jsx)(ve,{path:"/process/:processId/steps",element:(0,Mr.jsx)(Ur,{})}),(0,Mr.jsx)(ve,{path:"/process/:flowchartId/add-step",element:(0,Mr.jsx)(Kr,{})}),(0,Mr.jsx)(ve,{path:"/add-task",element:(0,Mr.jsx)(rs,{})}),(0,Mr.jsx)(ve,{path:"/process/:processId/bulk-edit",element:(0,Mr.jsx)(Gr,{})}),(0,Mr.jsx)(ve,{path:"/doer",element:(0,Mr.jsx)(Xr,{})}),(0,Mr.jsx)(ve,{path:"/doer/step/:stepId/submission/:submissionId",element:(0,Mr.jsx)(ei,{})}),(0,Mr.jsx)(ve,{path:"/sync",element:(0,Mr.jsx)(Wr,{})}),(0,Mr.jsx)(ve,{path:"/add-step/:flowchartId",element:(0,Mr.jsx)(Kr,{})}),(0,Mr.jsx)(ve,{path:"/add-form",element:(0,Mr.jsx)(li,{})}),(0,Mr.jsx)(ve,{path:"/create-form",element:(0,Mr.jsx)(ui,{})}),(0,Mr.jsx)(ve,{path:"/report",element:(0,Mr.jsx)(Fi,{})}),(0,Mr.jsx)(ve,{path:"/report/processstepdatapoints",element:(0,Mr.jsx)(qi,{})}),(0,Mr.jsx)(ve,{path:"/report/datapoints",element:(0,Mr.jsx)(Ki,{})}),(0,Mr.jsx)(ve,{path:"/report/doer",element:(0,Mr.jsx)(ts,{})}),(0,Mr.jsx)(ve,{path:"/random-task-list",element:(0,Mr.jsx)(is,{})})]})]})})})]})}),ls=e=>{e&&e instanceof Function&&n.e(453).then(n.bind(n,453)).then((t=>{let{getCLS:n,getFID:r,getFCP:i,getLCP:s,getTTFB:a}=t;n(e),r(e),i(e),s(e),a(e)}))};i.createRoot(document.getElementById("root")).render((0,Mr.jsx)(r.StrictMode,{children:(0,Mr.jsx)(os,{})})),ls()})();
//# sourceMappingURL=main.2735b0b1.js.map